!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8f7e7804-7228-4b03-b0e9-47ec70cde8dd",e._sentryDebugIdIdentifier="sentry-dbid-8f7e7804-7228-4b03-b0e9-47ec70cde8dd")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6695],{99010:function(e,t,s){"use strict";s.d(t,{T:function(){return i}});var a=s(27573),l=s(57908),n=s(65880),r=s(7653);let i=e=>{let{height:t,width:s,src:i,className:o,alt:d,layout:c,...u}=e,[m,x]=(0,r.useState)(!0);return(0,a.jsx)(n.default,{className:(0,l.Z)("transition duration-500",m?"scale-100 blur-sm":" scale-100 blur-0",o),onLoad:()=>x(!1),src:i,width:s,height:t,loading:"lazy",decoding:"async",layout:c,alt:d||"Avatar",...u})}},41656:function(e,t,s){"use strict";s.d(t,{DL:function(){return j},TJ:function(){return v},nR:function(){return w}});var a=s(27573),l=s(73682),n=s(57908),r=s(81086),i=s(7653),o=s(75113),d=s(21138),c=s(38077),u=s(40919),m=s(53358),x=s(1794),h=s(3830),p=s(38242),f=s(11360),g=s(87879),b=s(22785);let v=e=>{let{latestCheckpoint:t,selectedTimelineIndex:s,timestamp:d}=e,c=(0,r.b9)(p.$k),u=(0,r.b9)(p.pP),m=(0,i.useMemo)(()=>-1!==s?"Can only restore checkpoints in the active timeline":t?"Revive Devin at ".concat((0,f.i)(null==t?void 0:t.timestamp,!0)):"No checkpoints found",[t,s]);return(0,a.jsx)("div",{className:"flex items-center justify-center dark:text-white",children:(0,a.jsx)(o.u,{content:(0,a.jsx)("span",{className:"text-xs",children:m}),side:"left",className:"mr-4 px-2 py-1",delayDuration:100,onPointerDownOutside:e=>{e.preventDefault()},children:(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)("button",{disabled:-1!==s||!t,onClick:()=>{u(d),c(!0)},className:(0,n.Z)(" flex w-full items-center justify-center",t?"cursor-pointer":"cursor-not-allowed opacity-40","focus:outline-none"),children:(0,a.jsx)(l.y,{size:24,className:-1!==s?"text-gray-400":""})})})})})},j=e=>{let{reviveFunction:t}=e,[s,l]=(0,r.KO)(p.$k),[n]=(0,r.KO)(p.pP),[o,c]=(0,i.useState)({checkpoint:null,masterPlan:null}),{allEvents:v}=(0,u.j1)(),{data:j}=(0,x.o8)(),[k]=(0,r.KO)(h._Z);(0,i.useEffect)(()=>{if(n){let{checkpoint:e,masterPlan:t}=w(v,n);c({checkpoint:e,masterPlan:t})}},[v,n]);let y=(0,g._Z)();return(0,a.jsx)(d.Vq,{open:s,onOpenChange:l,children:(0,a.jsxs)(d.cZ,{className:"text-slate-800 sm:max-w-[625px]",children:[(0,a.jsxs)(d.fK,{children:[(0,a.jsx)(d.$N,{className:"mb-3 text-2xl tracking-tight",children:"Revive Devin"}),(0,a.jsxs)(d.Be,{className:"font-medium  dark:text-slate-200",children:["A new Devin will be created with Devin's brain and machine at this point in time."," ",(0,a.jsx)("span",{className:"text-red-500",children:"Any shell processes that were running at that time will not run."})]})]}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2.5 pb-4",children:[o.checkpoint&&(0,a.jsxs)(d.Be,{className:"font-bold dark:text-slate-200",children:["You are about to spawn a new Devin from this session at"," ",(0,f.i)(o.checkpoint.timestamp,!0),". Proceed?"]}),y&&(0,a.jsx)(b.P,{orgId:null==j?void 0:j.id}),!o.checkpoint&&(0,a.jsx)(d.Be,{className:"font-medium",children:"Error: No checkpoint available to restore"}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(m.z,{className:"mt-2",type:"submit",loading:!1,onClick:()=>{t(o.checkpoint.checkpoint_id,(null==k?void 0:k.value)==="None"?void 0:null==k?void 0:k.value),l(!1)},theme:"primary",size:"sm",disabled:!o.checkpoint,defaultTitle:"Confirm"})})]})]})})},w=(e,t)=>{let s={plan:"",currentStep:""},a=null;for(let l of e){if(l.timestampMs>t)break;(0,c.h6)(l)?"updated_master_plan"===l.type||"user_update_master_plan"==l.type?s.plan=l.plan:"new_master_plan_step"===l.type&&(s.currentStep=l.step):(0,c.pY)(l)&&(a=l)}return{checkpoint:a,masterPlan:s}}},47019:function(e,t,s){"use strict";s.d(t,{default:function(){return rj}});var a,l,n=s(27573),r=s(90276),i=s(45895),o=s(88466),d=s(51430),c=s(84981),u=s(66045),m=s(68299),x=s(80212),h=s(26821),p=s(2560),f=s(57908),g=s(1659),b=s(81086),v=s(30449),j=s(18255),w=s.n(j),k=s(87659),y=s(67754),N=s(7653),C=s(54154),_=s(72048),S=s(61070),E=s(2147),D=s(40919),T=s(4652),F=s(3830);s(69973);let M=e=>{let{devinId:t}=e,{devinState:s}=(0,D.j1)(),a=O(s.status.message),l=O(s.status.shortMessage),{user:r}=(0,T.aF)(),[i]=(0,b.KO)(F.vl),o=s.messageHistoryEvents.length>0?s.messageHistoryEvents[0]:null,d=s.messageHistoryEvents.length>0?s.messageHistoryEvents[s.messageHistoryEvents.length-1]:null,c=(null==o?void 0:o.type)==="initial_user_message"&&(null==o?void 0:o.username)===(null==r?void 0:r.given_name);return(0,N.useEffect)(()=>{let e;let s=null!=i?i:"Untitled",a=e=>{"visible"!==document.visibilityState&&c?document.title=e?s:"\uD83D\uDCAC Devin needs your attention!":document.title=s};(async()=>{if("Devin is awaiting your response."===l&&"visible"!==document.visibilityState&&c&&!await z(t,d)){let t=!1;a(!1),e=setInterval(()=>{a(t=!t)},2500)}else document.title=s})();let n=async()=>{"visible"===document.visibilityState&&(await I(t,d),e&&clearInterval(e),document.title=s)};return document.addEventListener("visibilitychange",n),()=>{e&&clearInterval(e),document.removeEventListener("visibilitychange",n)}},[l,c,o,d,t,i]),(0,n.jsx)(A,{status:s.status.enum,className:"my-1 pt-2 sm:pt-0 md:my-2",children:s.status.isAboveUserLimits?(0,n.jsx)(P,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"hidden lg:block",children:(0,n.jsx)(S.U,{className:"[&_a]:underline [&_a]:underline-offset-1",children:a})}),(0,n.jsx)("div",{className:"text-xs md:text-sm lg:hidden",children:l})]})})},A=e=>{let{status:t,children:s,className:a}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:(0,f.Z)("status-bar rounded-t-xl shadow-[0_-4px_6px_-1px_rgb(0_0_0/0.1),_0_-2px_4px_-2px_rgb(0_0_0/0.1)] sm:rounded-t-none sm:shadow-none dark:text-white",a),children:(0,n.jsx)("div",{className:"status-bar ml-8 mr-20 w-full flex-col !items-start",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(E.J,{status:t,size:"big",animate:!0}),(0,n.jsx)("div",{className:"status-bar--message relative z-10",children:(0,n.jsx)("div",{className:"inline-flex text-neutral-500 dark:text-neutral-400",children:s})})]})})})})},O=e=>"."!==e.trim().charAt(e.length-1)?"".concat(e,"."):e,z=async(e,t)=>{if(!e)return!1;if(!t)return!0;let s=await L(e);return!!s&&!!s.lastTimestamp&&s.lastTimestamp>=t.timestampMs},I=async(e,t)=>{e&&t&&await Z(e,{lastTimestamp:null==t?void 0:t.timestampMs})},L=async e=>{let t=await (0,_.X3)("notifications",1,{upgrade(e){e.objectStoreNames.contains("notifications")||e.createObjectStore("notifications",{keyPath:"id"})}});return await t.get("notifications",e)},Z=async(e,t)=>{let s=await (0,_.X3)("notifications",1,{upgrade(e){e.objectStoreNames.contains("notifications")||e.createObjectStore("notifications",{keyPath:"id"})}});await s.put("notifications",{id:e,...t})},P=()=>{let e=(0,b.b9)(F.DA);return(0,n.jsxs)("div",{className:" gap-1",children:["Devin is sleeping due to usage limits."," ",(0,n.jsx)("div",{onClick:()=>e(!0),className:"inline-block cursor-pointer underline",children:"Manage session usage limit"})," ","or send a message to continue."]})};var R=s(90026),K=s(20185),U=s(61641),V=s(76249),H=s(99994),W=s(5454),q=s(76788),B=s(9565),Y=s(4699),J=s(35592),G=s(81225),$=s(61597),X=s(95014),Q=s(96413),ee=s(85454),et=s(46326),es=s(80498),ea=s(91691),el=s(6113),en=s(11737),er=s(1869),ei=s(83079),eo=s(77900),ed=s(43452),ec=s(18250),eu=s(65880),em=s(58045),ex=s(35914),eh=s(13105),ep=s(26347);let ef=(0,s(62108).Z)({base:0,sm:640,md:768,lg:1024,xl:1280,"2xl":1536});var eg=s(70987),eb=s(58370),ev=s(57069),ej=s(24449),ew=s(50386);let ek="Once you have successfully merged all the fixes into your branch, you should create a PR and share the PR link with me.",ey={active:!1,config:{custom_prompt:"",manager_prompt:ek,timeout:60,root_branch:"",repo:""},description:"",interval:60,num_workers:5,no_manager:!1,snapshot_id:null,tasks:[],title:"",worker_playbook_id:null};var eN=s(70748);s(98699),s(53396);var eC=s(15534),e_=s(32992),eS=s(12122),eE=s(13415),eD=s(94873),eT=s(87879),eF=s(43932);s(75602);var eM=s(82805),eA=s.n(eM),eO=s(40378),ez=s(12985),eI=s(83222),eL=s(11840),eZ=s(5198),eP=s(5530),eR=s(6511),eK=s(30661),eU=s(8570),eV=s(9308),eH=s(53424),eW=s(54661),eq=s(14606),eB=s(14898),eY=s(6468),eJ=s(10613),eG=s(72085),e$=s(82919),eX=s(958),eQ=s(99320),e0=s(51744),e1=s(51070),e2=s(2965),e5=s(74780),e4=s(75895),e8=s(73505),e3=s(58595),e6=s(96719);let e7=(e,t)=>{(0,N.useEffect)(()=>{let s=s=>{e.current&&!e.current.contains(s.target)&&t&&t()};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[e,t])};var e9=s(33264),te=s(55076),tt=s(58022),ts=s(58050),ta=s(94029),tl=s.n(ta),tn=s(52958),tr=s(1138),ti=s(5191),to=s(19771),td=s(41068);let tc=td.fC,tu=td.xz,tm=N.forwardRef((e,t)=>{let{className:s,align:a="center",sideOffset:l=4,...r}=e;return(0,n.jsx)(td.h_,{children:(0,n.jsx)(td.VY,{ref:t,align:a,sideOffset:l,className:(0,eD.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 rounded-md border p-4 shadow-md outline-none",s),...r})})});tm.displayName=td.VY.displayName;var tx=s(38077),th=s(55581),tp=s(77146),tf=s(57568),tg=s(27265),tb=s(33438),tv=s(52483),tj=s(61562),tw=s(73822),tk=s(77051),ty=s(17),tN=s(44453);let tC=e=>{let{children:t,preventAutoFocus:s}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(eh.h_,{modal:!0,children:[(0,n.jsx)(eh.$F,{asChild:!0,onClick:e=>e.preventDefault(),children:(0,n.jsx)("button",{className:"block h-full dark:text-white",children:(0,n.jsx)(ty.i,{size:24,className:""})})}),(0,n.jsx)(eh.AW,{side:"top",align:"end",className:"dark:bg-night mt-2 w-56 bg-white dark:border-[#484848] dark:text-white",onCloseAutoFocus:s?e=>{e.preventDefault()}:void 0,children:t})]})})},t_=e=>{let{children:t,onClick:s,closeOnClick:a=!1,disabled:l}=e;return(0,n.jsx)(tN.ck,{className:"focus:text-accent-foreground relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-[#f2f2f2] enabled:hover:cursor-pointer data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-[rgb(60,60,60)]",disabled:l,onClick:e=>{l||(a||e.preventDefault(),null==s||s())},children:(0,n.jsx)("div",{className:"flex flex-1 items-center justify-between space-x-2.5",children:t})})},tS=e=>{let{title:t,children:s}=e;return(0,n.jsxs)("div",{className:"items-left flex flex-1 flex-col justify-items-start",children:[(0,n.jsx)("div",{className:"ml-2 w-full py-2 text-xs text-gray-500 dark:text-gray-400",children:t}),(0,n.jsx)("div",{className:"",children:s})]})},tE=()=>(0,n.jsx)("div",{className:"my-2 h-px w-full bg-gray-200 dark:bg-[#484848]"}),tD=()=>{let[e,t]=(0,b.KO)(F.y3);return(0,n.jsx)(t_,{onClick:()=>t(!e),closeOnClick:!0,children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(tk.E,{}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Evaluate this session"})]})})};var tT=s(9054),tF=s(1794),tM=s(24898),tA=s(67214),tO=s(53358),tz=s(61802),tI=s(20468);let tL=e=>{let{outcome:t,onOutcomeChanged:s,disabled:a}=e;return(0,n.jsx)("div",{className:"flex justify-between py-1",children:(0,n.jsxs)(tI.fC,{type:"single",disabled:a,value:t,onValueChange:s,children:[(0,n.jsx)(tI.ck,{className:tZ("failure"),value:"failure",children:(0,n.jsx)(tP,{title:"Failure",className:"hover:!border-[#FF8989] hover:!bg-[#FF8989]"})}),(0,n.jsx)(tI.ck,{className:tZ("partial"),value:"partial",children:(0,n.jsx)(tP,{title:"Partial",className:"mx-2 hover:!border-orange-300 hover:!bg-orange-300"})}),(0,n.jsx)(tI.ck,{className:tZ("success"),value:"success",children:(0,n.jsx)(tP,{title:"Success",className:"hover:!border-[#88DD88] hover:!bg-[#88DD88]"})})]})})},tZ=e=>"success"===e?"focus:outline-none focus:border-none [&>div]:data-[state=on]:border-[#44CC44] [&>div]:data-[state=on]:bg-[#44CC44] [&>div]:data-[state=on]:text-[#484848]":"failure"===e?"focus:outline-none focus:border-none [&>div]:data-[state=on]:!border-[#FF5E5E] [&>div]:data-[state=on]:bg-[#FF5E5E] [&>div]:data-[state=on]:text-[#484848]":"focus:outline-none focus:border-none [&>div]:data-[state=on]:!border-ray [&>div]:data-[state=on]:bg-ray [&>div]:data-[state=on]:text-[#484848]",tP=e=>{let{title:t,className:s}=e;return(0,n.jsx)("div",{className:(0,f.Z)("flex cursor-pointer select-none justify-between rounded-md border border-slate-200 px-6 py-1 text-sm focus:border-none focus:outline-none dark:border-white",s),children:(0,n.jsx)("div",{className:"",children:t})})},tR=(e,t,s)=>{let[a,l]=(0,N.useState)(""),[n,r]=(0,N.useState)(!1),[i,o]=(0,N.useState)(""),[d,c]=(0,N.useState)(!1),u=(0,N.useCallback)(async(t,s)=>{try{c(!0),await e_.YZ.put(e,s,t)}catch(e){throw console.error(e),e}finally{c(!1)}},[e]),m=(0,N.useCallback)(async t=>{try{c(!0),await e_.YZ.patch(e,s.id,t)}catch(e){throw console.error(e),e}finally{c(!1)}},[e,s]),x=(0,N.useCallback)(async()=>{try{(null==s?void 0:s.id)&&(!i||i===(null==s?void 0:s.outcome))?a&&a!==(null==s?void 0:s.notes)&&await m(a):await u(i,a),null==t||t()}catch(e){r(!0)}},[u,m,i,a,t,s]),h=(0,N.useCallback)(async e=>{o(e)},[]);return(0,N.useEffect)(()=>{s&&(o(s.outcome),l(s.notes))},[s]),{notes:a,setNotes:l,outcome:i,isLoading:d,error:n,handleSubmit:x,handleOutcomeChanged:h}};(a=l||(l={}))[a.Outcome=0]="Outcome",a[a.Notes=1]="Notes";let tK=e=>{let{devinId:t,onSuccess:s,onCancel:a,existingEvaluation:l,isInitialLoadingComplete:r,hasError:i}=e,[o,d]=(0,N.useState)(0),{handleOutcomeChanged:c,handleSubmit:u,outcome:m,notes:x,setNotes:h,isLoading:p,error:f}=tR(t,s,l),g=(0,N.useCallback)(async e=>{c(e),e&&d(1)},[c]),b=(0,N.useCallback)(()=>{u(),C.A.success("Evaluation submitted successfully")},[u]);return r?f||i?(0,n.jsx)("div",{className:"mx-auto flex h-36 w-full items-center justify-center rounded-lg border border-slate-200 dark:border-none dark:bg-[#484848] dark:text-white",children:(0,n.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center text-center align-middle text-sm",children:[(0,n.jsxs)("div",{children:["There was a problem retrieving the evaluation of this session."," "]}),(0,n.jsx)("div",{children:"Please reload the page and try again."})]})}):(0,n.jsx)("div",{className:"mx-auto w-full rounded-lg border border-slate-200 bg-white px-4 py-2 text-neutral-500 dark:border-none dark:bg-[#484848] dark:text-white",children:(0,n.jsxs)("div",{children:[(0,n.jsx)(C.x,{position:"top-center"}),0===o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tU,{onCancel:a,children:(0,n.jsx)("div",{children:"How would you characterize this session with Devin?"})}),(0,n.jsx)(tL,{outcome:m,onOutcomeChanged:g,disabled:p})]}),1===o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tU,{onCancel:a,children:(0,n.jsxs)("div",{className:"flex h-full items-center pb-1",children:[(0,n.jsx)(tA.X,{weight:"bold",className:"mr-2 cursor-pointer",onClick:()=>d(0)}),(0,n.jsx)("div",{children:"Provide any notes you may have about the session (optional)"})]})}),(0,n.jsx)("input",{value:x,onChange:e=>h(e.target.value),placeholder:"Write any notes here..",className:"min-w-full resize-none rounded-lg border pl-2 text-[0.8rem] leading-8 placeholder-current focus:border-[#6096FF] focus:outline-none dark:border-none dark:bg-[#8F8F8F] dark:text-white"}),(0,n.jsx)("div",{className:"my-4 h-px w-full bg-slate-200 shadow-[1em_0_0_0_rgb(226,232,240),-1em_0_0_0_rgb(226,232,240)] dark:bg-neutral-500 dark:shadow-[1em_0_0_0_rgb(115,115,115),-1em_0_0_0_rgb(115,115,115)]"}),(0,n.jsx)(tO.z,{type:"submit",className:"mb-2 rounded-xl px-5 text-xs",defaultTitle:"Submit",loading:p,disabled:p||!(m||x),size:"sm",onClick:b,theme:"primary"})]})]})}):(0,n.jsx)("div",{className:"mx-auto flex h-36 w-full items-center justify-center rounded-lg border border-slate-200 text-white dark:border-none dark:bg-[#484848]",children:(0,n.jsx)(tz.g,{})})},tU=e=>{let{onCancel:t,children:s}=e;return(0,n.jsxs)("div",{className:"flex h-full items-center justify-between pb-2 text-sm font-semibold",children:[s,(0,n.jsx)("div",{className:"mb-1 mr-[-0.5rem] cursor-pointer p-2",onClick:()=>{null==t||t()},children:(0,n.jsx)(eX.X,{weight:"bold"})})]})};var tV=s(21138);let tH=e=>{let{devinId:t,onSuccess:s,onCancel:a,existingEvaluation:l,isInitialLoadingComplete:r,hasError:i,open:o}=e,{notes:d,setNotes:c,error:u,outcome:m,isLoading:x,handleOutcomeChanged:h,handleSubmit:p}=tR(t,s,l);return(0,n.jsx)(tV.Vq,{open:o,onOpenChange:a,children:(0,n.jsxs)(tV.cZ,{className:"outline-none sm:max-w-[525px]",children:[(0,n.jsx)(tV.fK,{children:(0,n.jsx)(tV.$N,{className:"text-md mb-1 tracking-tight",children:"How would you characterize this session with Devin?"})}),(0,n.jsx)("div",{className:"min-h-32 text-sm",children:(0,n.jsx)(tW,{isInitialLoadingComplete:!!r,isLoading:x,error:!!u||!!i,handleOutcomeChanged:h,handleSubmit:p,outcome:m,notes:d,setNotes:c})})]})})},tW=e=>{let{isLoading:t,isInitialLoadingComplete:s,error:a,handleOutcomeChanged:l,handleSubmit:r,outcome:i,notes:o,setNotes:d}=e;return s?a?(0,n.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center text-center align-middle text-sm",children:[(0,n.jsx)("div",{children:"There was a problem retrieving the evaluation of this run. "}),(0,n.jsx)("div",{children:"Please reload the page and try again."})]}):(0,n.jsxs)("div",{children:[(0,n.jsx)(tL,{outcome:i,onOutcomeChanged:l,disabled:t}),(0,n.jsx)("textarea",{value:o,rows:4,onChange:e=>d(e.target.value),placeholder:"Write any notes here..",className:"my-6 min-w-full resize-none rounded-lg border pl-2 text-[0.8rem] leading-8 placeholder-current focus:border-[#6096FF] focus:outline-none dark:border-none dark:bg-[#8F8F8F] dark:text-white"}),(0,n.jsx)(tO.z,{type:"submit",className:"mb-2 rounded-xl px-5 text-xs",defaultTitle:"Submit",loading:t,disabled:t||!(i||o),size:"sm",onClick:r,theme:"primary"})]}):(0,n.jsx)("div",{className:"mx-auto flex w-full items-center justify-center text-center",children:(0,n.jsx)("div",{className:"mt-12",children:(0,n.jsx)(tz.g,{})})})},tq=e=>{let{devinId:t}=e,{userId:s}=(0,T.aC)(),{devinState:{status:a}}=(0,D.j1)(),{data:l,isFetched:r}=(0,tF.eW)(),[i,o]=(0,N.useState)(!1),[d,c]=(0,b.KO)(F.y3),[u,m]=(0,N.useState)(!1),[x,h]=(0,N.useState)(!1);(0,N.useEffect)(()=>{if(!l)return;let e=l.map(e=>e.id);1===e.length&&"org_2gRltRfqyiDFAFBOJHfWH9TxVJb"===e[0]&&h(!0)},[l]);let[p,f]=(0,tT.Z)(async()=>tM.Y.getLatest(t),[t]);(0,N.useEffect)(()=>{o("finished"===a.enum)},[a.enum]),(0,N.useEffect)(()=>{"finished"!==a.enum||p.loading||p.error||null!==p.value||!x||m(!0)},[a.enum,x,p.loading,p.error,p.value,t]),(0,N.useEffect)(()=>{d&&o(!1)},[d]),(0,N.useEffect)(()=>{s&&f()},[f,s]),(0,N.useEffect)(()=>{c(!1)},[t,c]);let g=(0,N.useCallback)(async()=>{c(!1),m(!1),"finished"===a.enum&&o(!0),await f()},[f,c,a.enum]),v=(0,N.useCallback)(()=>{c(!1),"finished"===a.enum&&o(!0)},[c,a.enum]),j=(0,N.useCallback)(()=>{o(!1),c(!0)},[c]);return s?(0,n.jsxs)(n.Fragment,{children:[i&&(0,n.jsxs)("div",{className:"mx-8 my-2 hidden w-full text-xs italic text-neutral-500 md:block dark:text-neutral-400",children:[p.value?"To update your evaluation of this session, ":"If you'd like to evaluate this session, ",(0,n.jsx)("span",{onClick:j,className:"cursor-pointer underline",children:"click here"}),"."]}),d&&(0,n.jsx)("div",{className:"mx-8 my-2",children:(0,n.jsx)(tK,{isInitialLoadingComplete:!p.loading&&r,existingEvaluation:p.value,hasError:!!p.error,devinId:t,onSuccess:g,onCancel:v})}),(0,n.jsx)(tH,{open:u,isInitialLoadingComplete:!p.loading&&r,existingEvaluation:p.value,hasError:!!p.error,devinId:t,onSuccess:g,onCancel:()=>m(!1)})]}):null};var tB=s(9295);let tY=()=>{let[e,t]=(0,b.KO)(F.cp);return(0,n.jsx)(t_,{onClick:()=>t(!e),closeOnClick:!0,children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(tB.H,{}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Control Devin's Speed"})]})})},tJ=e=>{let{emitSpeedUpdate:t}=e,{devinState:s}=(0,D.j1)(),[a]=(0,b.KO)(F.cp);return(0,n.jsx)(n.Fragment,{children:a&&(0,n.jsx)("div",{className:"mx-8 my-2",children:(0,n.jsxs)("div",{className:"mx-auto w-full rounded-lg border border-slate-200 bg-white px-4 py-2 text-neutral-500 dark:border-none dark:bg-[#484848] dark:text-white",children:[(0,n.jsx)("div",{className:"flex items-center justify-between pb-2 text-sm font-semibold",children:"Devin Speed Control"}),(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"flex justify-between py-1",children:(0,n.jsxs)(tI.fC,{type:"single",disabled:"finished"===s.status.enum,value:s.speed,onValueChange:e=>{t(e)},children:[(0,n.jsx)(tI.ck,{className:tG("normal"),value:"normal",children:(0,n.jsx)(t$,{title:"Normal",className:"mx-2 hover:!border-orange-300 hover:!bg-orange-300"})}),(0,n.jsx)(tI.ck,{className:tG("fast"),value:"fast",children:(0,n.jsx)(t$,{title:"Fast",className:"hover:!border-[#88DD88] hover:!bg-[#88DD88]"})})]})})})]})})})},tG=e=>"fast"===e?"focus:outline-none focus:border-none [&>div]:data-[state=on]:border-[#44CC44] [&>div]:data-[state=on]:bg-[#44CC44] [&>div]:data-[state=on]:text-[#484848]":"slow"===e?"focus:outline-none focus:border-none [&>div]:data-[state=on]:!border-[#FF5E5E] [&>div]:data-[state=on]:bg-[#FF5E5E] [&>div]:data-[state=on]:text-[#484848]":"focus:outline-none focus:border-none [&>div]:data-[state=on]:!border-ray [&>div]:data-[state=on]:bg-ray [&>div]:data-[state=on]:text-[#484848]",t$=e=>{let{title:t,className:s}=e;return(0,n.jsx)("div",{className:(0,f.Z)("flex cursor-pointer select-none justify-between rounded-xl border border-slate-200 px-6 py-1 text-sm focus:border-none focus:outline-none dark:border-white",s),children:(0,n.jsx)("div",{className:"",children:t})})},tX=e=>{let t=(0,eS.F)(e=>e.setSelectedPlaybook),s=(0,eS.F)(e=>e.setSelectedSnapshot),a=(0,y.useRouter)(),l=(0,ej.aM)().data,n=(0,eg.qN)().data;return(0,N.useCallback)(()=>{if(!e)return;let r=null==l?void 0:l.find(t=>t.id===e.playbook_id);t(null!=r?r:null);let i=null==n?void 0:n.find(t=>t.snapshot_id===e.snapshot_id);s(null!=i?i:eS._);let o=e.initial_user_message_contents.message,d=-1!==o.indexOf("\nATTACHMENT:")?o.indexOf("\nATTACHMENT:"):-1!==o.indexOf("\nPLAYBOOK_md:")?o.indexOf("\nPLAYBOOK_md:"):o.indexOf("\nPLAYBOOK_txt:"),c=-1!==d?o.slice(0,d):o,u=o.match(/ATTACHMENT:(\{.*?\}(?=\sATTACHMENT:|\s*$)|"https?:\/\/[^\n]+")/g),m=[];if(u){for(let e of u)if(e.startsWith('ATTACHMENT:"')&&e.endsWith('"')){let t=e.slice(12,-1),s=t.split("/").pop().replaceAll(/\u202F/g,"");m.push({type:"uploaded",name:s,contents:t})}}let x=new URLSearchParams({from:e.devin_id.replace("devin-",""),prompt:c,attachments:JSON.stringify(m)});a.push("/?".concat(x.toString()))},[e,n,l,t,s,a])};var tQ=s(56098),t0=s(73360),t1=s(80819),t2=s.n(t1),t5=s(52635);let t4=()=>{let{setShowShareModal:e}=t6();return(0,n.jsx)(t_,{onClick:()=>e(!0),closeOnClick:!0,children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(tQ.D,{}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Share"})]})})};function t8(){let{showShareModal:e,setShowShareModal:t}=t6(),s=(0,N.useRef)(null),a=(0,N.useCallback)(()=>t(!1),[t]);return(0,n.jsx)(tV.Vq,{open:e,onOpenChange:t,children:(0,n.jsxs)(tV.cZ,{className:"outline-none sm:max-w-[425px]",ref:s,children:[(0,n.jsxs)(tV.fK,{children:[(0,n.jsx)(tV.$N,{className:"dark:text-white",children:"Share link to session"}),(0,n.jsx)(tV.Be,{className:"pb-2 dark:text-white",children:"Any authenticated user with the link will be able to view the shared session, including any future messages."})]}),(0,n.jsx)(tV.cN,{children:(0,n.jsx)(t3,{onSuccess:a,containerRef:s})})]})})}let t3=e=>{let{onSuccess:t,containerRef:s}=e,a=(0,N.useRef)(null),l=(0,y.usePathname)(),[r,i]=(0,N.useState)(window.location.origin+l);(0,N.useEffect)(()=>{if(!a.current||!s.current)return;let e=new(t2())(a.current,{container:s.current});return()=>{e.destroy()}},[a,s]),(0,N.useEffect)(()=>{i(window.location.origin+l)},[l]);let o=(0,N.useCallback)(async()=>{try{let e=l.split("/").pop();await (0,e_.lP)("devin-"+e),t(),(0,C.A)((0,n.jsxs)("div",{className:"flex space-x-2 font-medium",children:[(0,n.jsx)(t0.w,{className:"mt-0.5 h-4 w-4 flex-shrink-0"}),(0,n.jsx)("span",{className:"whitespace-nowrap text-sm",children:"Your session link was copied to the clipboard"})]}),{duration:5e3})}catch(e){C.A.error("Something went wrong, please try again!")}},[l,t]);return(0,n.jsx)("button",{type:"submit",onClick:o,"data-clipboard-text":r,className:"rounded-md bg-[#6096FF] px-4 py-2 font-medium text-white duration-150 hover:bg-blue-500",ref:a,children:"Create and copy link"})},t6=()=>{let[e,t]=(0,b.KO)(F.nm);return{showShareModal:e,setShowShareModal:(0,N.useCallback)(e=>{t5.Z.trackInteraction(t5.j.SHARE_SESSION),t(e)},[t])}};var t7=s(38370);let t9=e=>{let{sessionId:t,isInMenu:s=!0}=e,{orgId:a,userId:l}=(0,T.aC)(),[r,i]=(0,em.Z)("allows-get-slack-notifications",!1),{data:o,isLoading:d}=(0,eg.iA)(t),{data:c}=(0,eg.vz)(l||""),{data:u,isLoading:m}=(0,eg.ky)(a||""),x=(0,N.useMemo)(()=>{var e;return!!(null==c?void 0:null===(e=c.slack)||void 0===e?void 0:e.user_id)},[c]);(0,N.useEffect)(()=>{o&&!d&&i(o.notifications_enabled)},[o,d,i]);let h=(0,N.useCallback)(async()=>{if(t5.Z.trackInteraction(t5.j.TOGGLE_SLACK_NOTIFICATIONS),!x){window.location.href="/settings/integrations";return}i(!r),await (0,e_.J4)(t,!r)},[t,r,i,x]),p=(0,N.useMemo)(()=>x?r?"Disable Slack notifications":"Enable Slack notifications":"Connect Slack User",[x,r]),g=(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(t7.M,{size:s?14:16}),(0,n.jsx)("span",{className:"ml-2",children:p})]});return!d&&!m&&u&&(null==u?void 0:u[0])?s?(0,n.jsx)(t_,{onClick:h,closeOnClick:!0,children:g}):(0,n.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,n.jsx)("div",{className:"text-sm text-black opacity-50 dark:text-white",children:"Get notified when Devin has any updates"}),(0,n.jsx)("div",{className:"w-fit",children:(0,n.jsx)("button",{onClick:h,className:(0,f.Z)("flex items-center rounded-sm border px-4 py-2 text-sm text-black opacity-70 duration-100",r&&x?"bg-pacific border-pacific text-pacific bg-opacity-5 enabled:hover:bg-opacity-15":"border-black enabled:hover:bg-black enabled:hover:bg-opacity-10 dark:border-white dark:text-white enabled:dark:hover:bg-white enabled:dark:hover:bg-opacity-10"),disabled:d,children:g})})]}):null};var se=s(77748),st=s(86235),ss=s(45660),sa=s(20734),sl=s(52111);let sn=()=>{let{shouldRestrictFeatures:e,planUsesCredits:t,isSubscriptionValid:s}=(0,eb.b1)(),a=(0,b.b9)(F.DA);return s&&t?(0,n.jsx)(eb.Hd,{side:"left",children:(0,n.jsx)("div",{children:(0,n.jsx)(t_,{onClick:()=>a(!0),closeOnClick:!0,disabled:e,children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(se.a,{}),(0,n.jsx)("span",{className:"ml-2",children:"Spending limits"})]})})})}):null},sr=e=>{let{sessionId:t}=e,s=(0,e9.x)(e=>e.setHasSetNewSessionUsageLimit),[a,l]=(0,b.KO)(F.DA),[r,i]=(0,N.useState)(!1),[o,d]=(0,N.useState)(0),[c,u]=(0,N.useState)(0),{loading:m,error:x}=(0,st.Z)(async()=>{if(!a)return;let e=await e_.R9.spendingLimits.get(t);e&&(d(e.currentLimit),u(e.currentUsage))},[t,a]),[h,p]=(0,tT.Z)(async()=>{await e_.R9.spendingLimits.post(t,o,r),s(!0),l(!1),C.A.success("Spending limits set")},[o,r]);return(0,n.jsx)(tV.Vq,{open:a,onOpenChange:l,children:(0,n.jsxs)(tV.cZ,{className:"outline-none sm:max-w-[525px]",children:[(0,n.jsx)(tV.fK,{children:(0,n.jsx)(tV.$N,{className:"text-md mb-1 tracking-tight",children:"Set spending limits"})}),(0,n.jsx)("div",{className:"min-h-32 text-sm",children:(0,n.jsx)(si,{loading:m,error:x,updateState:h,onUpdate:p,currentUsage:c,currentLimit:o,isGlobalLimit:r,setIsGlobalLimit:i,setCurrentLimit:d})})]})})},si=e=>{let{loading:t,error:s,updateState:a,currentLimit:l,currentUsage:r,isGlobalLimit:i,onUpdate:o,setIsGlobalLimit:d,setCurrentLimit:c}=e,[u,m]=(0,N.useState)("");if(s)return(0,n.jsx)("div",{className:"flex h-full min-h-[350px] w-full",children:"There was an error retrieving the session spending limits. Please try again later."});let x=t||a.loading,h="mb-6 min-w-full rounded-sm text-[0.8rem] leading-8 pl-2 resize-none dark:border-none border";return(0,n.jsxs)("div",{className:"min-h-[350px] text-sm",children:[a.error&&(0,n.jsx)(sl.b,{status:"error",className:"mb-4",children:"There was a problem updating the session. Please try again later."}),(0,n.jsx)("div",{className:"mb-4 flex flex-col space-y-2.5 ",children:"ACU limits prevent excessive ACU usage during a session. Devin sleeps when the limit is reached but can be woken anytime."}),(0,n.jsx)("div",{className:"mb-4 flex flex-col space-y-2.5 ",children:"To remove any limits, set the value to 0."}),(0,n.jsx)("div",{className:"my-6 h-px w-full bg-gray-200 dark:bg-[#484848]"}),(0,n.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex w-full flex-col items-baseline justify-between",children:[(0,n.jsx)("div",{className:"flex w-full flex-row items-baseline justify-between",children:(0,n.jsx)("div",{className:"text-[0.8rem]",children:"Current Session Usage"})}),(0,n.jsx)("input",{className:h,type:"number",required:!0,autoComplete:"off",value:(0,sa.$)(r),readOnly:!0,disabled:!0})]}),(0,n.jsxs)("div",{className:"flex w-full flex-col items-baseline justify-between",children:[(0,n.jsxs)("div",{className:"flex w-full flex-row items-baseline justify-between",children:[(0,n.jsx)("div",{className:"text-[0.8rem]",children:"ACU limit"}),(0,n.jsx)("div",{className:"text-right text-xs",children:u})]}),(0,n.jsx)("input",{className:h,type:"number",required:!0,autoComplete:"off",step:1,disabled:x,value:l,onChange:e=>c(Number(e.target.value)),min:0,max:1e4})]}),(0,n.jsxs)("div",{className:"flex w-full flex-row items-center justify-between space-x-2 px-1 text-sm",children:[(0,n.jsxs)("div",{children:["Save in"," ",(0,n.jsx)(k.default,{className:"underline",href:"/settings/usage",target:"_blank",rel:"noopener noreferrer",children:"Usage & Limits"})," ","for future sessions"]}),(0,n.jsx)(ss.r,{checked:i,disabled:x,onCheckedChange:d})]}),(0,n.jsx)("div",{className:"mt-6 flex w-full justify-end",children:(0,n.jsx)(tO.z,{onClick:()=>{if(l<0){m("Value cannot be negative");return}if(l%1!=0){m("Value must be an integer");return}if(l>1e4){m("Value cannot be greater than 10000");return}m(""),o()},className:"w-28",loading:x,disabled:x,defaultTitle:"Save",theme:"primary",size:"sm"})})]})]})},so=e=>{let{session:t,handleRenameEnable:s}=e,{userId:a,orgId:l}=(0,T.aC)(),r=(null==t?void 0:t.created_by.id)===a,i=tX(t),o=(0,te.aC)(),d=(0,N.useCallback)(async()=>{if(!t)return;let e=await (0,e_.Ay)(t.devin_id,!t.unlisted);(null==e?void 0:e.success)?o(t.devin_id,e=>({...e,unlisted:!e.unlisted})):C.A.error("Failed to unlist session")},[t,o]),c="undefined"!=typeof localStorage&&!!localStorage.speedControlFeatureEnabled;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(tC,{preventAutoFocus:!0,children:[(0,n.jsx)(t_,{onClick:s,closeOnClick:!0,children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(U.z,{}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Rename"})]})}),!r||(null==l?void 0:l.startsWith("personal-"))?null:(0,n.jsx)(t_,{onClick:d,closeOnClick:!0,children:(0,n.jsxs)("div",{className:"flex items-center",children:[(null==t?void 0:t.unlisted)?(0,n.jsx)(tb.b,{}):(0,n.jsx)(tv.N,{}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:(null==t?void 0:t.unlisted)?"Make visible to team":"Hide from team"})]})}),(0,n.jsx)(t_,{onClick:i,children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(tj.G,{}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Start duplicate session"})]})}),(0,n.jsx)(tE,{}),(0,n.jsx)(t4,{}),(0,n.jsx)(tD,{}),c&&(0,n.jsx)(tY,{}),(0,n.jsx)(sn,{}),(0,n.jsx)(t9,{sessionId:t.devin_id,isInMenu:!0})]}),(0,n.jsx)(t8,{}),(0,n.jsx)(sr,{sessionId:t.devin_id})]})},sd=N.memo(e=>{let{sessionName:t,handleRenameChange:s,handleRenameKeyDown:a,handleRenameOnBlur:l,renameIsEnabled:r,renameInputRef:i}=e;return e7(i,()=>{l()}),(0,n.jsx)("input",{type:"text",className:"read-only:dark:bg-shade w-full text-ellipsis rounded-md border border-transparent bg-slate-50 py-2 pl-2 pr-2 text-xl font-bold leading-none tracking-tight read-only:cursor-default read-only:bg-white read-only:pl-0 focus:border-slate-200 focus:outline-none read-only:focus:border-transparent dark:bg-[#484848] dark:text-white dark:focus:border-[#383838] read-only:dark:focus:border-transparent",value:t,onChange:s,onKeyDown:a,placeholder:"Untitled",readOnly:!r,ref:i})}),sc=e=>{let t=(0,N.useRef)(null),[s,a]=(0,N.useState)(!1),[l,n]=(0,N.useState)((null==e?void 0:e.title)||"Untitled"),r=(0,b.b9)(F.vl),i=(0,te.aC)(),{mutate:o,error:d}=(0,tw.D)({mutationFn:async t=>{if(!e)return;let{title:s}=await (0,e_.r1)(e.devin_id,t);return{title:s}},onSettled(e){r((null==e?void 0:e.title)||"Untitled")},onSuccess(t){e&&i(e.devin_id,e=>({...e,title:t.title}))}}),c=(0,N.useCallback)(()=>{a(!1),n((null==e?void 0:e.title)||"Untitled")},[a,n,null==e?void 0:e.title]),u=(0,N.useCallback)(e=>{n(e.target.value)},[n]),m=(0,N.useCallback)(()=>{a(!0),t.current&&t.current.focus()},[a,t]),x=(0,N.useCallback)(t=>{if("Enter"===t.key){o(l,{onSettled:()=>{a(!1)}});return}if("Escape"===t.key){a(!1),n((null==e?void 0:e.title)||"Untitled");return}},[o,l,null==e?void 0:e.title]);return(0,N.useEffect)(()=>{!s&&(null==e?void 0:e.title)&&l!==(null==e?void 0:e.title)&&n(e.title)},[s,l,e,n]),(0,N.useEffect)(()=>{d&&(a(!1),n((null==e?void 0:e.title)||"Untitled"))},[null==e?void 0:e.title,d]),{renameInputRef:t,sessionName:l,renameIsEnabled:s,handleRenameEnable:m,handleRenameKeyDown:x,handleRenameOnBlur:c,handleRenameChange:u,changeTitleMutate:o}};var su=s(91854);let sm={id:0,name:"",prompts:[{id:0,type:tg.iW.EVAL_PROMPT,content:""}],description:""};function sx(e){switch(e){case tg.iW.EVAL_PROMPT:return"Eval Prompt";case tg.iW.EDIT_EVAL_PROMPT:return"Edit Eval Prompt";case tg.iW.EVAL_COMMAND:return"Eval Command"}}function sh(e){let{devinId:t}=e,s=!!t,[a]=(0,b.KO)(F.JU),{timelineState:{allEvents:l}}=(0,D.j1)(),[r,i]=(0,b.KO)(F.vl),[o,d]=(0,N.useState)(0),[c,u]=(0,N.useState)(!1),[m,x]=(0,N.useState)(t?"main":"new"),[h,p]=(0,N.useState)([]),{data:g,isLoading:v,refetch:j}=(0,tf.An)(),[w,k]=(0,N.useState)(null),{handleRenameChange:y}=sc(),C=(0,N.useMemo)(()=>l.filter(tx.Bd),[l]);(0,N.useEffect)(()=>{if(t){let e=async()=>{let{has_verifier_results:e,results:s}=await (0,tg.k)(t);e&&(C.length>0?_(s.map(e=>({verifier_id:e.verifier_id,score:e.score,has_run:e.has_run,run_at:e.run_at,prompt:{type:e.prompt.type,content:e.prompt.content}}))):p(s))},s=tl()(e,500);return s(),()=>{s.cancel()}}},[t,C]);let _=e=>{if(d(e.length),p(e),e.length>0){let s=function(e){if(!e||0===e.length)return null;let t=e.reduce((e,t)=>e+(t.score||0),0)/e.length;return t>=.8?1:t>=.5?.5:0}(e);k(s),sb(s,t,r,i,y)}};(0,N.useEffect)(()=>{c&&d(0)},[c]);let S=null==g?void 0:g.find(e=>e.id===a),E=(null==S?void 0:S.prompts.length)||0,T=l[l.length-1],M=!!s&&((0,tx.J8)(T)||(0,tx.kI)(T));return(0,n.jsx)(sp,{devinId:t,confirmationCriteriaData:g,isLoading:v,isInSession:s,refetchCriteria:j,open:c,setOpen:u,currentPage:m,setCurrentPage:x,sessionCriteria:h,overallEvalScore:w,isDevinExited:M,children:s?(0,n.jsxs)("button",{className:(0,f.Z)("relative rounded-full p-[0.3rem] outline-none transition duration-100 focus:outline-none",M?"bg-slate-100 hover:bg-slate-200 dark:bg-[#737373] dark:text-white hover:dark:bg-[rgb(100,100,100)]":"enabled:focus:dark:bg-night enabled:hover:dark:bg-night dark:bg-shade bg-slate-100 enabled:hover:bg-slate-200 enabled:focus:bg-slate-200"),children:[(0,n.jsx)(ts.X,{size:12}),o>0&&(0,n.jsx)("div",{className:"absolute -right-1 -top-1 flex h-3 w-3 items-center justify-center rounded-full bg-blue-500 text-[9px] text-white",children:o})]}):(0,n.jsxs)("div",{className:"flex cursor-pointer items-center gap-1 whitespace-nowrap rounded-md px-2 py-1 transition ".concat(a?"bg-pacific text-white hover:bg-blue-500":"dark:bg-night dark:hover:bg-extra-night bg-slate-100 hover:bg-slate-200"),children:[a?"".concat(E," active evaluation").concat(1!==E?"s":""):"Select completion criteria",(0,n.jsx)(ts.X,{className:"h-4 w-4"})]})})}function sp(e){let{children:t,devinId:s,confirmationCriteriaData:a,isLoading:l,isInSession:r,refetchCriteria:i,open:o,setOpen:d,currentPage:c,setCurrentPage:u,sessionCriteria:m,overallEvalScore:x,isDevinExited:h}=e,[p,g]=(0,b.KO)(F.JU),{confirmationCriteria:v,setConfirmationCriteria:j}=(0,eS.F)(),[w,k]=(0,N.useState)(!1),[y,_]=(0,N.useState)(sm);(0,N.useEffect)(()=>{a&&j(a)},[a]);let S=(e,t)=>{_(s=>{let a=[...s.prompts];return a[e].content=t,{...s,prompts:a}})},E=e=>{u("edit-".concat(e));let t=null==v?void 0:v.find(t=>t.id===e);t&&_(t)},D=async e=>(await (0,tg.Yc)({eval_request:e},s)).eval_score,T=async()=>{if(""===y.name){C.A.error("Criteria name is required");return}j([...v,await (0,tg.NA)(y)]),_(sm),u("main"),i()},M=async()=>{if(""===y.name){C.A.error("Criteria name is required");return}await (0,tg.fi)(y),j(v.map(e=>e.id===y.id?y:e)),C.A.success("Criteria updated"),u("main"),i()},A=async()=>{await (0,tg.Rg)(y.id),j(v.filter(e=>e.id!==y.id)),C.A.success("Criteria deleted"),u("main"),k(!1),i()},O=e=>{_(t=>({...t,prompts:t.prompts.filter((t,s)=>s!==e)}))},z=e=>p===e,I="new"===c||c.startsWith("edit-");return(0,n.jsxs)(tc,{open:o,onOpenChange:e=>{d(e),e&&r?u("session"):u("main"),_(sm)},children:[(0,n.jsx)(tu,{asChild:!0,children:t}),(0,n.jsx)(tm,{side:"bottom",align:"center",sideOffset:4,className:(0,f.Z)(s?"ml-2":"mr-7","dark:border-input-dark dark:bg-night max-h-[80vh] min-w-[500px] max-w-[50vw] overflow-hidden border bg-white p-0"),children:(0,n.jsxs)("div",{className:"relative h-full min-h-[400px] w-full",children:[(0,n.jsx)(eo.E.div,{initial:{x:0},animate:{x:"main"===c?0:"-100%"},transition:{type:"tween",duration:.1,ease:"easeOut"},className:"absolute left-0 top-0 h-full w-full overflow-y-auto p-4",children:"main"===c&&(0,n.jsxs)("div",{className:"flex h-full flex-col",children:[(0,n.jsxs)("div",{className:"dark:border-input-dark mb-2 flex items-center justify-between whitespace-nowrap border-b pb-2.5",children:[(0,n.jsx)("h2",{className:"text-xl font-medium",children:"Completion Criteria Library"}),(0,n.jsx)(th.z,{theme:"primary",size:"sm",onClick:()=>{u("new"),_(sm)},defaultTitle:(0,n.jsxs)(n.Fragment,{children:["Add Criteria\xa0",(0,n.jsx)(e5.v,{size:14})]})})]}),(0,n.jsx)("div",{className:"flex h-full flex-col",children:l?(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)(to.T,{size:"sm"})}):0===v.length?(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)("span",{className:"mb-3 text-sm opacity-60",children:"No criteria found. Add one to get started."})}):v.map(e=>(0,n.jsxs)(eo.E.button,{layout:!0,className:(0,f.Z)("dark:hover:bg-cloud/25 group mb-0.5 flex w-full items-center justify-between gap-2 rounded-md px-2 py-1.5 text-xs font-light transition-colors hover:bg-slate-200 2xl:text-sm dark:text-white/50 dark:hover:text-white",z(e.id)&&"dark:bg-cloud/50 bg-slate-200 dark:text-white"),onClick:()=>{g(t=>t===e.id?null:e.id)},children:[(0,n.jsxs)("div",{className:"flex flex-1 items-center gap-2 overflow-hidden",children:[(0,n.jsx)("div",{className:(0,f.Z)("flex size-4 items-center justify-center rounded-full border border-neutral-300 outline-none focus:outline-none group-hover:border-neutral-600 dark:border-white/50 group-hover:dark:border-white",z(e.id)&&"border-neutral-600 dark:border-white"),children:(0,n.jsx)(ed.M,{children:z(e.id)&&(0,n.jsx)(eo.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},children:(0,n.jsx)(tn.Z,{size:12})})})}),(0,n.jsx)("span",{className:"pointer-events-none flex-1 select-none truncate text-left",children:e.name})]}),(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsxs)("span",{className:"hover:border-night border-b border-transparent opacity-0 transition-opacity group-hover:opacity-100 dark:hover:border-slate-200",onClick:()=>E(e.id),children:[(0,n.jsx)("span",{className:"mr-0.5 mt-0.5 text-xs",children:"Edit"}),(0,n.jsx)(tr.Z,{size:12,className:"inline"})]})})]},e.id))}),s&&m.length>0&&(0,n.jsxs)("div",{onClick:()=>u("session"),className:"hover:border-night ml-auto mt-auto flex w-fit cursor-pointer items-center gap-0.5 border-b border-transparent pb-0.5 text-xs dark:hover:border-slate-200",children:["Current session criteria"," ",(0,n.jsx)(tr.Z,{size:13,className:"inline"})]})]})}),(0,n.jsx)(eo.E.div,{initial:{x:"100%"},animate:{x:"session"===c?0:"100%"},transition:{type:"tween",duration:.1,ease:"easeInOut"},className:"absolute left-0 top-0 h-full w-full overflow-y-auto p-4",children:"session"===c&&(0,n.jsxs)("div",{className:"flex h-full flex-col",children:[(0,n.jsxs)("div",{className:"dark:border-input-dark mb-2 flex items-center gap-2 whitespace-nowrap border-b pb-2.5",children:[(0,n.jsx)(sg,{onClick:()=>u("main"),hasUnsavedChanges:!1}),(0,n.jsx)("h2",{className:"text-xl font-medium",children:"Session Criteria"})]}),(0,n.jsx)("div",{className:"flex h-full flex-col",children:0===m.length?(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)("span",{className:"px-5 text-sm opacity-60",children:"No criteria set for this session"})}):(0,n.jsxs)("div",{className:"h-full w-full",children:[m.map((e,t)=>(0,n.jsx)("div",{className:"mb-2 rounded-md border border-neutral-300 p-2 dark:border-white/10",children:(0,n.jsxs)("div",{className:"flex items-center justify-between px-0.5",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-pacific mx-1",children:t+1}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("span",{className:"text-[9px] opacity-60",children:sx(e.prompt.type)}),(0,n.jsx)("span",{className:"text-sm font-medium",children:e.prompt.content})]})]}),(0,n.jsx)("span",{className:"mr-1 text-xs opacity-60",children:e.score?e.score.toFixed(2):"In progress..."})]})},e.verifier_id)),null!==x?(0,n.jsx)("div",{className:"mt-4 flex w-full flex-col items-center",children:(0,n.jsxs)("div",{className:"text-sm font-medium",children:["Overall Eval Score: ",x]})}):null]})})]})}),(0,n.jsx)(eo.E.div,{initial:{x:"100%"},animate:{x:I?0:"100%"},transition:{type:"tween",duration:.1,ease:"easeInOut"},className:"absolute left-0 top-0 h-full w-full overflow-y-auto p-4",children:I&&(0,n.jsxs)("div",{className:"flex h-full flex-col overflow-y-auto",children:[(0,n.jsxs)("div",{className:"mb-3.5 flex items-center justify-between gap-2",children:[(0,n.jsx)(sg,{onClick:()=>u("main"),hasUnsavedChanges:JSON.stringify(y)!==JSON.stringify(sm)&&"new"===c}),(0,n.jsx)("input",{type:"text",value:y.name,onChange:e=>_(t=>({...t,name:e.target.value})),placeholder:"new"===c?"New Criteria":"Criteria Name",required:!0,className:"hover:border-night focus:border-night dark:border-input-dark w-full border-b bg-transparent text-lg font-medium outline-none transition dark:hover:border-slate-300 dark:focus:border-slate-300"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(su.T,{title:"Delete Criteria",description:"Are you sure you want to delete this criteria?",onConfirm:A,open:w,onCancel:()=>k(!1)}),(0,n.jsx)(th.z,{type:"submit",theme:"primary",size:"sm",defaultTitle:"new"===c?"Add":"Save",onClick:"new"===c?T:M}),"new"!==c&&(0,n.jsx)(th.z,{type:"button",size:"sm",defaultTitle:(0,n.jsx)("span",{children:(0,n.jsx)(H.r,{size:13})}),onClick:()=>k(!0),theme:"danger"})]})]}),y.prompts.map((e,t)=>(0,n.jsx)(sf,{prompt:e,onChange:e=>S(t,e),index:t,isInSession:r,handleRunPrompt:D,handleDeletePrompt:O,newCriteria:y,setNewCriteria:_,isDevinExited:h},t)),(0,n.jsx)("div",{onClick:()=>{_(e=>({...e,prompts:[...e.prompts,{id:0,type:tg.iW.EVAL_PROMPT,content:""}]}))},className:"dark:border-input-dark dark:bg-input-dark dark:hover:bg-extra-night mx-auto mt-2 w-min cursor-pointer whitespace-nowrap rounded-md border bg-slate-100 p-1.5 text-sm transition hover:bg-slate-200",children:(0,n.jsx)(e5.v,{size:16})})]})})]})})]})}let sf=e=>{let{prompt:t,onChange:s,index:a,isInSession:l,handleRunPrompt:r,handleDeletePrompt:i,newCriteria:o,setNewCriteria:c,isDevinExited:u}=e,[m,x]=(0,N.useState)(!1),[h,p]=(0,N.useState)(null),g=async()=>{if(!l||!u){C.A.error("Try running this in a completed Devin session instead.");return}if(!m&&""!==t.content&&!h){x(!0);try{let e=await r(t);p(Math.max(.01,Number(e.toFixed(2))))}catch(e){C.A.error("Failed to run prompt")}finally{x(!1)}}};return(0,n.jsxs)("div",{className:"mb-3.5 flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)("div",{onClick:g,className:(0,f.Z)(l&&!m&&u?"dark:active:bg-night cursor-pointer transition hover:opacity-100 active:bg-slate-200":"cursor-not-allowed opacity-60","dark:bg-input-dark group flex h-8 w-8 items-center justify-center rounded-md bg-slate-200 px-1 text-xs"),children:["[",(0,n.jsxs)("span",{className:"block w-3.5 pl-[1px] text-xs group-hover:hidden",children:["\xa0",a+1,"\xa0"]}),(0,n.jsx)("span",{className:"hidden w-3.5 pl-[2px] text-xs group-hover:block",children:"▶"}),"]"]}),(0,n.jsx)("div",{className:"flex-grow",children:(0,n.jsx)("textarea",{placeholder:"Eval Prompt",value:t.content,onChange:e=>s(e.target.value),className:"dark:bg-input-dark w-full rounded-md border hover:border-gray-700 dark:hover:border-gray-400 bg-slate-100 px-2.5 py-[5px] text-[13px] outline-none ring-0 transition focus-within:border-neutral-400 dark:border-neutral-500 dark:focus-within:border-neutral-400",rows:1})}),(0,n.jsx)(tp.P,{value:t.type,onValueChange:e=>{let t=[...o.prompts];t[a].type=e,c({...o,prompts:t})},defaultValue:"regular",itemsList:[{value:"eval_prompt",label:sx(tg.iW.EVAL_PROMPT)},{value:"edit_eval_prompt",label:sx(tg.iW.EDIT_EVAL_PROMPT)},{value:"eval_command",label:sx(tg.iW.EVAL_COMMAND)}],className:"w-32"}),(0,n.jsx)("div",{onClick:()=>{o.prompts.length>1?i(a):C.A.error("At least one prompt is required.")},className:(0,f.Z)(o.prompts.length>1?"dark:hover:bg-night cursor-pointer hover:bg-rose-200 hover:text-red-500":"cursor-not-allowed opacity-60","dark:bg-input-dark flex h-8 w-8 items-center justify-center rounded-md bg-slate-100 p-2 text-gray-500 transition dark:text-gray-300"),children:(0,n.jsx)(H.r,{size:14})})]}),(null!==h||m)&&(0,n.jsxs)("div",{className:"dark:bg-shade ml-10 flex items-center gap-2 rounded-sm border border-gray-300 bg-yellow-50 p-2 font-mono text-xs dark:border-gray-600",children:["Eval Score:"," ",m?(0,n.jsx)(d.U,{size:12,className:"animate-spin"}):h?"".concat(h):"N/A"]})]})},sg=e=>{let{onClick:t,hasUnsavedChanges:s=!1}=e,[a,l]=(0,N.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"dark:hover:bg-extra-night w-min rounded-md p-0.5 outline-none transition hover:bg-slate-200",onClick:s?()=>l(!0):t,children:(0,n.jsx)(ti.Z,{size:18})}),(0,n.jsx)(su.T,{title:"Unsaved Changes",description:"You have unsaved changes. Are you sure you want to go back? Your changes will be lost.",onConfirm:()=>{l(!1),t()},open:a,onCancel:()=>l(!1)})]})},sb=async(e,t,s,a,l)=>{if(s.match(/^[✅🟠❌]\s?/u))return;let n="";1===e?n="✅":.5===e?n="\uD83D\uDFE0":0===e&&(n="❌");let r="".concat(n," ").concat(s);await (0,e_.r1)(t,r),a(r),l({target:{value:r}})};var sv=s(36168);function sj(e){let{selection:t,removable:s=!0,defaultExpanded:a=!0}=e,l=(0,N.useRef)(null),{resolvedTheme:i}=(0,ec.F)(),o=t.snippet.split("\n").length>7,[d,c]=(0,N.useState)(!o),[u,m]=(0,N.useState)(a),x=(0,F.Q6)(e=>e.removeSelection);(0,N.useEffect)(()=>{let e=r._m.init(),s=l.current;if(!s.hasAttribute("data-lang"))return e.then(async e=>{s.setAttribute("data-lang",t.language),e.editor.colorizeElement(s,{theme:"dark"===i?"vs-dark":"vs-light"})}).catch(()=>{}),()=>{e.cancel()}},[i,t]);let h=u?B.p:X.T,p=t.file.split("/").at(-1);return(0,n.jsxs)("div",{"data-code-selection":"true",className:"max-w-full overflow-hidden",children:[(0,n.jsxs)("button",{className:(0,eD.cn)("dark:bg-night dark:hover:bg-extra-night flex w-full max-w-full items-center justify-between gap-3 rounded-t-md border-[1.5px] border-slate-300 bg-gray-50 px-2 py-px transition-colors hover:bg-white focus:border-slate-400 focus:outline-none dark:border-neutral-700 dark:focus:border-neutral-500",!u&&"rounded-md"),onClick:()=>m(e=>!e),children:[(0,n.jsxs)("div",{className:"flex w-full items-center gap-2 overflow-x-hidden",children:[(0,n.jsx)("span",{className:"truncate text-[13px] font-normal text-neutral-500 dark:text-neutral-200",title:p,children:p}),(0,n.jsxs)("span",{title:t.file,className:"overflow-x-auto truncate text-[11px] font-light tracking-[0.01em] text-neutral-400",children:[t.file,":",t.range.startLine,":",t.range.endLine]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[s&&(0,n.jsx)(eX.X,{weight:"bold",className:"text-xs text-neutral-500 transition-colors hover:text-neutral-600 dark:text-neutral-400 dark:hover:text-neutral-300",onClick:e=>{e.stopPropagation(),x(t)}}),(0,n.jsx)(h,{className:"text-xs text-neutral-500 transition-colors hover:text-neutral-600 dark:text-neutral-400 dark:hover:text-neutral-300",weight:"bold"})]})]}),(0,n.jsxs)("div",{"data-state":u?"open":"closed",className:(0,eD.cn)("dark:bg-extra-night rounded-b-md border-[1.5px] border-t-0 border-slate-300 bg-white dark:border-neutral-700",!u&&"hidden"),children:[(0,n.jsx)("div",{ref:l,style:{fontFamily:'Menlo, Monaco, "Courier New", monospace'},className:(0,eD.cn)("dark:bg-extra-night overflow-x-auto text-nowrap p-2.5 text-xs leading-[15px]",o?d?"max-h-[300px] overflow-y-auto":"max-h-[calc(15px*8+theme(spacing[2.5]))] overflow-y-hidden":"rounded-b-md"),children:t.snippet}),o&&(0,n.jsx)("div",{onClick:()=>c(!d),className:"text-md dark:bg-night dark:hover:bg-shade flex w-full cursor-pointer items-center justify-center rounded-b-md bg-gray-100 py-1 text-black hover:bg-gray-200 dark:text-white",children:d?(0,n.jsx)(sv.U,{weight:"bold"}):(0,n.jsx)(B.p,{weight:"bold"})})]})]})}s(52353);var sw=s(35317),sk=s(67946);let sy=e=>{let{children:t,onUploadFile:s,disabled:a,...l}=e,r=(0,N.useCallback)(e=>{e.forEach(e=>{s(e)})},[s]),{getRootProps:i,getInputProps:o,isDragActive:d}=(0,sk.uI)({onDrop:r,noClick:!0,disabled:a}),c=(0,N.useCallback)(e=>{var t;let a=null===(t=e.clipboardData)||void 0===t?void 0:t.items,l=[].slice.call(a).filter(e=>/^image\//.test(e.type));if(0===l.length)return;let n=l[0].getAsFile();s(new File([n],n.name,{type:"image/jpeg",lastModified:new Date().getTime()})),e.preventDefault()},[s]);return(0,N.useEffect)(()=>(document.addEventListener("paste",c),()=>{document.removeEventListener("paste",c)}),[c]),(0,n.jsxs)("div",{className:"relative",...i(),...l,children:[d&&(0,n.jsx)("div",{className:"absolute inset-0 z-50 flex h-full w-full items-center justify-center rounded-md border border-neutral-200 bg-neutral-500/[0.2]",children:(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-md border border-dashed border-neutral-300 p-4 text-sm text-neutral-500",children:[(0,n.jsx)(sw.i,{className:"h-4 w-4 text-neutral-500"}),(0,n.jsx)("span",{children:"Drop your files here"})]})}),(0,n.jsx)("input",{...o()}),t]})},sN=e=>{let{onUploadFile:t}=e,[s,a]=(0,b.KO)(F.lF),l=(0,b.Dv)(F.ey),r=(0,N.useCallback)(e=>{e.forEach(e=>{t(e)}),a(!1)},[t,a]),{getRootProps:i,getInputProps:o,isDragActive:d,fileRejections:c}=(0,sk.uI)({onDrop:r,...l?{validator:e=>e.name.endsWith(".playbook.md")||e.name.endsWith(".playbook.txt")||e.name.endsWith(".devin.md")?null:{code:"invalid-playbook",message:"Playbooks can only end with .playbook.md, .devin.md, or .playbook.txt"}}:{}});return(0,N.useEffect)(()=>{c.forEach(e=>{let{file:t,errors:s}=e;C.A.error("Failed to upload ".concat(t.name,": ").concat(s[0].message))})},[c]),(0,n.jsx)(tV.Vq,{open:s,onOpenChange:a,children:(0,n.jsx)(tV.cZ,{className:(0,f.Z)("px-10 py-8 sm:max-w-[425px]  dark:border-transparent",d?"bg-gray-200 dark:bg-[#4d4d4d]":"dark:bg-night"),children:(0,n.jsx)("div",{className:"relative outline-none",...i(),children:(0,n.jsxs)("div",{className:"focus:border:none flex h-full w-full cursor-pointer items-center justify-center rounded-sm border border-dashed border-neutral-300 p-6 duration-150 hover:border-neutral-400",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-md p-4 text-center text-sm dark:text-white",children:[l?(0,n.jsx)(Y.M,{className:"mb-2 h-4 w-4"}):(0,n.jsx)(sw.i,{className:"mb-2 h-4 w-4"}),(0,n.jsx)("span",{children:l?"Click or drop your playbook here. Playbooks should end in devin.md.":"Click or drop your files here"})]}),(0,n.jsx)("input",{...o()})]})})})})};var sC=s(96710),s_=s(96268);let sS=e=>{let{canUploadPlaybooks:t,disabled:s=!1,open:a,onOpenChange:l,hasUser:r,hasSession:i}=e,o=(0,b.b9)(F.lF),d=(0,b.b9)(F.ey),c=(0,b.b9)(s_.q$),u=(0,ev.vn)(e=>e.playbookSelected);return r?(0,n.jsxs)(eh.h_,{modal:!1,open:a,onOpenChange:l,children:[(0,n.jsx)(eh.$F,{asChild:!0,disabled:s,children:(0,n.jsx)("button",{className:"enabled:focus:dark:bg-night enabled:hover:dark:bg-night dark:bg-shade rounded-full bg-slate-100 p-1 outline-none transition-colors duration-100 focus:outline-none enabled:hover:bg-slate-200 enabled:focus:bg-slate-200",disabled:s,children:(0,n.jsx)(e5.v,{size:13})})}),(0,n.jsx)(eh.AW,{sideOffset:20,className:"dark:bg-night dark:border-transparent",children:(0,n.jsxs)(eh.Qk,{children:[(0,n.jsxs)(eh.Xi,{className:"dark:text-white",onClick:()=>{t5.Z.trackInteraction(t5.j.UPLOAD_FILE),d(!1),o(!0)},children:[(0,n.jsx)(sw.i,{className:"mr-2 h-4 w-4"}),(0,n.jsx)("span",{children:"Upload file"})]}),!u&&t&&(0,n.jsxs)(eh.Xi,{className:"dark:text-white",onClick:()=>{t5.Z.trackInteraction(t5.j.UPLOAD_PLAYBOOK),d(!0),o(!0)},children:[(0,n.jsx)(Y.M,{className:"mr-2 h-4 w-4"}),(0,n.jsx)("span",{children:"Upload playbook"})]}),r&&i&&(0,n.jsxs)(eh.Xi,{className:"dark:text-white",onClick:()=>{t5.Z.trackInteraction(t5.j.PROVIDE_CREDENTIALS),c(!0)},children:[(0,n.jsx)(sC.s,{className:"mr-2 h-4 w-4"}),(0,n.jsx)("span",{children:"Add session secrets"})]})]})})]}):null};var sE=s(34630),sD=s(75113);let sT=RegExp("((https?:\\/\\/(www\\.)?)|(www\\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)(?<![-.+():%])"),sF=[(0,eP.v)(sT,e=>e.startsWith("http")?e:"https://".concat(e))];function sM(){let[e]=(0,eK.g)();return(0,N.useEffect)(()=>(0,eO.dM)(e),[e]),null}function sA(e){let{onChange:t}=e,[s]=(0,eK.g)();return(0,N.useEffect)(()=>s.registerUpdateListener(e=>{let{editorState:s}=e;t(s)}),[s,t]),null}let sO={namespace:"PlaybookEditor",theme:{heading:{h1:"text-[22px] leading-8 font-bold mb-0.5",h2:"text-[20px] leading-7 font-bold mb-0.5",h3:"text-[17px] leading-6 font-bold mb-0.5",h4:"text-base font-bold",h5:"text-[15px] font-bold leading-5",h6:"text-[14px] font-bold leading-4"},code:"p-2 m-0 block dark:bg-shade bg-slate-100 font-mono rounded-md mb-1 [&>span]:!mb-0",codeHighlight:{atrule:"dark:text-[#c586c0] text-[#795E26]",attr:"dark:text-[#9cdcfe] text-[#001080]",boolean:"dark:text-[#569cd6] text-[#0000FF]",builtin:"dark:text-[#dcdcaa] text-[#795E26]",cdata:"dark:text-[#6a9955] text-[#008000]",char:"dark:text-[#d7ba7d] text-[#A31515]",class:"dark:text-[#4ec9b0] text-[#267f99]","class-name":"dark:text-[#4ec9b0] text-[#267f99]",comment:"dark:text-[#6a9955] text-[#008000] italic",constant:"dark:text-[#9cdcfe] text-[#0000FF]",deleted:"dark:text-[#f44747] text-[#FF0000]",doctype:"dark:text-[#6a9955] text-[#008000] italic",entity:"dark:text-[#d7ba7d] text-[#A31515]",function:"dark:text-[#dcdcaa] text-[#795E26]",important:"dark:text-[#569cd6] text-[#0000FF]",inserted:"dark:text-[#b5cea8] text-[#008000]",keyword:"dark:text-[#c586c0] text-[#0000FF]",namespace:"dark:text-[#4ec9b0] text-[#267f99]",number:"dark:text-[#b5cea8] text-[#098658]",operator:"dark:text-[#d4d4d4] text-[#000000]",prolog:"dark:text-[#6a9955] text-[#008000] italic",property:"dark:text-[#9cdcfe] text-[#001080]",punctuation:"dark:text-[#d4d4d4] text-[#000000]",regex:"dark:text-[#d16969] text-[#811F3F]",selector:"dark:text-[#d7ba7d] text-[#800000]",string:"dark:text-[#ce9178] text-[#A31515]",symbol:"dark:text-[#b5cea8] text-[#098658]",tag:"dark:text-[#569cd6] text-[#001080]",url:"dark:text-[#d7ba7d] text-[#800000]",variable:"dark:text-[#9cdcfe] text-[#001080]"},text:{bold:"font-bold",code:"font-mono bg-slate-100 dark:bg-shade px-1 py-px",italic:"italic",base:"mb-1.5 inline-block",strikethrough:"line-through",subscript:"align-sub text-xs",superscript:"align-super text-xs",underline:"underline",underlineStrikethrough:"underline line-through"},list:{checklist:"list-disc pl-5",listitem:"mb-1",listitemChecked:"line-through text-gray-500",listitemUnchecked:"text-black",nested:{listitem:"ml-4 list-none"},olDepth:["list-decimal pl-5","list-decimal pl-6","list-decimal pl-7","list-decimal pl-8","list-decimal pl-9"],ul:"list-disc pl-5"}},onError:()=>{},nodes:[eG.c2,eI.EG,eI.NK,eG.rT,eO.wg,eO.o0,e$.Fh,e$.Cr,e$.g0,ez.qp,ez.GR]},sz="undefined"!=typeof navigator&&function(){let e=!1,t=navigator.userAgent||navigator.vendor||window.opera;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e}(),sI=e=>{var t;let{onSubmit:s,disabled:a,attachments:l,handleAttachmentDelete:r,handleAttachmentCancelUpload:i,handleTextAttach:o,permissions:c,isDemoMode:u,placeholderText:m,devinId:x,isTechnicalPreview:h,isHome:p,onSelectCustomDevin:g,isAlternateTimeline:j,onToggleExpand:w,expanded:_,onChangePlaybookContents:S,onSelectSlackChannel:E,isAboveUserLimits:M,inputBoxOpen:A,setInputBoxOpen:O,humanModeEnabled:z}=e,{userId:I,orgId:L}=(0,T.aC)(),{input:Z,setInput:P,devinInputMap:R,setDevinInputMap:K,inputRef:U}=(0,N.useContext)(ep.r),{immersiveLiveMode:V}=(0,e6.k)(),H=(0,F.Q6)(e=>e.selections),W=(0,F.Q6)(e=>e.clear),q=l.filter(e=>!sU(e.file.name)),Y=l.findLast(e=>sU(e.file.name)),J=!!Y&&!Y.url,[G,$]=(0,N.useState)(null),Q=x?"".concat(x):"new-session",[ee]=(0,b.KO)(F.ug),et=(0,b.Dv)(F.JU),[es,ea]=(0,N.useState)(!0),el=(0,y.useRouter)(),en=(0,y.usePathname)(),er=(0,y.useSearchParams)(),ec=(0,b.b9)(F.i6);(0,N.useEffect)(()=>{let e=er.get("prompt");if(!e)return;let t=new URLSearchParams(er.toString());e&&(t.delete("prompt"),P(e),K(t=>({...t,[Q]:e}))),el.replace("".concat(en,"?").concat(t))},[er,Q,el,en,P,K,o]);let{devinState:eu}=(0,D.j1)(),[em,ex]=(0,N.useState)(!1),eh=(0,eb.b1)(),ef=(0,e9.x)(e=>e.setModalOpen),eg=(0,e9.x)(e=>e.hasSetNewSessionUsageLimit),ev=(0,e9.x)(e=>e.setHasSetNewSessionUsageLimit),ej=h||a||j,ek=ej||eh.shouldRestrictFeatures,[ey,eN]=(0,N.useState)(5),eC=(0,eS.F)(e=>e.selectedMultiDevin),e_=(0,eS.F)(e=>e.selectedPlaybook),eF=(0,eS.F)(e=>e.removeSelectedPlaybook),eM=(0,eS.F)(e=>e.selectedSnapshot),{user:eO}=(0,T.aF)(),ez=(null==eO?void 0:eO.user_id)||"user",eI=Y&&G?{body:G,id:"attached-playbook-".concat(Y.file.name),title:sV(Y.file.name)}:e_,eK=(0,N.useRef)("");(0,N.useEffect)(()=>{let e=(null==R?void 0:R[Q])?R[Q]:"";e?P(e):P("")},[x,Q,R,P]),(0,N.useEffect)(()=>{let e=!1;if(Y)return Y.file.text().then(t=>{e||$(t)}),()=>{e=!0};$(null)},[Y]);let eG=(0,N.useRef)(null),e$=(0,N.useCallback)(e=>{let t=null==U?void 0:U.current;t&&sz&&(O(e),e?ts(t):ts(t,!1,!0))},[U]);(0,N.useEffect)(()=>{if(sz){let e=e=>{var t;!eG.current||eG.current.contains(e.target)||(null===(t=document.querySelector("[data-radix-menu-content]"))||void 0===t?void 0:t.contains(e.target))||(tc(!1),e$(!1))};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}},[e$,eG]);let e2=(0,N.useCallback)(async e=>{if(ex(!0),!eC){C.A.error("No MultiDevin selected");return}try{let t=await (0,ew.u4)(eC.scheduled_devin_id,e.length>0?e:eC.config.manager_prompt,ey,I,L,et);el.push("/sessions/".concat(t.devin_id.substr(6)),{}),P("")}catch(e){if(e instanceof v.B){let t=await e.response.json();C.A.error("Cannot create Devin session. ".concat(t.detail))}throw e}finally{ex(!1)}},[ey,el,eC,I,L,P]),e5=(0,b.b9)(F.DA),e4=async()=>{if(eh.planUsesCredits&&M&&!eg){e5(!0);return}if(ev(!1),!e_&&!Z.trim()&&0===l.length||em)return;if(ek){ef(!0);return}ex(!0),S(eK.current);let e=z?"".concat(Z," --human-mode"):Z;(ee!==eE.n.MULTI_DEVIN||x?await s(e):await e2(Z))&&(P(""),K({...R,[Q]:""}),sz&&(O(!1),e$(!1))),ex(!1)},e3=(0,N.useRef)(null),[e7,te]=(0,N.useState)(!1);(0,N.useEffect)(()=>{let e=()=>{te(!0)},t=()=>{te(!1)},s=null==U?void 0:U.current;return null==s||s.addEventListener("focus",e),null==s||s.addEventListener("blur",t),()=>{null==s||s.removeEventListener("focus",e),null==s||s.removeEventListener("blur",t)}},[U]);let tt=sz?1:2,ts=(0,N.useCallback)((e,t,s)=>{let a=(s?24*tt:120)+20+2;e.style.height="inherit";let l=Math.min(e.scrollHeight,a);return t?e.style.height="".concat(l,"px"):(0,e8.j)(e,{height:"".concat(l,"px")},{duration:.2}),l},[tt]);(0,N.useEffect)(()=>{(null==U?void 0:U.current)&&(U.current.focus(),ts(U.current,!0))},[ts,U,Z]);let ta=!p&&eu&&"finished"===eu.status.enum,tl=!p&&!c.includes("write")&&(!V||!u)||ta&&eu.status.shortMessage.includes("Session ended"),tn=(e_||eM)&&!x;(0,N.useEffect)(()=>{W()},[W,x]);let tr=(0,eS.F)(e=>!!e.selectedPlaybook),[ti,to]=(0,N.useState)(!1),[td,tc]=(0,N.useState)(!1),[tu,tm]=(0,ei.H)(),tx=ti?B.p:X.T,[th,tp]=(0,N.useState)(e_),tf=(0,eS.F)(e=>!!e.selectedMultiDevin),tg=(0,N.useMemo)(()=>{if(Z.length>=3e4)return"This task is too long. Please attach it as a file or break it down into multiple messages.";let e=new RegExp(/^((PLAYBOOK_md)|(PLAYBOOK)):\s*$/m).exec(Z);return e&&tr?'Cannot use "PLAYBOOK" inline when a playbook is selected':e&&x?'Cannot use "PLAYBOOK" on a running Devin':""},[Z,tr,x]),tb=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;to(e);let s=null==U?void 0:U.current;if(s&&tu.current){if(!e)return s.value&&ts(s),tm(tu.current,{height:0,display:"none"},{duration:t,ease:"easeInOut"}).then(()=>{var e,t;(null===(t=tu.current)||void 0===t?void 0:null===(e=t.style)||void 0===e?void 0:e.display)&&(tu.current.style.display="none")});{let e=ts(s,!1,!0);return tm(tu.current,{height:e3.current?e3.current.clientHeight-e-30:"200px",opacity:1,display:"block"},{duration:t,ease:"easeInOut"})}}},tv=e=>{let t=tb(!1);t?t.then(()=>{null==w||w(e)}):null==w||w(e)},tj=(0,eT.Oh)(),tw=(0,n.jsxs)("div",{className:(0,f.Z)("relative flex w-full justify-center",sz&&"pb-2"),children:[(0,n.jsx)(k.default,{href:"/",className:"mx-auto rounded-md bg-[#6096FF] px-4 py-2 text-sm font-medium text-white duration-150 hover:bg-blue-500",children:"Start a new conversation with Devin"}),x&&tj&&(0,n.jsx)("div",{className:"absolute left-1 top-1/2 -translate-y-1/2",children:(0,n.jsx)(sh,{devinId:x||""})})]});return th!==e_&&(tb(!1),tp(e_)),(0,n.jsxs)("div",{className:(0,f.Z)("flex flex-col",p&&"h-full"),children:[(0,n.jsxs)("div",{className:(0,f.Z)("flex max-w-full flex-wrap gap-3 text-[12px]",q.length>0?"mb-6":"mb-2 sm:mb-3"),children:[p&&(0,n.jsx)(sP,{onSelect:g,setInput:P}),tn&&(0,n.jsxs)(n.Fragment,{children:[e_&&(0,n.jsx)(sE.s,{type:"playbook",isHome:p,name:e_.title,id:e_.id,allowNavigate:!0,onClick:()=>tv(!1)}),eM.snapshot_id!==eS._.snapshot_id&&(0,n.jsx)(sE.s,{type:"snapshot",isHome:p,name:eM.snapshot_name,id:eM.snapshot_id,allowNavigate:!0,onClick:()=>tv(!1)}),(e_||eM.snapshot_id!==eS._.snapshot_id)&&(0,n.jsx)(sR,{})]}),ee===eE.n.SPARKOPS&&!x&&I&&(0,n.jsxs)("div",{className:"ml-auto flex items-center gap-2 font-medium text-neutral-600 dark:text-neutral-200",children:[(0,n.jsx)("span",{className:"text-sm",children:"Show form"}),(0,n.jsx)(ss.r,{checked:es,onCheckedChange:ea})]}),!x&&tj&&(0,n.jsx)("div",{className:"ml-auto mr-2 hidden text-neutral-600 lg:block dark:text-neutral-200",children:(0,n.jsx)(sh,{devinId:null!=x?x:""})})]}),tl?tw:ta&&eh.shouldRestrictFeatures?(0,n.jsx)("div",{className:(0,f.Z)("flex justify-center",sz&&"pb-2"),children:(0,n.jsx)(k.default,{href:"/settings/plans",className:"mx-auto rounded-md bg-[#6096FF] px-4 py-2 text-sm font-medium text-white duration-150 hover:bg-blue-500",children:"increase_limit"===eh.billingError?"Purchase additional ACUs":"Subscribe to use Devin"})}):(0,n.jsx)(n.Fragment,{children:ee===eE.n.SPARKOPS&&es&&!x?!ta&&(0,n.jsx)(sZ,{firstName:ez}):(0,n.jsxs)("div",{ref:eG,className:(0,eD.cn)("dark:bg-input-dark group/input relative flex grow flex-col border shadow-sm transition-shadow focus-within:shadow-sm dark:border-none",x?"focus-within:ring-cloud/50 focus-within:ring-1":"focus-within:ring-pacific focus-within:ring-2",!p&&sz?"rounded-t-xl":"rounded-xl"),children:[(0,n.jsxs)("div",{ref:e3,className:"flex flex-1 flex-col",children:[tf&&!x&&(0,n.jsx)("div",{className:(0,f.Z)(ee===eE.n.MULTI_DEVIN&&Z.length>0?"opacity-100":"opacity-0","bg-pacific absolute bottom-6 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-md px-2 py-0.5 text-xs font-normal text-white duration-100"),children:"MultiDevin worker prompt"}),(0,n.jsx)(ed.M,{children:q.length>0&&(0,n.jsx)(eo.E.div,{initial:{height:0},animate:{height:"48px"},exit:{height:0},transition:{duration:.2},className:"relative pl-3",children:(0,n.jsx)("div",{className:"absolute -top-2.5 flex gap-4",children:q.map((e,t)=>(0,n.jsx)(sH,{attachment:e,handleAttachmentDelete:r,handleAttachmentCancelUpload:i},"".concat(e.file.name,"-").concat(e.file.type,"-").concat(t)))})})}),eI&&p&&(0,n.jsx)("div",{className:"dark:bg-input-dark group rounded-t-xl p-1.5 pb-0 text-neutral-300",children:(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"group relative max-w-full overflow-hidden",children:[(0,n.jsxs)("button",{className:(0,f.Z)("group","dark:bg-night dark:hover:bg-extra-night border-border flex w-full max-w-full items-center justify-between gap-3 rounded-t-md border-[1.5px] bg-slate-50 px-2 py-px transition-colors hover:bg-slate-100 focus:outline-none group-focus-within:border-slate-400 dark:border-neutral-700 dark:group-focus-within:border-neutral-500",!ti&&"rounded-md"),disabled:J,onClick:()=>{let e=null==w?void 0:w(!0);e?e.then(()=>{tb(!ti)}):tb(!ti)},children:[(0,n.jsx)("div",{className:"flex w-full items-center gap-2 overflow-x-hidden",children:(0,n.jsx)("span",{className:"truncate text-[13px] font-normal text-neutral-700 group-disabled:text-neutral-500 dark:text-neutral-200 group-disabled:dark:text-neutral-400",title:eI.title,children:eI.title})}),(0,n.jsxs)("div",{className:"flex gap-2",children:[J&&(0,n.jsx)(d.U,{className:"animate-spin text-xs"}),(0,n.jsx)(eX.X,{weight:"bold",className:"text-xs text-neutral-500 transition-colors hover:text-neutral-600 dark:text-neutral-400 dark:hover:text-neutral-300",onClick:e=>{e.stopPropagation(),Y?Y.url?r(Y):i(Y):eF()}}),!J&&(0,n.jsx)(tx,{className:"text-xs text-neutral-500 transition-colors hover:text-neutral-600 dark:text-neutral-400 dark:hover:text-neutral-300",weight:"bold"})]})]}),(0,n.jsx)("div",{ref:tu,style:{height:0,opacity:0,display:"none"},className:(0,eD.cn)("dark:bg-extra-night group-focus-within:border-slate-4000 dark:group-focus-within:border-neutral-5000 border-border overflow-y-auto rounded-b-md border-[1.5px] border-t-0 dark:border-neutral-700"),children:(0,n.jsx)("div",{className:"dark:bg-extra-night relative overflow-x-auto text-nowrap rounded-b-md text-xs text-neutral-500 dark:text-neutral-200",children:(0,n.jsx)(eR.R,{initialConfig:{...sO,editorState:()=>(0,eL.Os)(eI.body,eL.XC)},children:(0,n.jsxs)("div",{className:(0,f.Z)("overflow-y-auto px-3 py-2 pb-4 text-sm",eA().className),children:[(0,n.jsx)(eY.B,{contentEditable:(0,n.jsx)(eU.f,{className:"outline-none focus:outline-none"}),placeholder:(0,n.jsx)("div",{className:"pointer-events-none inline-block select-none overflow-hidden truncate text-xs",children:"Enter some text..."}),ErrorBoundary:eV.g}),(0,n.jsx)(eH.e,{}),(0,n.jsx)(eZ.C,{}),(0,n.jsx)(eq.B,{}),(0,n.jsx)(eW.H,{}),(0,n.jsx)(sM,{}),(0,n.jsx)(eJ.u,{}),(0,n.jsx)(eP.$,{matchers:sF}),(0,n.jsx)(eB.r,{transformers:eL.XC}),(0,n.jsx)(sA,{onChange:e=>{e.read(()=>{eK.current=(0,eL.JH)(eL.XC),S(eK.current)})}})]})},eI.id)})})]})})}),H.length>0&&(0,n.jsx)("div",{className:"dark:bg-input-dark rounded-t-xl bg-gray-100 p-1.5 pb-0 text-neutral-300",children:(0,n.jsx)("div",{className:(0,f.Z)(H.length>1&&"dark:bg-night flex max-h-[400px] flex-col gap-1 overflow-y-auto rounded-lg bg-white p-1.5"),children:H.map(e=>(0,n.jsx)(sj,{defaultExpanded:0===H.length,selection:e},"".concat(e.file,"-").concat(e.range.startLine,"-").concat(e.range.endLine)))})}),(0,n.jsx)(sD.u,{content:(0,n.jsxs)(n.Fragment,{children:[j&&(0,n.jsx)("span",{className:"flex flex-col items-center text-center text-xs",children:"This alternate timeline is read-only. Please switch to the active timeline to interact with Devin."}),h&&(0,n.jsxs)("span",{className:"flex flex-col items-center text-center text-xs",children:["Non-Slack runs in the Technical Preview organization are no longer permitted.",(0,n.jsx)("br",{}),"Please switch to your personal account to continue."]})]}),onPointerDownOutside:e=>{e.preventDefault()},side:"top",className:"px-2 py-1",delayDuration:50,disabled:!h&&!j,children:(0,n.jsxs)("div",{className:"flex w-full grow items-center px-2 py-1 sm:py-0.5",children:[sz&&!A&&!p&&(0,n.jsx)("div",{className:"flex h-fit text-white",children:(0,n.jsx)(sS,{open:td,hasSession:!!x,onOpenChange:tc,canUploadPlaybooks:!x,hasUser:!!I})}),(0,n.jsx)("textarea",{className:(0,f.Z)("dark:bg-input-dark dark:placeholder:text-cloud block min-h-full w-full grow resize-none scroll-p-5 overflow-x-auto rounded-t-xl px-2 py-2 leading-6 transition duration-100 placeholder:text-neutral-400 focus:outline-none dark:text-white",!p&&sz&&!A&&!p&&"overflow-y-hidden"),disabled:ej,placeholder:m,ref:U,id:"devin-session-inputbox",value:Z,onChange:e=>{(ee!==eE.n.MULTI_DEVIN||eC)&&(P(e.target.value),K({...R,[Q]:e.target.value}))},onClick:()=>{ee!==eE.n.MULTI_DEVIN||tf||ec(!0),e$(!0)},rows:tt,onFocus:()=>{_&&tb(!1)},onPaste:e=>{let t=e.clipboardData.getData("text/plain");t.length>=15e3&&(e.preventDefault(),o("Pasted",t))},onKeyDown:async e=>{ts(e.currentTarget,!0),("v"!==e.key||!e.ctrlKey&&!e.metaKey)&&"Enter"===e.key&&!e.shiftKey&&!e.ctrlKey&&!e.nativeEvent.isComposing&&!sz&&(e.preventDefault(),a||em||tg?tg&&C.A.warning(tg):e4())}})]})})]}),(0,n.jsx)("hr",{className:(0,eD.cn)("w-full bg-transparent","dark:border-cloud border-neutral-200",!p&&sz?A?"block":"hidden":"block")}),(0,n.jsxs)("div",{className:(0,eD.cn)("items-center justify-between px-4 py-3 text-xl dark:text-white","bg-slate-50 dark:bg-transparent",!p&&sz?A?"flex":"hidden":"flex rounded-b-xl"),children:[(0,n.jsxs)("div",{className:"flex w-full items-center gap-3",children:[(0,n.jsx)(sS,{open:td,hasSession:!!x,onOpenChange:tc,canUploadPlaybooks:!x,disabled:ek,hasUser:!!I}),x&&tj&&(0,n.jsx)(sh,{devinId:x||""}),w&&(0,n.jsx)("button",{onClick:()=>tv(!_),children:_?(0,n.jsx)(eQ.G,{}):(0,n.jsx)(e0.S,{})}),p&&ee!==eE.n.MULTI_DEVIN&&(0,n.jsx)(sL,{onSelectionChanged:E,disabled:ek}),(0,n.jsx)("span",{className:(0,f.Z)("ml-4 mr-auto text-sm text-red-400 duration-100",tg?"opacity-100":"opacity-0"),children:tg}),ee===eE.n.MULTI_DEVIN&&!x&&tf&&(0,n.jsxs)("div",{className:"mr-2 flex items-center border-r dark:border-neutral-400",children:[(0,n.jsx)("span",{className:"text-pacific mr-2 text-xs",children:"MultiDevin workers:"}),(0,n.jsx)("input",{type:"number",className:(0,f.Z)("dark:bg-shade hover:dark:bg-night focus-within:dark:bg-night mr-2 w-[27px] rounded-sm bg-slate-200 px-1 text-right text-sm outline-none ring-0 transition [appearance:textfield] focus-within:bg-slate-300 hover:bg-slate-300 [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none"),value:ey,min:1,onChange:e=>eN(parseInt(e.target.value)),onBlur:e=>eN(Math.min(10,Math.max(1,parseInt(e.target.value)||1)))})]})]}),(0,n.jsx)(eb.Hd,{children:(0,n.jsx)("button",{className:(0,f.Z)("enabled:hover:text-pacific enabled:focus:text-pacific enabled:hover:dark:text-pacific enabled:focus:dark:text-pacific","outline-none transition-colors duration-100 focus:outline-none","opacity-100 disabled:opacity-50"),onClick:e=>{e.preventDefault(),e4()},disabled:a||!!tg||em||eh.shouldRestrictFeatures,children:em?(0,n.jsx)(d.U,{className:"animate-spin"}):(0,n.jsx)(e1.o,{})})})]}),"finished"!==eu.status.enum&&(null===(t=eu.lastTypingEvent)||void 0===t?void 0:t.value)&&(0,n.jsx)("div",{className:"absolute bottom-[-18px] left-[3rem] text-left text-xs text-neutral-500 md:bottom-[-22px] dark:text-white",children:"Devin is typing"}),(0,n.jsxs)("span",{className:(0,f.Z)("absolute -bottom-5 right-0 text-xs dark:text-white",Z.length>0&&e7&&!sz?"opacity-100":"opacity-0","duration-300"),children:["Shift + Enter"," ",(0,n.jsx)("span",{className:"font-extralight",children:"to add a newline"})]})]})})]})},sL=e=>{var t;let{onSelectionChanged:s,disabled:a}=e,[l,r]=(0,N.useState)(!1),{userId:i,orgId:o}=(0,T.aC)(),[d,c]=(0,N.useState)(!1),{data:u}=(0,eg.xc)(i,o),[m,x]=(0,N.useState)(""),h=(0,N.useRef)(null);if(e7(h,()=>{c(!1)}),(0,N.useEffect)(()=>{!m&&u&&u.length>0&&x(u[0].id)},[u,m]),!u||0===u.length)return null;let p=u.map(e=>({label:"#".concat(e.name),value:e.id})),g=(e,t)=>{r(e),x(t),s(t,e),c(!1)};return(0,n.jsxs)("div",{className:"relative mx-3 flex items-center gap-x-2 overflow-visible text-xs",children:[(0,n.jsx)("input",{id:"send-to-channel-checkbox",type:"checkbox",onChange:e=>g(e.target.checked,m),checked:l,disabled:a}),(0,n.jsx)("label",{htmlFor:"send-to-channel-checkbox",children:"Also send to channel"}),(0,n.jsx)("div",{className:(0,f.Z)("flex items-center whitespace-nowrap pr-2"),children:(0,n.jsxs)("div",{className:"relative dark:text-white",children:[(0,n.jsxs)("div",{className:"flex cursor-pointer items-center ",onClick:()=>c(!d),children:[null===(t=p.find(e=>e.value===m))||void 0===t?void 0:t.label," ",(0,n.jsx)(B.p,{size:12,className:"ml-1"})]}),d&&(0,n.jsx)("div",{ref:h,className:(0,f.Z)(" dark:bg-night absolute bottom-full z-[9999] mb-3 min-w-40 max-w-40 rounded-lg border border-gray-300 bg-white p-1.5 shadow-lg transition-opacity duration-300 will-change-[transform,opacity] [animation-duration:_400ms] [animation-timing-function:_cubic-bezier(0.16,_1,_0.3,_1)] dark:border-[#484848]",d?"opacity-100":"pointer-events-none opacity-0"),children:p.map(e=>(0,n.jsxs)("div",{className:"flex w-full cursor-pointer items-center rounded-md px-4 py-2 text-xs hover:bg-[#f2f2f2] dark:hover:bg-[#454545]",onClick:()=>g(l,e.value),children:[m===e.value&&(0,n.jsx)(J.J,{size:12,className:"mr-2"}),(0,n.jsx)("div",{className:"w-32 overflow-hidden text-ellipsis break-all",title:e.label,children:e.label})]},e.value))})]})})]})},sZ=e=>{let{firstName:t}=e,[s,a]=(0,N.useState)(""),[l,r]=(0,N.useState)(!1),i=(0,y.useRouter)(),[o,c]=(0,N.useState)([{id:"",before:"",after:""}]),u=(0,b.Dv)(F._Z),m=(e,t,s)=>{c(a=>a.map(a=>a.id===e?{...a,before:t,after:s}:a))},x=async e=>{e.preventDefault(),r(!0);let{selectedPlaybook:l,selectedSnapshot:n}=eS.F.getState();try{let e=(await (0,te.ed)("batch name: ".concat(s,"\n").concat(o.map(e=>"before: ".concat(e.before,"\nafter: ").concat(e.after)).join("\n"),"\n--devin-sparkop-0607"),t,n.ami_id,n.snapshot_id,null==l?void 0:l.id,(null==u?void 0:u.value)==="None"?void 0:null==u?void 0:u.value,"devin-sparkop-0607")).devin_id;i.push("/sessions/".concat(e.substr(6)),{}),a(""),c([])}catch(e){if(e instanceof v.B){let t=await e.response.json();C.A.error("Cannot create Devin session. ".concat(t.detail))}throw e}finally{r(!1)}},h="dark:bg-input-dark w-full rounded-md border bg-slate-100 px-2.5 py-1.5 text-sm outline-none ring-0 transition focus-within:border-neutral-300 dark:border-neutral-500 dark:focus-within:border-neutral-400";return(0,n.jsxs)("form",{className:"dark:border-input-dark flex w-full flex-col items-center justify-center border-t pt-3 dark:text-neutral-200",onSubmit:x,children:[(0,n.jsx)("span",{className:"mb-1 w-full flex-1 pl-1 text-sm",children:"Batch name (will be used in the name of the branch)"}),(0,n.jsx)("input",{placeholder:"StartedAtHistory StaticOp Migration",type:"text",value:s,onChange:e=>a(e.target.value),className:h,disabled:l}),(0,n.jsxs)("div",{className:"mt-3 flex w-full items-center gap-2",children:[(0,n.jsx)("span",{className:"w-full flex-1 pl-1 text-sm",children:"Before"}),(0,n.jsx)("span",{className:"mr-8 w-full flex-1 pl-1 text-sm",children:"After"})]}),o.map((e,t)=>(0,n.jsxs)("div",{className:"mt-1 flex w-full items-center gap-2",children:[(0,n.jsx)("input",{type:"text",placeholder:"src/main/scala/nu/data/br/static/people/StartedAtHistory.scala",value:e.before,onChange:t=>{m(e.id,t.target.value,e.after)},className:h,disabled:l}),(0,n.jsx)("input",{type:"text",placeholder:"subprojects/data-domains/datasets/StartedAtHistory.scala",value:e.after,disabled:l,onChange:t=>{m(e.id,e.before,t.target.value)},className:h}),(0,n.jsx)("button",{type:"button",onClick:()=>{1!==o.length||e.before||e.after?c(o.filter(t=>t.id!==e.id)):m(e.id,"","")},className:(0,f.Z)("flex w-min items-center rounded-md border p-2 shadow-sm transition dark:border-neutral-500 dark:bg-neutral-600",t?"cursor-pointer opacity-100 hover:bg-slate-100 dark:hover:bg-neutral-700":"opacity-40"),disabled:l||!t,children:(0,n.jsx)(e2.W,{size:17})})]},e.id)),(0,n.jsx)("div",{className:"mt-1 flex w-full justify-start",children:(0,n.jsxs)("button",{type:"button",onClick:()=>{c([...o,{id:(0,e3.x0)(),before:"",after:""}])},className:"mt-2 flex w-min cursor-pointer items-center gap-1 rounded-md border px-2 py-1 text-sm shadow-sm transition hover:bg-slate-100 dark:border-neutral-500 dark:bg-neutral-600 dark:hover:bg-neutral-700",disabled:l,children:["Add ",(0,n.jsx)(e5.v,{size:17})]})}),(0,n.jsx)("button",{type:"submit",className:"bg-pacific mt-3 flex h-10 w-full items-center justify-center rounded-md px-2 text-sm text-white",disabled:l,children:l?(0,n.jsx)(d.U,{className:"ml-2 size-4 animate-spin"}):"Submit"})]})},sP=e=>{var t,s,a,l,r;let{onSelect:i,setInput:o}=e,d=null!==(s=(0,eT.gP)())&&void 0!==s&&s,c=null!==(a=(0,eT.cJ)())&&void 0!==a&&a,u=null!==(l=(0,eT.$Z)())&&void 0!==l&&l,m=null!==(r=(0,eT.Bf)())&&void 0!==r&&r,[x,h]=(0,b.KO)(F.ug),[p,g]=(0,N.useState)(!1),v=(0,N.useRef)(null),j=(0,eS.F)(e=>e.setSelectedMultiDevin);e7(v,()=>{g(!1)});let w=e=>{h(e),i(e),g(!1),e!==eE.n.MULTI_DEVIN?j(null):o("")},{orgId:k}=(0,T.aC)(),y=!!(null==k?void 0:k.startsWith("personal-")),C=(0,N.useMemo)(()=>[{value:eE.n.DEVIN,label:"Devin",explanation:"For methodical and complex tasks",disabled:y},{value:eE.n.DEVIN_LITE,label:"Devin Lite",explanation:"For the fastest results"},m&&{value:eE.n.UNITY_CATALOG,label:"Unity Catalog Devin"},d&&{value:eE.n.SPARKOPS,label:"SparkOps Devin"},c&&{value:eE.n.MULTI_DEVIN,label:"MultiDevin"},u&&{value:eE.n.DEVIN_ZERO,label:"Devin Zero"}].filter(Boolean),[d,c,u,m,y]);if((0,N.useEffect)(()=>{y?h(eE.n.DEVIN_LITE):h(eE.n.DEVIN)},[y,d,h]),y||d||c||u||m)return(0,n.jsx)("div",{className:"dark:border-input-dark mr-2 flex items-center whitespace-nowrap border-r py-1.5 pl-2 pr-2 text-[13px]",children:(0,n.jsxs)("div",{className:"relative dark:text-white",children:[(0,n.jsxs)("div",{className:"flex cursor-pointer items-center text-xs font-medium",onClick:()=>g(!p),children:[(0,n.jsx)("span",{className:"mr-2",children:"Running with:"}),null===(t=C.find(e=>e.value===x))||void 0===t?void 0:t.label," ",(0,n.jsx)(B.p,{size:12,className:"ml-1"})]}),p&&(0,n.jsx)("div",{ref:v,className:"dark:bg-night absolute z-[2] mt-2 max-h-[140px] min-w-40 overflow-y-auto rounded-lg border border-gray-300 bg-white p-1.5 shadow-lg transition-opacity duration-300 will-change-[transform,opacity] [animation-duration:_400ms] [animation-timing-function:_cubic-bezier(0.16,_1,_0.3,_1)] dark:border-[#484848] ".concat(p?"opacity-100":"pointer-events-none opacity-0"),children:C.map(e=>(0,n.jsx)(sD.u,{content:(0,n.jsx)("div",{className:"p-2 text-xs",children:"Only available on the Enterprise plan"}),disabled:!e.disabled,delayDuration:0,children:(0,n.jsxs)("div",{className:(0,f.Z)("flex items-center rounded-md px-4 py-2 text-xs",e.disabled?"opacity-60":"cursor-pointer hover:bg-gray-200 dark:hover:bg-[#454545]"),onClick:()=>{e.disabled||w(e.value)},children:[x===e.value&&(0,n.jsx)(J.J,{size:12,className:"mr-2"}),e.label,e.explanation&&(0,n.jsx)("span",{className:"ml-2 text-xs text-zinc-500",children:e.explanation})]},e.value)},e.value))})]})})};function sR(){let e=(0,b.b9)(F.qb);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-[12px] leading-4",children:"Create a shortcut for the current playbook and snapshot"}),className:"max-w-52 p-2",side:"top",children:(0,n.jsx)("button",{className:"dark:bg-extra-night dark:border-input-dark h-fit rounded-full border border-slate-500 px-2 py-1 text-slate-700 transition hover:bg-slate-100 dark:text-white",onClick:()=>{e(!0)},children:(0,n.jsx)(e4.B,{size:18})})})})}let sK=/(\.playbook\.(txt|md))|(\.devin\.md)$/,sU=e=>sK.test(e),sV=e=>e.replace(sK,"");function sH(e){let{attachment:t,handleAttachmentDelete:s,handleAttachmentCancelUpload:a}=e,l=w().last(t.file.name.split("/"));return(0,n.jsxs)(eo.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:(0,f.Z)("ring-pacific/50 hover:ring-pacific/80 dark:bg-night group relative h-[52px] w-20 rounded-md bg-slate-100 ring transition-shadow"),children:[!t.url&&(0,n.jsx)("div",{className:"absolute left-0 top-0 z-20 flex h-full w-full items-center justify-center rounded-md border border-transparent bg-slate-100 opacity-50 transition-colors dark:bg-[rgba(0,0,0,0.5)]",children:(0,n.jsx)(d.U,{size:22,className:"animate-spin text-neutral-600 dark:text-white",weight:"bold"})}),(0,n.jsx)("button",{onClick:()=>{t.url?s(t):a(t)},className:"dark:bg-night border-cloud text-cloud absolute -left-2.5 -top-2.5 z-40 rounded-full border bg-slate-100 p-1 shadow-md transition-colors duration-200 hover:bg-red-400 hover:text-white",children:(0,n.jsx)(eX.X,{size:12,weight:"bold"})}),(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs text-white",children:l}),side:"bottom",className:"dark:bg-extra-night px-2 py-1 shadow-lg",delayDuration:200,arrowClassName:"dark:fill-extra-night",children:tt.P7.some(e=>t.file.name.endsWith(e))?(0,n.jsxs)(tV.Vq,{modal:!0,children:[(0,n.jsx)(tV.hg,{disabled:!t.url,className:"h-full w-full overflow-hidden rounded-md",children:t.url&&(0,n.jsx)("img",{src:t.url,alt:l,className:"w-full object-cover object-top"})}),(0,n.jsxs)(tV.cZ,{className:"outline-none sm:max-w-[525px]",children:[(0,n.jsx)(tV.fK,{children:(0,n.jsx)(tV.$N,{className:"text-md mb-1 tracking-tight",children:l})}),(0,n.jsx)("img",{src:t.url,alt:l,className:"h-full w-auto rounded-md"})]})]}):(0,n.jsx)("div",{className:"text-pacific flex h-full w-full items-center justify-center overflow-hidden truncate text-wrap rounded-md p-1.5 text-center text-xs font-bold",children:(0,n.jsx)("span",{style:{overflow:"hidden",whiteSpace:"pre-wrap",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:"2",WebkitBoxOrient:"vertical"},children:l})})})]})}var sW=s(22785),sq=s(63629),sB=s(89274),sY=s(2366),sJ=s(87642),sG=s(58919);let s$={id:"",title:"No playbook",body:"No playbook selected",org_id:"no_org",status:"published",access:"team",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),created_by:{id:"no_user",full_name:"No User"},compiled:{status:sG.j_.Idle,value:void 0},updated_by:{id:"no_user",full_name:"No User"},examples:[]},sX=e=>{let{selectedPlaybook:t,setSelectedPlaybook:s,defaultPlaybookId:a}=e,[l,r]=(0,N.useState)(""),{data:i}=(0,ej.aM)(),{data:o}=(0,ej.cZ)();return(0,N.useEffect)(()=>{if(null==i?void 0:i.length){let e=i.find(e=>e.id===a);s(e||null),r((null==e?void 0:e.title)||"")}},[a,i,s]),(0,n.jsx)(sQ,{playbooks:[s$,...i||[]],favouritePlaybooks:o,selectedPlaybook:t,setSelectedPlaybook:s,searchString:l,setSearchString:r})},sQ=e=>{let{playbooks:t,favouritePlaybooks:s,selectedPlaybook:a,setSelectedPlaybook:l,searchString:r,setSearchString:i}=e,[o,d]=(0,N.useState)(!1),[c,u]=(0,N.useState)(0),m=(0,N.useRef)(null),[x,h]=(0,N.useState)(t),p=(0,N.useCallback)(e=>{l(""===e.id?null:e),i(e.title||"No playbook"),d(!1)},[l,i]);(0,N.useEffect)(()=>{(null==t?void 0:t.length)&&h(t)},[t,a]),(0,N.useEffect)(()=>{(null==t?void 0:t.length)&&h(t.filter(e=>""===r||e.title.toLowerCase().includes(null==r?void 0:r.toLowerCase())))},[r,t]),(0,N.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[m]),(0,N.useEffect)(()=>{o&&(u(e=>e+1),i(""))},[o,u,i]);let g=(0,n.jsx)(B.p,{className:"opacity-70",size:18}),b=(null==x?void 0:x.length)>0?"".concat(Math.min(3.7*(null==x?void 0:x.length),18),"rem"):"".concat(3.2,"rem"),v=null==x?void 0:x.filter(e=>null==s?void 0:s.includes(e.id));return(0,n.jsxs)("div",{className:"relative flex h-full w-full flex-col text-black dark:text-white",ref:m,children:[(0,n.jsxs)("div",{onClick:()=>{var e;d(!o),null===(e=document.getElementById("search-playbooks"))||void 0===e||e.focus()},className:(0,f.Z)("dark:bg-input-dark hover:border-input-dark flex cursor-text items-center space-x-2 border border-slate-200 bg-slate-100 px-2 py-2 text-sm shadow-sm duration-150 dark:border-neutral-500 dark:hover:border-gray-400",o?"rounded-t-md":"rounded-md"),children:[(0,n.jsx)("input",{className:"w-full border-0 bg-transparent outline-none ring-0",type:"text",id:"search-playbooks",placeholder:"Search...",value:o?r:(null==a?void 0:a.title)||"No playbook",onChange:e=>i(e.target.value)}),g]}),(0,n.jsx)("div",{className:(0,f.Z)("dark:bg-night absolute left-0 top-full z-10 w-full overflow-hidden rounded-b-lg border border-t-0 border-slate-300 bg-white shadow-md duration-150 ease-in-out dark:border-[#484848]",o?"dark:shadow-extra-night opacity-100":"mt-0 pt-0 opacity-0"),id:"dropdown-menu-playbooks",onKeyUp:()=>d(!1),children:(0,n.jsx)(eo.E.div,{initial:{opacity:.3},animate:{opacity:1,height:o?b:"0rem"},transition:{duration:.13,exit:{duration:.075}},className:"mt-0.5 overflow-y-scroll ease-in-out",children:x.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:(0,f.Z)(v.length>0&&"dark:bg-night dark:border-input-dark border-b border-dashed border-slate-300"),children:[s&&s.length>0&&""===r&&(0,n.jsx)("div",{className:"my-1 px-2.5",children:(0,n.jsx)("div",{className:"text-xs text-gray-500",children:"Favorites"})}),null==v?void 0:v.map((e,t)=>(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(s0,{index:t,animationKey:c,playbook:e,selectedPlaybook:a,handleSelect:p},e.id),(0,n.jsx)(W.U,{className:"text-pacific absolute right-2.5 top-2.5 ml-auto h-3 w-3",weight:"fill"})]},e.id))]}),null==x?void 0:x.map((e,t)=>(null==s?void 0:s.includes(e.id))?null:(0,n.jsx)(s0,{index:t,animationKey:c,playbook:e,selectedPlaybook:a,handleSelect:p},e.id))]}):(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)("div",{className:"text-xs text-gray-500",children:"No results"})})})})]})};function s0(e){let{index:t,playbook:s,selectedPlaybook:a,animationKey:l,handleSelect:r}=e;return(0,n.jsx)(eo.E.div,{initial:{y:-12,opacity:.3},animate:{y:0,opacity:1},transition:{duration:.12+.03*t},className:"z-10 ease-in-out",children:(0,n.jsx)("div",{className:"bg-transparent px-1 py-0.5",children:(0,n.jsx)("div",{onClick:()=>r(s),className:(0,f.Z)("flex items-center rounded-md px-3 py-2 duration-150",""===s.id?"italic":"not-italic","dark:hover:bg-extra-night cursor-pointer opacity-80 hover:bg-gray-100 hover:opacity-100",(null==a?void 0:a.id)===s.id?"dark:bg-extra-night bg-gray-100":"bg-transparent"),children:(0,n.jsxs)("div",{className:"w-[90%]",children:[(0,n.jsx)("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap text-sm",children:s.title}),(0,n.jsx)("div",{className:" overflow-hidden text-ellipsis whitespace-nowrap text-xs opacity-70",children:s.body||"No description"})]})})})},"".concat(s.id,"-").concat(l))}let s1=e=>{let{snapshots:t,updateSnapshotState:s,selectedSnapshot:a,setSelectedSnapshot:l,defaultSnapshotId:r}=e,[i,o]=(0,N.useState)(""),[d,c]=(0,N.useState)(!1),[u,m]=(0,N.useState)(0),x=(0,N.useRef)(null),[h,p]=(0,N.useState)(t||[]),g=(0,N.useCallback)(e=>{l(e),o(e.snapshot_name),c(!1)},[l]);(0,N.useEffect)(()=>{if(null==t?void 0:t.length){let e=t.find(e=>e.snapshot_id===r);l(e||eS._),o((null==e?void 0:e.snapshot_name)||"")}},[r,null==t?void 0:t.length,l]),(0,N.useEffect)(()=>{(null==t?void 0:t.length)&&p(t)},[t,a]),(0,N.useEffect)(()=>{(null==t?void 0:t.length)&&p(t.filter(e=>""===i||e.snapshot_name.toLowerCase().includes(null==i?void 0:i.toLowerCase())))},[i,t]),(0,N.useEffect)(()=>{let e=e=>{x.current&&!x.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[x]),(0,N.useEffect)(()=>{d&&(m(e=>e+1),o(""))},[d,m,o]);let b=(0,n.jsx)(B.p,{className:"opacity-70",size:18}),v=(null==h?void 0:h.length)>0?"".concat(Math.min(3.7*(null==h?void 0:h.length),18),"rem"):"3.2rem";return(0,n.jsxs)("div",{className:"relative flex h-full w-full flex-col text-black dark:text-white",ref:x,children:[(0,n.jsxs)("div",{onClick:()=>{var e;c(!d),null===(e=document.getElementById("search-snapshots"))||void 0===e||e.focus()},className:(0,f.Z)("dark:bg-input-dark hover:border-input-dark flex cursor-text items-center space-x-2 border border-slate-200 bg-slate-100 px-2 py-2 text-sm shadow-sm duration-150 dark:border-neutral-500 dark:hover:border-gray-400",d?"rounded-t-md":"rounded-md"),children:[(0,n.jsx)("input",{className:"w-full border-0 bg-transparent outline-none ring-0",type:"text",id:"search-snapshots",placeholder:"Search...",value:d?i:(null==a?void 0:a.snapshot_name)||"",onChange:e=>o(e.target.value)}),b]}),(0,n.jsx)("div",{className:(0,f.Z)("dark:bg-night dark:border-input-dark absolute left-0 top-full z-10 w-full overflow-hidden rounded-b-lg border border-t-0 border-slate-300 bg-white shadow-md duration-150 ease-in-out",d?"dark:shadow-extra-night opacity-100":"mt-0 pt-0 opacity-0"),id:"dropdown-menu-snapshots",onKeyUp:()=>c(!1),children:(0,n.jsx)(eo.E.div,{initial:{opacity:.3},animate:{opacity:1,height:d?v:"0rem"},transition:{duration:.13,exit:{duration:.075}},className:"mt-0.5 overflow-y-scroll ease-in-out",children:h.length>0?null==h?void 0:h.map((e,t)=>(0,n.jsx)(s2,{index:t,animationKey:u,snapshot:e,selectedSnapshot:a,handleSelect:g,updateSnapshotState:s},e.snapshot_id)):(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)("div",{className:"text-xs text-gray-500",children:"No results"})})})})]})};function s2(e){let{index:t,snapshot:s,selectedSnapshot:a,animationKey:l,handleSelect:r,updateSnapshotState:i}=e,o="pending"===s.status,{data:c}=(0,eg.ur)(s.snapshot_id,o);return(0,N.useEffect)(()=>{c&&"pending"!==c.status&&i(c)},[c,i]),(0,n.jsx)(eo.E.div,{initial:{y:-12,opacity:.3},animate:{y:0,opacity:1},transition:{duration:.12+.03*t},className:"z-10 ease-in-out",children:(0,n.jsx)("div",{className:"bg-transparent px-1 py-0.5",children:(0,n.jsxs)("div",{onClick:()=>!o&&r(s),className:(0,f.Z)("flex items-center rounded-md px-3 py-2 duration-150","baseline"===s.snapshot_id?"italic":"not-italic",o?"opacity-50":"dark:hover:bg-extra-night cursor-pointer opacity-80 hover:bg-gray-100 hover:opacity-100",(null==a?void 0:a.snapshot_id)===s.snapshot_id?"dark:bg-extra-night bg-gray-100":"bg-transparent"),children:[(0,n.jsxs)("div",{className:"w-[90%]",children:[(0,n.jsx)("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap text-sm",children:s.snapshot_name}),(0,n.jsx)("div",{className:" overflow-hidden text-ellipsis whitespace-nowrap text-xs opacity-70",children:s.description||"No description"})]}),o&&(0,n.jsx)("div",{className:"ml-auto",children:(0,n.jsx)(d.U,{size:10,className:"ml-1.5 inline animate-spin"})})]})})},"".concat(s.snapshot_id,"-").concat(l))}let s5="dark:bg-input-dark w-full rounded-md border hover:border-gray-700 dark:hover:border-gray-400 bg-slate-100 px-2.5 py-[5px] text-[13px] outline-none ring-0 transition focus-within:border-neutral-400 dark:border-neutral-500 dark:focus-within:border-neutral-400";function s4(e){let{multiDevinProps:t,setMultiDevinProps:s,refetchMultiDevins:a,isEditing:l=!1,setIsEditing:r}=e,{selectedMultiDevin:i,setSelectedMultiDevin:o}=(0,eS.F)(),{orgId:d}=(0,T.aC)(),[c,u]=(0,b.KO)(F.i6),{data:m}=(0,eg.qN)(),[x,h]=(0,N.useState)(""),[p,g]=(0,N.useState)(m),[v,j]=(0,N.useState)(""),[w,k]=(0,N.useState)(60),[y,_]=(0,N.useState)(""),[S,E]=(0,N.useState)(ek),[D,M]=(0,N.useState)("main"),[A,O]=(0,N.useState)(!1),[z,I]=(0,N.useState)(!1),[L,Z]=(0,N.useState)([]),[P,R]=(0,N.useState)(null),[K,U]=(0,N.useState)(eS._),V=e=>{u(e),l&&r&&r(!1)};(0,N.useEffect)(()=>{m&&g(m)},[m]),(0,N.useEffect)(()=>{if(l&&r){var e;h((null==i?void 0:i.title)||""),j((null==i?void 0:i.config.custom_prompt)||""),_((null==i?void 0:i.config.repo)||""),I((null==i?void 0:i.no_manager)||!1),k((null==i?void 0:null===(e=i.config)||void 0===e?void 0:e.timeout)?i.config.timeout/60:60),E((null==i?void 0:i.config.manager_prompt)||""),M((null==i?void 0:i.config.root_branch)||"")}else X()},[c]);let H=(0,N.useCallback)(e=>{g(t=>null==t?void 0:t.map(t=>t.snapshot_id===e.snapshot_id?{...t,status:e.status,description:e.description,snapshot_name:e.snapshot_name,startup_commands:e.startup_commands}:t))},[]),[W,q]=(0,N.useState)(!1),B=(0,N.useCallback)(e=>{let t=e[0];t&&(0,sJ.parse)(t,{complete:e=>{Z(null==e?void 0:e.data),q(!0)},error:e=>{C.A.error("Error parsing CSV: ".concat(e.message))}})},[]),{getRootProps:Y,getInputProps:J,isDragActive:$}=(0,sk.uI)({onDrop:B,accept:{"text/csv":[".csv"]},multiple:!1,noClick:W,disabled:l}),X=()=>{h(""),j(""),_(""),k(60),E(ek),M(""),I(!1),Z([]),s(ey),q(!1)},Q=async e=>{let s;if(e.preventDefault(),0===L.length&&!l){C.A.error("Please upload a CSV file before submitting.");return}let n=l?L:L[L.length-1].every(e=>""===e)?L.slice(0,-1):L;if(n.length<=1&&!l){C.A.error("Please upload a valid CSV file.");return}let r=n.slice(1).map(e=>Object.fromEntries(n[0].map((t,s)=>[t,e[s]]))),c={...t,tasks:r.map(e=>({raw_info:e})),active:!1,num_workers:5,title:x,snapshot_id:(null==K?void 0:K.snapshot_id)||"baseline",worker_playbook_id:(null==P?void 0:P.id)||null,no_manager:z,config:{timeout:60*Math.max(w,15),custom_prompt:v,root_branch:D,manager_prompt:S,repo:y}};if(V(!1),l){if(!(null==i?void 0:i.scheduled_devin_id)){C.A.error("No MultiDevin job found");return}s=await (0,ew.EJ)(i.scheduled_devin_id,c)}else C.A.info("Creating MultiDevin job..."),s=await (0,ew.hV)(c);s&&(a(),C.A.success(l?"Updated successfully":"MultiDevin job created"),X(),o({...c,scheduled_devin_id:s.scheduled_devin_id,org_id:d||""}))},ee=(0,N.useMemo)(()=>{if(L.length<=1)return!1;let e=L[0].findIndex(e=>["file","filename","filepath"].includes(e.toLowerCase()));if(-1===e)return!1;let t=L.slice(1).map(t=>t[e]);return new Set(t).size<t.length},[L]);return(0,n.jsx)(tV.Vq,{modal:!0,open:c,onOpenChange:V,children:(0,n.jsxs)(tV.cZ,{className:"max-h-[95vh] overflow-y-scroll py-6 sm:max-w-screen-md md:max-h-[85vh]",children:[(0,n.jsx)(tV.fK,{className:"whitespace-nowrap",children:(0,n.jsx)(tV.$N,{className:"relative w-full tracking-tight",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"text-xl font-medium",children:l?"Edit MultiDevin":"Create MultiDevin"}),(0,n.jsx)("button",{onClick:X,className:"dark:bg-extra-night ml-auto mr-4 rounded-md bg-gray-200 px-3 py-1 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-300 dark:text-gray-300 dark:hover:bg-black",children:"Clear form"})]})})}),(0,n.jsxs)("form",{onSubmit:Q,className:"overflow-hidden",children:[(0,n.jsx)("div",{className:"mt-1.5 md:mt-3",children:(0,n.jsx)("input",{type:"text",placeholder:"Title",value:x,onChange:e=>h(e.target.value),className:(0,f.Z)(s5,"!py-2"),required:!0})}),(0,n.jsxs)("div",{className:"dark:border-input-dark mb-2 mt-3 flex w-full items-center border-b",children:[(0,n.jsx)("label",{htmlFor:"global_prompt",className:"text-pacific text-base font-medium",children:"Global settings"}),(0,n.jsx)(sD.u,{content:(0,n.jsxs)("span",{className:"text-left text-xs",children:["The worker prompt is passed to each worker Devin.",(0,n.jsx)("br",{}),"The snapshot will be applied to manager Devin and worker Devins."]}),side:"right",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)(G.k,{size:16,className:"ml-1 text-gray-500"})})]}),(0,n.jsx)("input",{type:"text",placeholder:"Repository name",value:y,onChange:e=>_(e.target.value),className:(0,f.Z)(s5,"!py-2"),required:!0}),(0,n.jsxs)("div",{className:"mt-1.5 flex items-center gap-1.5",children:[(0,n.jsx)(s1,{snapshots:[eS._,...p||[]],updateSnapshotState:H,selectedSnapshot:K,setSelectedSnapshot:U,defaultSnapshotId:l?(null==i?void 0:i.snapshot_id)||"":void 0}),(0,n.jsx)(sX,{selectedPlaybook:P,setSelectedPlaybook:R,defaultPlaybookId:l?(null==i?void 0:i.worker_playbook_id)||"":void 0})]}),(0,n.jsx)("div",{className:"mt-1.5",children:(0,n.jsx)("textarea",{className:s5,placeholder:"Worker prompt (include setup, testing instructions, success criteria, etc.)",value:v,onChange:e=>j(e.target.value),required:!0})}),(0,n.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm",children:"Merge workers into a single PR?"}),(0,n.jsx)("input",{type:"checkbox",className:"mr-1 h-4 w-4 rounded-sm border border-gray-300",checked:!z,onChange:()=>I(!z)})]}),!l&&(0,n.jsxs)("div",{className:"mb-0 mt-5 flex flex-col justify-between overflow-hidden pb-0 text-base",children:[(0,n.jsxs)("span",{className:"text-pacific dark:border-input-dark border-b pb-0.5 font-medium",children:["Tasks (",Math.max(L.length-1,0),")"]}),!W&&(0,n.jsxs)("div",{...Y(),className:"dark:hover:bg-extra-night my-3 cursor-pointer rounded-md border border-dashed border-gray-300 px-4 py-7 text-center text-sm font-medium transition-colors hover:bg-gray-50",children:[(0,n.jsx)("input",{...J()}),$?(0,n.jsx)("p",{children:"Drop CSV here"}):(0,n.jsx)("p",{children:"Drag CSV here, or click to select"})]}),L.length>0&&(0,n.jsxs)(n.Fragment,{children:[ee&&(0,n.jsxs)("p",{className:"text-ray -mb-2 mt-1.5 text-[13px] font-medium",children:[(0,n.jsx)(sq.Z,{size:13,className:"mx-1 inline-block"}),"Warning: it is recommended to combine issues from the same file to a single worker task."]}),(0,n.jsxs)("div",{...Y(),className:"relative mb-2.5 mt-4 h-60 overflow-hidden rounded-md border border-gray-300 text-xs",children:[(0,n.jsx)("input",{...J()}),(0,n.jsx)("div",{className:"h-full overflow-auto overflow-x-scroll",children:(0,n.jsxs)("table",{className:"w-full border-collapse",children:[(0,n.jsx)("thead",{className:"dark:bg-extra-night sticky top-0 bg-gray-100",children:(0,n.jsx)("tr",{children:L[0].map((e,t)=>e&&(0,n.jsx)("th",{className:"min-w-[30px] max-w-[14vw] truncate border-b border-r border-gray-300 px-2 py-1 text-left font-semibold last:border-r-0",children:e},t))})}),(0,n.jsx)("tbody",{children:L.slice(1).map((e,t)=>(0,n.jsx)("tr",{children:e.map((e,t)=>{if(e)return(0,n.jsx)("td",{className:"min-w-[30px] max-w-[14vw] truncate border-b border-r border-gray-300 px-2 py-1 last:border-r-0",children:e},t)})},t))})]})}),$&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-blue-500 bg-opacity-50",children:(0,n.jsx)("p",{className:"font-bold text-white",children:"Drop to replace CSV"})})]})]})]}),(0,n.jsxs)(eo.E.div,{initial:!1,animate:A?"open":"closed",className:(0,f.Z)("my-1 w-full",l&&"pt-4"),children:[(0,n.jsx)("div",{className:"dark:border-input-dark border-b pb-0.5",children:(0,n.jsxs)("div",{className:"group flex w-full cursor-pointer items-center",onClick:()=>O(!A),children:[(0,n.jsx)("h3",{className:"text-pacific text-base font-medium",children:"Advanced Settings"}),(0,n.jsx)(sD.u,{content:(0,n.jsxs)("span",{className:"text-left text-xs",children:["Worker timeout: the time that each worker Devin has to complete a task before automatic failure.",(0,n.jsx)("br",{}),"Manager prompt: instructions given solely to the manager (typically around PR creation).",(0,n.jsx)("br",{}),"Root branch: the branch that the manager Devin uses to create the PR."]}),side:"right",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)(G.k,{size:16,className:"ml-1 text-gray-500"})}),(0,n.jsx)("button",{type:"button",className:"ml-auto rounded-md p-1 text-black opacity-70 transition group-hover:opacity-100 dark:text-white",children:A?(0,n.jsx)(sB.Z,{size:16}):(0,n.jsx)(sY.Z,{size:16})})]})}),(0,n.jsx)(eo.E.div,{variants:{open:{opacity:1,height:"auto"},closed:{opacity:0,height:0}},transition:{duration:.15},className:(0,f.Z)(A?"overflow-visible":"overflow-hidden","ease-in-out"),children:(0,n.jsxs)("div",{className:"mt-2.5 flex flex-col gap-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm font-normal",children:"Worker timeout (minutes)"}),(0,n.jsx)("input",{type:"number",className:(0,f.Z)(s5,"!w-[60px] text-right","[appearance:textfield] [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none"),value:w,onChange:e=>k(parseInt(e.target.value)),required:!0})]}),(0,n.jsx)("textarea",{className:s5,placeholder:"Manager prompt",value:S,onChange:e=>E(e.target.value),rows:3}),(0,n.jsx)("input",{type:"text",placeholder:"Root branch",value:D,onChange:e=>M(e.target.value),className:s5})]})})]}),(0,n.jsx)("div",{className:"flex flex-col items-center",children:(0,n.jsx)("button",{type:"submit",className:"bg-pacific mt-3 flex w-full items-center justify-center gap-2 rounded-md py-2.5 text-sm text-white ring-0 transition hover:bg-blue-500",children:l?"Update MultiDevin":"Create MultiDevin"})})]})]})})}var s8=s(48912);function s3(e){return"2xl"===e?{fontSize:"32px",lineHeight:"37px"}:"lg"===e||"xl"===e?{fontSize:"30px",lineHeight:"36px"}:{fontSize:"24px",lineHeight:"32px"}}let s6=(0,n.jsx)("span",{className:"block max-w-[500px]",children:"Enter a coding task below to get started."});function s7(e){let{enabled:t,setEnabled:s}=e;return(0,n.jsxs)("div",{className:"dark:bg-input-dark flex items-center gap-2 rounded-md bg-slate-100 px-2 py-1.5",children:[(0,n.jsx)("span",{className:"text-xs",children:"Human Mode"}),(0,n.jsx)(ss.r,{className:"dark:data-[state=unchecked]:bg-cloud",checked:t,onCheckedChange:s})]})}function s9(e){var t,s;let{userId:a,orgId:l,orgRole:r,isLoaded:i,isSignedIn:o}=(0,T.aC)(),d=(0,b.b9)(F.H7),c=(0,b.Dv)(F.H7),[u]=(0,N.useState)(c),[m,x]=(0,N.useState)(!1),{statusState:h}=(0,eN.cd)(),p=(0,N.useRef)(null),[g,v,j]=function(e){let t=(0,em.Z)("skip-github-connection-".concat(e),{value:!1,date:new Date});return e?t:[{value:!1,date:new Date},()=>{},()=>{}]}(l),w=(0,eS.F)(e=>e.removeSelectedConfig),k=ef(),{resolvedTheme:C}=(0,ec.F)(),{shouldRestrictFeatures:_,isFetched:S}=(0,eb.b1)();(0,N.useEffect)(()=>{d(!0)},[d]);let E=h.isLoading||!h.value,D="org:admin"===r||!!(null==l?void 0:l.startsWith("personal-")),M=!(null===(t=h.value)||void 0===t?void 0:t.account_name);(0,N.useEffect)(()=>{if(null==g?void 0:g.date){let e=new Date(Date.now()-2592e5);new Date(g.date).getTime()<e.getTime()&&j()}},[j,g]);let A=av(),O=(0,y.useSearchParams)().get("playbook");(0,N.useEffect)(()=>{A||O||w()},[l,A,w,O]);let[z,I]=(0,N.useState)(!1),[L,Z]=(0,ei.H)(),P=(0,eT._Z)(),R=(0,eT.K7)(),K=!!(null===(s=h.value)||void 0===s?void 0:s.account_name),U=D&&!K,V=!!a&&!!((null==g?void 0:g.value)||!M&&!E||!U),H=i&&o&&l&&l.startsWith("personal");return(0,n.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-3 px-2 pt-5 sm:px-4 md:px-8 dark:text-white",children:[(0,n.jsxs)("div",{className:"hidden items-center gap-3 text-lg font-semibold md:flex",children:[(0,n.jsx)("div",{className:"h-[19px] w-[19px]",children:(0,n.jsx)(eu.default,{src:"/devin.svg",alt:"Active tab",width:"19",height:"19",className:"block object-cover",unoptimized:!0})}),(0,n.jsx)("span",{children:"Devin"})]}),(0,n.jsxs)(s8.Z,{children:[R&&(0,n.jsx)("div",{className:"ml-auto",children:(0,n.jsx)(s7,{enabled:m,setEnabled:x})}),P&&(0,n.jsx)("div",{className:"",children:(0,n.jsx)(sW.P,{orgId:null!=l?l:void 0})})]}),a&&!E&&S&&!_?M?(0,n.jsx)(af,{small:!0,showMainConnect:U,setSkipGithub:v}):(0,n.jsx)(ah,{}):null]}),(0,n.jsx)("div",{className:"mx-auto flex w-full flex-1 flex-col px-4 pb-0.5 pt-[4%] md:max-w-[90%] lg:max-w-[85%] xl:max-w-[80%]",children:(0,n.jsxs)("div",{className:"flex h-full flex-1 flex-col overflow-y-hidden",children:[u?(0,n.jsx)("div",{children:(0,n.jsx)("div",{style:s3(k),className:"break-normal text-lg font-bold text-neutral-600 lg:text-xl 2xl:text-2xl dark:text-white",children:s6})}):(0,n.jsxs)(eo.E.div,{animate:p.current&&V?{marginTop:-p.current.clientHeight,transition:{delay:.8,duration:.4}}:{},children:[(0,n.jsx)(eo.E.div,{ref:p,animate:V&&{transition:{delay:.8,duration:.4},opacity:0},className:"flex max-w-[460px]",children:(0,n.jsxs)("div",{className:"mb-4 flex flex-col text-3xl font-bold leading-[40px] text-neutral-700 sm:block lg:leading-[45px] 2xl:text-4xl dark:text-white",children:[(0,n.jsx)("span",{className:"w-fit bg-gradient-to-r from-[#3969CB] via-[#0295DF] to-[#21C29B] bg-clip-text text-transparent",children:"Hey there!"})," ","I'm Devin and I'm a software engineer."]})}),(0,n.jsx)(eo.E.div,{animate:V&&{...s3(k),fontWeight:"bold",transition:{delay:.8,duration:.4},color:"dark"===C?"#ffffff":"rgb(64,64,64)"},className:"dark:text-cloud break-normal text-lg font-medium text-neutral-400 lg:text-xl 2xl:text-2xl",children:s6})]}),(0,n.jsxs)("div",{className:"relative flex h-full w-full flex-1 flex-col",children:[(0,n.jsx)(eo.E.div,{animate:{opacity:z?0:1},transition:{duration:.2},className:"flex h-full w-full flex-1 flex-col",children:a&&!E&&S&&!_?V?(0,n.jsx)(eo.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0,transition:{delay:.5},animation:"ease-in"},className:"mt-8 h-full w-full flex-1",children:(0,n.jsx)(ae,{orgId:l})}):(0,n.jsxs)("div",{className:"flex h-full flex-col justify-between",children:[(0,n.jsx)("div",{className:"dark:border-input-dark mt-10 flex w-fit items-center gap-3",children:(0,n.jsx)(af,{showMainConnect:U,setSkipGithub:v})}),(0,n.jsx)("div",{children:H&&(0,n.jsxs)("div",{className:"text-sm dark:text-white",children:["Here are some things we can try:",(0,n.jsx)(am,{suggestions:au})]})})]}):(0,n.jsx)("div",{className:"flex-1"})}),(0,n.jsx)("div",{ref:L,className:(0,f.Z)("px-0.5",z&&"absolute bottom-0 w-full"),children:(0,n.jsx)("div",{className:"z-40 mx-auto mt-10 h-full w-full pb-4 pt-2",style:{marginTop:"auto"},children:(0,n.jsx)(sI,{...e,expanded:z,onToggleExpand:e=>(I(e),Z(L.current,{height:e?"100%":"auto",paddingTop:e?"32px":"0px"},{duration:.25})),humanModeEnabled:m})})})]})]},a)})]})}function ae(e){let{orgId:t}=e,s=(0,b.Dv)(F.ug),a=s===eE.n.MULTI_DEVIN,l=s===eE.n.SPARKOPS,{data:r,isLoading:i}=(0,eg.qN)(),o=(0,eS.F)(e=>e.currentTab),d=(0,eS.F)(e=>e.setCurrentTab),[c,u]=(0,N.useState)(!1),m=(0,eS.F)(e=>e.removeSelectedPlaybook),x=(0,eS.F)(e=>e.setSelectedSnapshot),h=(0,eS.F)(e=>e.removeSelectedSnapshot),{data:p,isLoading:g}=(0,eg.sm)(s);(0,N.useEffect)(()=>{if(l){if(m(),i){h();return}let e=["snapshot-c64d232d295841c68e4707923180bfd6","snapshot-ae3d85bbeb84406987f79a383a5600af"],t=(r||[]).find(t=>e.includes(t.snapshot_id));t?x(t):h()}},[l,m,h,x,r,i]),(0,N.useEffect)(()=>{a?d("select_multidevin"):d("quick_start")},[a,t,d]);let{setInput:v}=(0,N.useContext)(ep.r),[j,w]=(0,N.useState)(ey),{data:k,isLoading:y,refetch:C}=(0,eg.B9)(null!=t?t:"");return l?g?(0,n.jsx)("div",{}):(null==p?void 0:p.contents)?(0,n.jsx)("div",{className:"relative h-full w-full overflow-y-auto",dangerouslySetInnerHTML:{__html:p.contents}}):(0,n.jsx)("div",{}):(0,n.jsxs)(er.fC,{value:o||((null==t?void 0:t.startsWith("personal-"))?"suggestions":"quick_start"),className:"flex h-full w-full flex-col",onValueChange:e=>d(e),children:[(0,n.jsx)(s4,{multiDevinProps:j,setMultiDevinProps:w,refetchMultiDevins:C,isEditing:c,setIsEditing:u}),(0,n.jsxs)(er.aV,{className:"mb-6 flex items-center justify-between text-sm sm:justify-start",children:[(0,n.jsx)(er.xz,{value:"suggestions",className:"text-cloud data-[state=active]:text-gray-700 sm:mr-5 dark:data-[state=active]:text-white",children:"Suggestions"}),(0,n.jsx)(er.xz,{value:"quick_start",className:"text-cloud data-[state=active]:text-gray-700 sm:mr-5 dark:data-[state=active]:text-white",children:"Quick Start"}),(0,n.jsx)("div",{className:"bg-cloud w-px pt-5",tabIndex:-1}),(0,n.jsx)(er.xz,{value:"select_playbook",className:"text-cloud data-[state=active]:text-gray-700 sm:ml-5 sm:mr-8 dark:data-[state=active]:text-white",children:"Select a playbook"}),(0,n.jsx)(er.xz,{value:"select_snapshot",className:(0,f.Z)("text-cloud data-[state=active]:text-gray-700 dark:data-[state=active]:text-white",a&&"sm:mr-8"),children:"Select a snapshot"}),a&&(0,n.jsx)(er.xz,{value:"select_multidevin",className:"text-cloud data-[state=active]:text-gray-700 dark:data-[state=active]:text-white",children:"Select a MultiDevin"})]}),(0,n.jsx)(er.VY,{value:"suggestions",className:"relative w-full grow overflow-y-auto [&:not([hidden])]:flex",children:(0,n.jsx)(am,{suggestions:au})}),(0,n.jsx)(er.VY,{value:"quick_start",className:"relative w-full grow overflow-y-auto [&:not([hidden])]:flex",children:(0,n.jsx)(ac,{})}),(0,n.jsx)(er.VY,{value:"select_playbook",className:"relative w-full grow overflow-y-auto [&:not([hidden])]:flex",children:(0,n.jsx)(ao,{})}),(0,n.jsx)(er.VY,{value:"select_snapshot",className:"relative w-full grow overflow-y-auto [&:not([hidden])]:flex",children:(0,n.jsx)(ad,{})}),a&&(0,n.jsx)(er.VY,{value:"select_multidevin",className:"relative w-full grow overflow-y-auto [&:not([hidden])]:flex",children:(0,n.jsx)(at,{setInput:v,multiDevinConfigsQuery:k,isLoadingMultiDevinConfigs:y,refetchMultiDevins:C,setIsEditingMultiDevin:u})})]})}function at(e){var t;let{setInput:s,multiDevinConfigsQuery:a,isLoadingMultiDevinConfigs:l,refetchMultiDevins:r,setIsEditingMultiDevin:i}=e,o=(0,b.b9)(F.i6),[c,u]=(0,N.useState)(!1),[m,x]=(0,N.useState)(!1),h=(0,eS.F)(e=>e.selectedMultiDevin),p=null==h?void 0:h.scheduled_devin_id,f=(0,eS.F)(e=>e.setSelectedMultiDevin),g=(0,eS.F)(e=>e.setSelectedMultiDevinTasks),{data:v,isLoading:j,refetch:w}=(0,eg.Vc)(p);(0,N.useEffect)(()=>{if(p&&!j){var e;s((null==v?void 0:null===(e=v.config)||void 0===e?void 0:e.custom_prompt)||"")}},[p,j,s,null==v?void 0:null===(t=v.config)||void 0===t?void 0:t.custom_prompt]);let k=(0,N.useMemo)(()=>(null!=a?a:[]).map(e=>({id:e.scheduled_devin_id,...e})),[a]);(0,N.useEffect)(()=>{j||g((null==v?void 0:v.tasks)||[])},[v,j,g]);let y=()=>{p&&((0,ew.Jh)(p),u(!1),setTimeout(()=>{r()},100),s(""))},C=()=>{o(!0),i(!0)},_=()=>{p&&((0,ew.Yw)(p),x(!1),setTimeout(()=>{w()},10))};return(0,n.jsx)(ar,{type:"multidevin",groups:[["All",k]],isLoading:l,selectedId:p,onSelect:e=>{f(e),s((null==h?void 0:h.config.custom_prompt)||"")},render:e=>{var t,s,a,l,r,i;return(0,n.jsx)("div",{className:"flex flex-col",children:j?(0,n.jsx)("div",{className:"flex h-full items-center justify-center pt-4",children:(0,n.jsx)(d.U,{size:22,className:"text-pacific animate-spin"})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(su.T,{title:"Delete MultiDevin",description:"Are you sure you want to delete this MultiDevin?",onConfirm:y,open:c,onCancel:()=>u(!1)}),(0,n.jsx)(su.T,{title:"Reset MultiDevin",description:"Are you sure you want to reset the tasks for this MultiDevin?",onConfirm:_,open:m,onCancel:()=>x(!1)}),(0,n.jsxs)("div",{className:"mb-3 w-full",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"text-pacific mr-2 overflow-hidden text-ellipsis text-2xl font-medium",children:null==h?void 0:h.title}),(0,n.jsx)(al,{onReset:()=>x(!0),onEdit:C,onDelete:()=>u(!0)})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(null==h?void 0:h.worker_playbook_id)&&(0,n.jsx)("div",{className:"text-pacific mt-1 rounded-md bg-[rgb(236,239,247)] px-2 py-1 text-xs dark:bg-neutral-600",children:"Playbook enabled"}),(null==h?void 0:h.snapshot_id)&&(0,n.jsx)("div",{className:"text-ray mt-1 rounded-md bg-[rgb(236,239,247)] px-2 py-1 text-xs dark:bg-neutral-600",children:"Snapshot enabled"})]})]}),(0,n.jsxs)("span",{className:"mb-2 flex items-center justify-between text-lg font-medium dark:text-white",children:[(0,n.jsx)("span",{className:"mr-2 w-full flex-wrap items-center lg:flex",children:"Worker prompt"}),(0,n.jsxs)("div",{className:"flex items-center gap-1 text-sm font-medium opacity-50",children:[(0,n.jsx)(R.v,{size:18}),(0,n.jsx)("span",{className:"truncate",children:null==h?void 0:null===(t=h.config)||void 0===t?void 0:t.repo})]})]}),(0,n.jsx)("p",{className:"dark:text-sleet mb-4 whitespace-pre-wrap text-sm font-light",children:(null==h?void 0:null===(s=h.config)||void 0===s?void 0:s.custom_prompt)||"No prompt"}),(null==h?void 0:h.no_manager)?(0,n.jsx)("span",{className:"mb-3 text-xs italic opacity-60",children:"MultiDevin will create individual PRs"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"mb-2 flex items-center justify-between text-lg font-medium dark:text-white",children:"Manager prompt"}),(0,n.jsx)("p",{className:"dark:text-sleet mb-4 whitespace-pre-wrap text-sm font-light",children:(null==h?void 0:null===(a=h.config)||void 0===a?void 0:a.manager_prompt)||"No prompt"})]}),e.created_by&&(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-lg font-medium dark:text-white",children:"Creator:"}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"text-sm",children:null==v?void 0:null===(l=v.created_by)||void 0===l?void 0:l.full_name}),(0,n.jsx)("img",{src:null==v?void 0:null===(r=v.created_by)||void 0===r?void 0:r.image_url,alt:null==v?void 0:null===(i=v.created_by)||void 0===i?void 0:i.full_name,className:"mx-2 h-8 w-8 rounded-full"})]})]}),(0,n.jsxs)("div",{className:"mt-3 border-t pt-3 dark:border-neutral-500",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("span",{className:"mb-2 text-lg font-medium dark:text-white",children:["Tasks"," ",(null==v?void 0:v.tasks)?"(".concat(null==v?void 0:v.tasks.length,")"):""]})}),(0,n.jsx)("div",{className:"mt-1 overflow-hidden",children:null==v?void 0:v.tasks.sort((e,t)=>{let s={new:0,failed:1,completed:2};return s[e.status]-s[t.status]}).map((e,t)=>(0,n.jsx)(as,{task:e,index:t},e.task_id))})]})]})})}})}let as=e=>{let{task:t,index:s}=e,a=(e,t)=>"object"==typeof t&&null!==t||"null"===t||""===t?null:(0,n.jsxs)("div",{className:"scrollbar-hide mt-2 overflow-y-auto text-sm",children:[(0,n.jsxs)("div",{className:"text-pacific text-xs font-medium capitalize",children:[e.replace(/_/g," "),":"]}),(0,n.jsx)("div",{className:"",children:t})]},e);return(0,n.jsx)("div",{className:"dark:bg-cloud/25 mb-2 rounded-md bg-[rgba(236,239,247,0.8)] p-3",children:(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsxs)("div",{id:"Heading",className:"mb-2 flex w-full items-center",children:[(0,n.jsx)("div",{className:"bg-pacific mr-2 flex h-6 w-6 items-center justify-center rounded-full text-sm font-medium text-white",children:s+1}),(null==t?void 0:t.status)&&(0,n.jsx)("div",{className:"ml-auto mr-2 flex items-center gap-1 capitalize",children:(0,n.jsx)(aa,{status:t.status})})]}),(null==t?void 0:t.raw)&&Object.entries(t.raw).map(e=>{let[t,s]=e;return a(t,s)})]})})};function aa(e){let{status:t}=e;return(0,n.jsx)("span",{className:(0,eD.cn)("rounded-full px-2 py-0.5 text-xs font-medium capitalize","new"===t&&"bg-ray/80 text-white","failed"===t&&"bg-red-500/70 text-white","completed"===t&&"bg-turquoise/90 text-white","in_progress"===t&&"bg-pacific/80 text-white"),children:"in_progress"===t?"In progress":t})}let al=e=>{let{className:t,onEdit:s,onDelete:a,onReset:l}=e;return(0,N.useMemo)(()=>(0,n.jsxs)(eh.h_,{modal:!1,children:[(0,n.jsx)(eh.$F,{asChild:!0,onClick:e=>e.preventDefault(),children:(0,n.jsx)("button",{className:"block h-full align-middle text-lg",children:(0,n.jsx)(K.x,{className:(0,f.Z)(t),size:22})})}),(0,n.jsxs)(eh.AW,{side:"top",className:"dark:border-cloud dark:bg-input-dark w-56 bg-white",children:[(0,n.jsxs)(eh.Xi,{className:"",onClick:s,children:[(0,n.jsx)(U.z,{}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Edit"})]}),(0,n.jsxs)(eh.Xi,{className:"",onClick:l,children:[(0,n.jsx)(V.y,{}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Reset"})]}),(0,n.jsxs)(eh.Xi,{className:"",onClick:a,children:[(0,n.jsx)(H.r,{}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Delete"})]})]})]}),[s,a,t,l])};function an(e){let{playbookId:t}=e,{data:s=[]}=(0,ej.cZ)(),a=(0,ej.jk)(),l=s.includes(t);return(0,n.jsx)(eo.E.button,{onClick:e=>{e.stopPropagation();let n=l?s.filter(e=>e!==t):[...s,t];a.mutate({playbooks_favorites:n})},className:(0,f.Z)("active:text-pacific outline-none transition-colors focus:outline-none",l&&"text-pacific active:text-white"),whileTap:{scale:.9},children:(0,n.jsx)(W.U,{size:16,weight:l?"duotone":"regular"})})}function ar(e){let t=e.groups.map(e=>{let[t]=e;return t}),s=(0,b.b9)(F.i6),[a,l]=(0,N.useState)(t[0]||""),r=e=>{a===e?l(t.find(t=>t!==e)||e):l(e)},[i,o]=(0,N.useState)(""),c=(0,N.useMemo)(()=>e.groups.map(e=>{let[t,s]=e;return[t,s.filter(e=>e.title.toLowerCase().includes(i.toLowerCase()))]}),[e.groups,i]),m=(0,N.useMemo)(()=>{for(let t of e.groups)for(let s of t[1])if(s.id===e.selectedId)return s;return null},[e.groups,e.selectedId]);return(0,n.jsxs)("div",{className:"absolute flex h-full w-full flex-col gap-3 md:flex-row",children:[(0,n.jsxs)("div",{className:"flex max-h-full flex-col md:w-64 xl:w-72",children:[(0,n.jsxs)("div",{className:"dark:bg-input-dark mb-3 flex items-center gap-2 rounded-lg border border-transparent bg-slate-50 px-2.5 py-1.5 transition focus-within:border-neutral-300 dark:focus-within:border-neutral-500",children:[(0,n.jsx)("input",{value:i,onChange:e=>o(e.target.value),placeholder:"Search for a ".concat(e.type),className:"flex-1 bg-transparent text-sm font-light outline-none placeholder:text-neutral-400 focus:outline-none dark:text-white dark:placeholder:text-white"}),(0,n.jsx)(q.Y,{weight:"bold",className:"text-neutral-500 dark:text-white"})]}),(0,n.jsx)("div",{className:"dark:bg-input-dark flex w-full flex-1 flex-col gap-0.5 overflow-y-auto rounded-lg bg-slate-50",children:e.isLoading?(0,n.jsx)("div",{className:"flex h-full w-full items-center justify-center text-[#6096FF]",children:(0,n.jsx)(d.U,{size:22,className:"animate-spin"})}):(0,n.jsx)("div",{className:"flex h-full w-full flex-col overflow-y-auto",children:c.map((t,s)=>{let[l,i]=t;return(0,n.jsxs)("div",{className:(0,f.Z)("dark:border-cloud flex w-full cursor-pointer flex-col overflow-hidden  border-b border-neutral-300 px-2 py-2 font-medium last:!border-transparent dark:text-white",a===l&&"h-full flex-1"),children:[c.length>1&&(0,n.jsxs)("div",{className:"group flex w-full items-center justify-between gap-1 px-1 text-sm",onClick:()=>r(l),children:[l,(0,n.jsx)(B.p,{className:(0,f.Z)("transition-transform duration-300 ease-[cubic-bezier(0.87,0,0.13,1)]",a===l&&"rotate-180"),"aria-hidden":!0})]}),(0,n.jsx)("div",{className:(0,f.Z)("overflow-y-auto bg-transparent ",c.length>1&&"mt-2",c.length>1&&s!==c.length-1&&a===l&&"pb-6",a===l?"!min-h-full flex-1":"!max-h-0"),children:i.length>0?null==i?void 0:i.map(t=>{let s=e.selectedId===t.id,a="snapshot"===e.type&&"pending"===t.status;return(0,n.jsxs)(eo.E.button,{layout:!0,className:(0,eD.cn)("hover:dark:bg-cloud/25 group flex w-full items-center justify-between gap-2 rounded-md px-1 py-1.5  text-xs font-light transition-colors hover:bg-slate-200 2xl:text-sm dark:text-white/50 dark:hover:text-white",s&&"dark:bg-cloud/50 bg-slate-200 dark:text-white",a&&"opacity-60"),disabled:a,onClick:()=>e.onSelect(s?null:t),children:[(0,n.jsxs)("div",{className:"flex flex-1 items-center gap-2 overflow-hidden",children:["playbook"===e.type&&(0,n.jsx)(Y.M,{size:18}),"snapshot"===e.type&&(0,n.jsx)(u.H,{size:18}),(0,n.jsx)("span",{className:"pointer-events-none flex-1 select-none truncate text-left",children:t.title})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:["playbook"===e.type&&(0,n.jsx)(an,{playbookId:t.id}),a?(0,n.jsx)(d.U,{size:17,className:"inline animate-spin"}):(0,n.jsxs)("div",{className:(0,eD.cn)("flex size-4 cursor-pointer items-center justify-center rounded-full border border-neutral-300 outline-none focus:outline-none group-hover:border-neutral-600 dark:border-white/50 group-hover:dark:border-white",s&&"border-neutral-600 dark:border-white"),children:[" ",(0,n.jsx)(ed.M,{children:s&&(0,n.jsx)(eo.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},children:(0,n.jsx)(J.J,{size:12,weight:"bold"})})})]})]})]},t.id)}):(0,n.jsx)("div",{className:"flex size-full items-center justify-center pb-2 text-sm font-normal opacity-70 dark:text-white",children:"No results found"})})]},l)})})})]}),(0,n.jsx)("div",{className:"dark:bg-input-dark flex-1 rounded-md bg-slate-50 p-4 md:overflow-auto dark:text-white",children:m&&!e.isLoading?e.render(m):(0,n.jsx)("div",{className:"grid size-full place-items-center text-neutral-600 dark:text-white",children:(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2 text-sm",children:[(0,n.jsxs)("div",{className:"px-2.5 py-2 opacity-80",children:["Select a ",e.type]}),"playbook"===e.type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"opacity-50",children:"or"}),(0,n.jsx)(k.default,{href:"/playbooks/create",children:(0,n.jsx)(ai,{text:"Write your own in library",icon:(0,n.jsx)(Y.M,{weight:"bold",className:"text-neutral-600 dark:text-white"})})})]}),"multidevin"===e.type&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"opacity-50",children:"or"}),(0,n.jsx)(ai,{onClick:()=>s(!0),text:"Create a new MultiDevin batch",icon:(0,n.jsx)(U.z,{weight:"bold",className:"text-neutral-600 dark:text-white"})})]})]})})})]})}function ai(e){let{onClick:t,text:s,icon:a}=e;return(0,n.jsxs)("div",{className:(0,f.Z)("flex items-center gap-2 rounded-md px-2.5 py-1.5","dark:hover:bg-cloud/25 transition hover:cursor-pointer hover:bg-slate-200","border-cloud/50 border"),onClick:t,children:[(0,n.jsx)("span",{className:"flex-1 text-left font-light text-neutral-600 outline-none focus:outline-none dark:text-white dark:placeholder:text-white",children:s}),a]})}function ao(){let{orgId:e}=(0,T.aC)(),t=(0,eS.F)(e=>{var t;return null===(t=e.selectedPlaybook)||void 0===t?void 0:t.id}),s=(0,eS.F)(e=>e.setSelectedPlaybook),a=(0,ej.aM)(),l=(0,ej.cZ)(),r=(0,N.useMemo)(()=>{var e,t;let s=new Set(null!==(t=l.data)&&void 0!==t?t:[]),n=[],r=[];return null===(e=a.data)||void 0===e||e.forEach(e=>{s.has(e.id)?n.push(e):r.push(e)}),[...n,...r]},[l,a.data]),i=(0,N.useMemo)(()=>[["Team",r.filter(t=>t.org_id===e)],["Community",r.filter(e=>"community"===e.access)]],[e,r]);return(0,n.jsx)(ar,{type:"playbook",groups:i,isLoading:a.isLoading||l.isLoading,selectedId:t,onSelect:e=>{s(e)},render:e=>(0,n.jsxs)("div",{className:"flex size-full max-h-full w-full flex-col",children:[(0,n.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-pacific mr-2 overflow-hidden text-ellipsis text-xl font-medium leading-none 2xl:text-2xl",children:e.title}),(0,n.jsx)(ab,{href:"/playbooks/".concat((0,ev.I0)(e.id))})]}),(0,n.jsx)(S.U,{className:"prose prose-sm prose-sleet prose-p:leading-5 prose-headings:mt-3 prose-headings:font-medium prose-p:mb-2 prose-headings:mb-2 dark:prose-invert prose-h2:text-[1rem] prose-h1:text-[1.1rem] prose-p:whitespace-pre-wrap prose-pre:whitespace-pre-wrap prose-strong:font-medium max-w-full flex-1 overflow-y-scroll !text-xs font-light 2xl:!text-sm",rehypePlugins:[[ex.Z,{target:"_blank"}]],children:e.body})]})})}function ad(){let e=(0,eS.F)(e=>e.selectedSnapshot.snapshot_id),t=(0,eS.F)(e=>e.setSelectedSnapshot),s=(0,eg.qN)(),a=(0,N.useMemo)(()=>{var e;return(null!==(e=s.data)&&void 0!==e?e:[]).map(e=>({title:e.snapshot_name,id:e.snapshot_id,...e}))},[s.data]);return(0,n.jsx)(ar,{type:"snapshot",groups:[["All",a]],isLoading:s.isLoading,selectedId:e,onSelect:e=>{t(null!=e?e:eS._)},render:e=>{var t;return(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-ray mb-3 mr-2 overflow-hidden text-ellipsis text-2xl  font-medium",children:e.snapshot_name}),(0,n.jsx)(ab,{href:"/snapshots/".concat((0,eC.I)(e.id))})]}),(0,n.jsx)("span",{className:"mb-2 text-lg font-medium dark:text-white",children:"Description"}),(0,n.jsx)("p",{className:"dark:text-sleet mb-4 whitespace-pre-wrap text-sm font-light",children:e.description||"No description"}),(0,n.jsxs)("div",{className:"dark:bg-cloud/25 h-full rounded-md bg-slate-200 p-3",children:[(0,n.jsxs)("div",{className:"mb-2 flex items-center gap-2 dark:text-white",children:[(0,n.jsx)("span",{className:"text-base font-medium",children:"Startup commands"}),(0,n.jsx)(sD.u,{content:(0,n.jsxs)("ul",{className:"text-xs",children:[(0,n.jsx)("li",{children:"1. Startup commands run in the home directory"}),(0,n.jsx)("li",{children:"2. They execute in the order listed"}),(0,n.jsx)("li",{children:"3. Each command has a 2 minute timeout"})]}),side:"top",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)(G.k,{weight:"bold",size:18})})]}),(0,n.jsx)("div",{className:"flex flex-col",children:e.startup_commands&&0!==e.startup_commands.length&&(null===(t=e.startup_commands)||void 0===t?void 0:t.at(-1))!==""?(0,n.jsx)("div",{className:"w-full flex-1 grow rounded-md",children:(0,n.jsx)("div",{className:"w-full rounded-md border border-neutral-300 dark:border-neutral-500",children:e.startup_commands.map((e,t)=>(0,n.jsx)("div",{className:"flex items-center gap-2 border-t border-neutral-300 px-2 py-2 first:border-0 dark:border-neutral-500",children:(0,n.jsx)("span",{className:"font-mono text-xs font-light",children:e})},t))})}):(0,n.jsx)("span",{className:"text-sm font-light",children:"No startup commands"})})]})]})}})}function ac(){let{isLoaded:e}=(0,T.aC)(),t=(0,eg.XU)().data,{data:s,isLoading:a}=(0,ej.aM)(),{data:l,isLoading:r}=(0,eg.qN)(),i=(0,y.useSearchParams)(),o=i.get("playbook"),d=i.get("snapshot"),c=(0,eS.F)(e=>e.setSelectedConfig),u=(0,eS.F)(e=>e.setSelectedPlaybook),m=(0,eS.F)(e=>e.setSelectedSnapshot),x=(0,eS.F)(e=>e.selectedPlaybook),[h,p]=(0,N.useState)(!1);(0,N.useEffect)(()=>{if(o){let e=null==s?void 0:s.find(e=>e.id==="playbook-".concat(o));e&&u(e)}},[o,s,u]),(0,N.useEffect)(()=>{if(d){let e=null==l?void 0:l.find(e=>e.snapshot_id==="snapshot-".concat(d));e&&m(e)}},[d,l,m]);let b=av(),[v,j]=(0,g.Z)({align:"start"}),[w,k]=(0,N.useState)(!0),[C,_]=(0,N.useState)(!0),S=(0,N.useCallback)(()=>{j&&j.scrollPrev()},[j]),E=(0,N.useCallback)(()=>{j&&j.scrollNext()},[j]),D=(0,N.useCallback)(e=>{k(!e.canScrollPrev()),_(!e.canScrollNext())},[]);return(0,N.useEffect)(()=>{j&&(D(j),j.on("reInit",D).on("select",D))},[j,D]),(0,N.useEffect)(()=>{if(!e||a||r||h)return;let n=null==t?void 0:t.default_shortcut;if(n&&!o&&!d&&!b){var i,u;c({configId:n.id,playbook:null!==(i=null==s?void 0:s.find(e=>e.id===n.playbook_id))&&void 0!==i?i:null,snapshot:null!==(u=null==l?void 0:l.find(e=>e.snapshot_id===n.snapshot_id))&&void 0!==u?u:eS._}),p(!0)}},[e,t,o,d,c,s,l,a,r,b,x,h]),(0,n.jsx)("div",{className:"absolute mr-0 flex h-full w-full flex-col justify-between gap-4 overflow-y-auto lg:pr-9",children:t?t.default_shortcut||t.recent_shortcut||t.shortcuts.length>0?(0,n.jsxs)("div",{className:"flex w-full flex-col items-center",children:[(0,n.jsx)("div",{className:"w-full overflow-hidden",ref:v,children:(0,n.jsxs)("div",{className:"-ml-4 flex",style:{touchAction:"pan-y pinch-zoom"},children:[t.default_shortcut&&(0,n.jsx)(ax,{shortcut:t.default_shortcut,highlight:"Default"},t.default_shortcut.title),t.recent_shortcut&&(0,n.jsx)(ax,{shortcut:t.recent_shortcut,highlight:"Recent"},t.recent_shortcut.title),t.shortcuts.map(e=>(0,n.jsx)(ax,{shortcut:e},e.title))]})}),(0,n.jsxs)("div",{className:"mt-5 flex gap-2",children:[(0,n.jsx)("button",{className:"dark:bg-night dark:hover:bg-extra-night disabled:dark:hover:bg-night rounded-full bg-slate-100 p-2 transition-colors hover:bg-slate-200 disabled:opacity-40 disabled:hover:bg-slate-100 dark:text-white",onClick:S,disabled:w,children:(0,n.jsx)($.W,{size:20})}),(0,n.jsx)("button",{className:"dark:bg-night dark:hover:bg-extra-night disabled:dark:hover:bg-night rounded-full bg-slate-100 p-2 transition-colors hover:bg-slate-200 disabled:opacity-40 disabled:hover:bg-slate-100 dark:text-white",onClick:E,disabled:C,children:(0,n.jsx)(X.T,{size:20})})]})]}):(0,n.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3",children:(0,n.jsxs)("div",{className:(0,f.Z)("dark:border-input-dark border:outline-cloud flex h-fit flex-col items-start gap-3 rounded-2xl border border-dashed border-neutral-400 px-4 py-4 text-left transition-colors dark:text-white"),children:[(0,n.jsx)("span",{children:"No shortcuts to show"}),(0,n.jsx)("span",{className:"text-cloud text-sm",children:"Select a snapshot or playbook and save them as a shortcut"})]})}):null})}let au=[{title:"Devin introduction",prompt:"Hello Devin! Could you provide an overview of your capabilities as well as a list of features available in the Devin web app?",icon:(0,n.jsx)(Q.G,{size:24})},{title:"Repository setup",prompt:"Set up https://github.com/civetweb/civetweb and get it running please",icon:(0,n.jsx)(ee.r,{size:24})},{title:"Java 7 to 8 upgrade",prompt:"Upgrade https://github.com/houbb/opencc4j from Java 7 to 8. Remember:\n- Install Java 8 Development Kit (JDK)\n- Update the project's build configuration to use Java 8. For Maven, update the `maven-compiler-plugin` configuration in `pom.xml`. For Gradle, update the `sourceCompatibility` and `targetCompatibility` in `build.gradle`\n-  Identify and replace deprecated Java 7 APIs with their Java 8 equivalents.\n- Analyze the codebase for potential Java 8 language and API enhancements\n    -  Consider using lambda expressions, method references, and streams where applicable\n    -   Evaluate the use of new Java 8 APIs such as `java.time` for date and time handling\n    -   Apply lambda expressions to simplify anonymous inner classes\n    -   Use method references to improve code readability\n    -    Leverage streams for more concise and expressive data process\n- Update unit tests to cover the refactored code and preserve existing functionality.\n- Run the test suite and verify that all tests pass successfully.\n- Build the project using the updated Java 8 configuration and verify that the application is up and running\n- When done, share the final code changes as a zipped folder\n- Include a REAME with instructions on how to set up and run the upgraded project",icon:(0,n.jsx)(et.M,{size:24})}];function am(e){let{suggestions:t}=e,{setInput:s}=(0,N.useContext)(ep.r);return(0,n.jsx)("div",{className:"mt-1 flex flex-col gap-4 px-0.5 md:flex-row",children:t.map(e=>(0,n.jsxs)("button",{className:"dark:bg-pacific/30 border-sleet flex items-center rounded-lg border bg-[#6096FF26] p-4 text-left transition enabled:hover:cursor-pointer md:h-[4rem] md:flex-1 lg:w-[16rem] dark:border-transparent",onClick:()=>{var t;return s(null!==(t=e.prompt)&&void 0!==t?t:e.title)},children:[(0,n.jsx)("div",{className:"flex items-center justify-center text-[#6096FF] dark:text-white",children:e.icon}),(0,n.jsx)("div",{className:"text-input-dark pl-2 text-sm font-normal dark:text-white",children:e.title})]},e.title))})}function ax(e){let{shortcut:t,highlight:s}=e,a=(0,ej.aM)().data,l=(0,eg.qN)().data,r=(0,h.NL)(),{userId:i,orgId:o}=(0,T.aC)(),d=ef(),c=(0,eS.F)(e=>e.setSelectedConfig),m=(0,eS.F)(e=>e.selectedConfigId),[x,p]=(0,N.useState)(!1),[f,g]=(0,N.useState)(t.title),b=(0,N.useMemo)(()=>null==a?void 0:a.find(e=>e.id===t.playbook_id),[a,t.playbook_id]),v=(0,N.useMemo)(()=>null==l?void 0:l.find(e=>e.snapshot_id===t.snapshot_id),[l,t.snapshot_id]),j=async e=>{try{await (0,e_.vB)(e),r.invalidateQueries({queryKey:["shortcuts",i,o]})}catch(e){console.error(e)}},w=async()=>{try{await (0,e_.Lh)(t.id),r.invalidateQueries({queryKey:["shortcuts",i,o]})}catch(e){console.error(e)}finally{p(!1)}},k=async()=>{try{await (0,e_.UA)(t.id,null!=f?f:"Untitled"),r.invalidateQueries({queryKey:["shortcuts",i,o]})}catch(e){console.error(e)}},y=()=>{m===t.id?c({configId:"",playbook:null,snapshot:eS._}):c({configId:t.id,playbook:null!=b?b:null,snapshot:null!=v?v:eS._})};return(0,n.jsx)(eo.E.button,{layout:!0,className:"flex items-start pl-4",style:{flex:"0 0 ".concat("base"===d?100:100/3,"%")},onClick:()=>y(),children:(0,n.jsxs)("div",{className:(0,eD.cn)("dark:border-input-dark dark:bg-shade focus:outline-cloud flex h-fit w-full min-w-0 max-w-full cursor-pointer flex-col items-start overflow-hidden rounded-2xl border p-3 text-left transition-colors lg:p-3.5 2xl:p-4",m===t.id?"dark:bg-input-dark bg-slate-100":"hover:bg-slate-50 dark:hover:bg-[#3b3b3b]",m&&m!==t.id&&"opacity-50"),children:[(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between  dark:text-white",children:[(0,n.jsx)("div",{className:"text-base font-medium !leading-tight 2xl:text-lg",children:t.title}),(0,n.jsx)("div",{className:"flex items-center align-top",children:(0,n.jsxs)(tV.Vq,{children:[(0,n.jsxs)(tV.cZ,{children:[(0,n.jsx)(tV.$N,{children:"Rename shortcut"}),(0,n.jsx)("div",{children:(0,n.jsx)("input",{placeholder:t.title,value:f,onChange:e=>g(e.target.value)})}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)(en.GG,{children:(0,n.jsx)("button",{onClick:k,children:"Save"})})})]}),(0,n.jsxs)(eh.h_,{children:[(0,n.jsx)(eh.$F,{asChild:!0,children:(0,n.jsx)("div",{className:"rounded-full p-0.5 transition-colors hover:bg-slate-200 dark:hover:bg-[#5b5b5b]",onClick:e=>e.stopPropagation(),children:(0,n.jsx)(es.F,{size:18})})}),(0,n.jsxs)(eh.AW,{side:"right",align:"start",alignOffset:-5,className:"dark:border-cloud dark:bg-input-dark bg-white",children:[(0,n.jsxs)(eh.Xi,{className:"pr-8 focus:bg-slate-50 dark:focus:bg-white/10",onClick:()=>j(t.id),children:[(0,n.jsx)(W.U,{size:16}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Default"===s?"Remove default":"Set default"})]}),(0,n.jsx)(en.hg,{asChild:!0,children:(0,n.jsxs)(eh.Xi,{className:"pr-8 focus:bg-slate-50 dark:focus:bg-white/10",children:[(0,n.jsx)(U.z,{size:16}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Rename"})]})}),(0,n.jsxs)(eh.Xi,{className:"pr-8 focus:bg-slate-50 dark:focus:bg-white/10",onClick:()=>p(!0),children:[(0,n.jsx)(H.r,{size:16}),(0,n.jsx)("span",{className:"ml-2 dark:text-white",children:"Delete"})]})]})]})]})})]}),s&&(0,n.jsx)("div",{className:"text-pacific text-xs font-light",children:s})]}),(0,n.jsxs)("div",{id:"Shortcut Choices",className:"mt-5 max-w-full space-y-[9px]",children:[b&&(0,n.jsxs)("div",{className:"flex items-start gap-2 text-xs font-light 2xl:text-[13px] dark:text-white",children:[(0,n.jsx)(Y.M,{className:"size-[1lh]"}),(0,n.jsx)("span",{className:"flex-1 truncate",children:b.title})]}),v&&v.snapshot_id!==eS._.snapshot_id&&(0,n.jsxs)("div",{className:"flex items-start gap-2 text-xs font-light 2xl:text-[13px] dark:text-white",children:[(0,n.jsx)(u.H,{className:"size-[1lh]"}),(0,n.jsx)("span",{className:"flex-1 truncate",children:v.snapshot_name})]})]}),(0,n.jsx)(su.T,{open:x,title:"Delete shortcut",description:"Are you sure you want to delete this shortcut?",onConfirm:w,onCancel:()=>p(!1)})]})})}function ah(){let{orgId:e}=(0,T.aC)(),{data:t,isLoading:s}=(0,eg.Yn)(e||""),a=(null!=t?t:[])[0],[l,r]=(0,N.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{disabled:s||!a,onClick:()=>r(!0),className:"dark:bg-input-dark disabled:dark:bg-input-dark flex items-center gap-2 rounded-md bg-slate-100 px-3.5 py-1.5 font-normal duration-100 hover:bg-slate-200 disabled:bg-slate-100 dark:text-white dark:hover:bg-[rgb(66,66,66)]",children:[(0,n.jsx)(ea.b,{}),(0,n.jsx)("span",{className:"text-xs font-light",children:s?"Loading...":a?(0,n.jsxs)(n.Fragment,{children:[a.gh_org," (",a.gh_repos.length,")"]}):null})]}),a&&(0,n.jsx)(ap,{data:a.gh_repos,open:l,onClose:()=>{r(!1)}})]})}function ap(e){let{data:t,open:s,onClose:a}=e;return(0,n.jsx)(tV.Vq,{open:s,onOpenChange:a,children:(0,n.jsxs)(tV.cZ,{className:"max-h-[70vh] overflow-auto outline-none sm:max-w-[525px]",children:[(0,n.jsx)(tV.fK,{children:(0,n.jsxs)(tV.$N,{className:"mb-1 text-xl tracking-tight",children:["Connected Repositories (",t.length,")"]})}),(0,n.jsx)("div",{className:"px-4",children:(0,n.jsx)("div",{className:"grid grid-cols-1 gap-2 text-sm text-gray-600 sm:grid-cols-2 dark:text-gray-400",children:t.map(e=>(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(el.g,{size:15}),(0,n.jsx)("span",{className:"truncate text-sm",children:e})]},e))})})]})})}function af(e){let{small:t,setSkipGithub:s,showMainConnect:a}=e,{userId:l,orgId:r}=(0,T.aC)();return a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ag,{small:t,onClick:()=>{window.location.href=(0,eF.Q)(l,r)}}),!t&&(0,n.jsx)("button",{className:"text-cloud text-sm underline underline-offset-2 outline-none transition-colors hover:text-neutral-700 focus:text-neutral-300 focus:outline-none dark:hover:text-neutral-300",onClick:()=>s({date:new Date,value:!0}),children:"Skip"})]}):null}function ag(e){let{small:t,onClick:s,disabled:a}=e;return(0,n.jsxs)("button",{onClick:s,disabled:a,className:(0,f.Z)("bg-pacific flex items-center rounded-md text-sm text-white transition hover:bg-blue-500",t?"px-3 py-1.5":"px-4 py-2"),children:[(0,n.jsx)(ea.b,{className:"mr-2",weight:"bold"}),t?"Connect":"Connect Devin to GitHub"]})}function ab(e){let{href:t}=e;return(0,n.jsx)(k.default,{href:t,className:"flex-shrink-0 rounded-md bg-slate-200  px-3.5 py-1.5 text-xs font-normal duration-100 hover:bg-slate-300  dark:bg-[#5a5a5a] dark:text-white dark:hover:bg-[rgb(66,66,66)]",children:"View in Library"})}let av=()=>{let e=(0,y.useSearchParams)();return(0,N.useMemo)(()=>e.get("from"),[e])};var aj=s(95107);let aw=e=>{let{className:t,onClick:s,collapsed:a,direction:l="left"}=e;return(0,n.jsx)("button",{onClick:s,className:(0,eD.cn)("group",t),children:(0,n.jsx)("span",{"data-state":"closed",children:(0,n.jsx)("div",{className:"flex h-[72px] w-8 items-center justify-center",children:(0,n.jsxs)("div",{className:"flex h-8 w-6 flex-col items-center",children:[(0,n.jsx)("div",{className:(0,eD.cn)("h-4 w-1 translate-y-[0.15rem] rounded-full bg-neutral-300 \n                transition duration-200",a&&"left"===l&&"group-hover:-rotate-[20deg] ",a&&"right"===l&&"group-hover:rotate-[20deg]",!a&&"left"===l&&"group-hover:rotate-[20deg]",!a&&"right"===l&&"group-hover:-rotate-[20deg]")}),(0,n.jsx)("div",{className:(0,eD.cn)("h-4 w-1 -translate-y-[0.15rem] rounded-full  bg-neutral-300 \n                transition duration-200",a&&"left"===l&&"group-hover:rotate-[20deg]",a&&"right"===l&&"group-hover:-rotate-[20deg]",!a&&"left"===l&&"group-hover:-rotate-[20deg]",!a&&"right"===l&&"group-hover:rotate-[20deg]")})]})})})})};s(41967);var ak=s(36186),ay=s(89588),aN=s(73090),aC=s(38242);let a_=!ay.t;var aS=s(58002),aE=s(59452),aD=s(11594),aT=s(24647),aF=s(46889),aM=s(21484),aA=s(83447),aO=s(70788),az=s(47256),aI=s(42556),aL=s(45785),aZ=s(16617),aP=s(25779),aR=s(63606),aK=s.n(aR),aU=s(81765),aV=s.n(aU);s(18305);var aH=s(48110),aW=s(30812),aq=s(15880),aB=s(92494);let aY="https://internal-attachment",aJ=e=>e.replace(/ATTACHMENT:(\{.*?\}(?=\sATTACHMENT:|\s*$)|"https?:\/\/[^\n]+")/g,(e,t)=>{if(t.startsWith("{")&&t.endsWith("}"))try{var s;let e=JSON.parse(t),a=(null===(s=e.metadata)||void 0===s?void 0:s.filename)||e.url.split("/").pop()||"";return"[".concat(a.replaceAll(/\u202F/g,""),"](").concat(aY).concat(encodeURIComponent((e.url||"").replaceAll(/\u202F/g,"")),")\n")}catch(e){console.error("Error parsing attachment JSON:",e)}else if(t.startsWith('"')&&t.endsWith('"')){let e=JSON.parse(t),s=e.split("/").pop(),a=s.replaceAll(/\u202F/g,"");return[".png",".jpeg",".jpg"].some(e=>s.endsWith(e))?"![".concat(a,"](").concat(encodeURI(e.replaceAll(/\u202F/g,"")),")\n"):"[".concat(a,"](").concat(aY).concat(encodeURI(e.replaceAll(/\u202F/g,"")),")\n")}return"Invalid Attachment"}),aG=e=>{let{href:t,children:s,node:a,...l}=e,r=t&&t.startsWith(aY),i=r?t.slice(aY.length):t;return(0,n.jsxs)("a",{href:i,...l,className:(0,f.Z)(r?"text-black dark:text-white":"text-pacific duration-150 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-500"),children:[r&&(0,n.jsx)(aB.$,{size:17,className:"mr-1 inline-block"}),s]})};var a$=s(29678),aX=s(40152),aQ=s(13660),a0=s(56224),a1=s(59177),a2=s(23304),a5=s(39029),a4=s(73308),a8=s(29484);async function a3(e){return await a8.L.get("human-mode/".concat(e.event_id)).json()}async function a6(e){return await a8.L.put("human-mode/".concat(e.event_id),{json:e}).json()}let a7=e=>{let{value:t,setValue:s,editing:a,setEditing:l}=e;return(0,n.jsxs)("div",{className:(0,f.Z)("prosegroup w-full rounded-sm bg-white px-1 py-1 opacity-90 dark:bg-[#222222]","p-5 text-black dark:text-white"),children:[a?(0,n.jsx)(a1.Z,{value:t,onChange:e=>s(e.target.value),className:"h-full w-full overflow-y-auto overflow-x-hidden bg-transparent outline-none",style:{resize:"none"},minRows:1,maxRows:20}):(0,n.jsx)("p",{children:t}),a?(0,n.jsxs)("button",{className:(0,f.Z)("absolute -bottom-4 right-2 flex flex-row items-center rounded-sm border border-neutral-400 px-1 text-sm opacity-0 group-hover:opacity-100","dark:bg-shade bg-white","cursor-pointer transition enabled:hover:brightness-110"),onClick:()=>l(!1),children:[(0,n.jsx)(a$.b,{size:18})," Stop Editing"]}):(0,n.jsxs)("button",{className:(0,f.Z)("absolute -bottom-4 right-2 flex flex-row items-center rounded-sm border border-neutral-400 px-1 text-sm opacity-0 group-hover:opacity-100","dark:bg-shade bg-white","cursor-pointer transition enabled:hover:brightness-110"),onClick:()=>l(!0),children:[(0,n.jsx)(U.z,{size:18})," Edit"]})]})},a9=e=>{let{tags:t,addNewTag:s,removeTag:a}=e,[l,r]=(0,N.useState)(!0),[i,o]=(0,N.useState)("");function d(){""!==i.trim()&&s&&(s(i.trim()),o("")),r(!1)}return(0,n.jsx)("div",{className:"relative max-w-full justify-between lg:flex lg:flex-row lg:gap-2",children:(0,n.jsxs)("div",{className:"flex w-full min-w-0 flex-1 flex-row flex-wrap items-center gap-2",children:[t.map((e,t)=>(0,n.jsxs)("div",{className:(0,f.Z)("whitespace-nowrap rounded-sm border bg-neutral-400 bg-opacity-20 p-1 px-2 text-xs text-neutral-500 outline-none","bg-slate-100 dark:bg-[#484848] dark:text-slate-300","flex items-center justify-between"),children:[(0,n.jsx)("span",{children:e}),a&&(0,n.jsx)("button",{onClick:()=>a(e),className:"ml-2 text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-200",children:(0,n.jsx)(eX.X,{size:12})})]},t)),s&&!l&&(0,n.jsx)("button",{className:"ml-2 rounded-sm bg-[#a0a1a3] p-1 text-[#212529] hover:bg-[#8a8c8e]",onClick:()=>{r(!0),o("")},children:(0,n.jsx)(e5.v,{size:14})}),s&&l&&(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"text",className:"mr-2 rounded-sm border border-neutral-300 bg-white px-2 py-1 text-xs text-neutral-700 outline-none dark:border-neutral-600 dark:bg-neutral-800 dark:text-neutral-300",placeholder:"Add new tag",onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"===e.key&&d()},autoFocus:!0}),(0,n.jsx)("button",{className:"rounded-sm bg-[#a0a1a3] p-1 text-[#212529] hover:bg-[#8a8c8e] hover:bg-green-600",onClick:d,children:(0,n.jsx)(J.J,{size:14})})]})]})})},le=e=>{let{event:t,emitHumanModeUserResponse:s}=e,a=t.original_response,[l,r]=(0,N.useState)(a),[i,o]=(0,N.useState)(null),[c,u]=(0,N.useState)(""),[m,x]=(0,N.useState)(null),[h,p]=(0,N.useState)(!1),[g,b]=(0,N.useState)(!1),[v,{add:j,remove:w}]=(0,a2.Z)(new Set(JSON.parse(localStorage.getItem("humanModeQueryTags")||"[]"))),[k,y]=(0,N.useState)(!1),C=(0,n.jsx)("button",{className:(0,f.Z)("flex flex-row items-center rounded-sm px-2 py-2 text-center transition md:py-1",!h&&"bg-green-600 text-white enabled:hover:bg-green-700",h&&"bg-neutral-400 bg-opacity-10 text-neutral-400"),onClick:function(){let e=function(){if(!localStorage.author){let e=window.prompt("Please enter your name:","Not Steven");e&&localStorage.setItem("author",e)}return localStorage.author}();p(!0),l.trim()===a.trim()?s({type:"human_mode_user_response",user_choice:"confirm",query_label:t.query_label,original_query_oid:t.original_query_oid,original_model:t.original_model,correct_response:null,regeneration_response:null,regeneration_playground_url:null,author:e,hint:null,tags:Array.from(v)}):s({type:"human_mode_user_response",user_choice:"overwrite",query_label:t.query_label,original_query_oid:t.original_query_oid,original_model:t.original_model,correct_response:l,regeneration_response:i,regeneration_playground_url:m,author:e,hint:c,tags:Array.from(v)}),p(!1),localStorage.setItem("humanModeQueryTags",JSON.stringify(Array.from(v)))},disabled:h||""!==c&&!k,children:h?(0,n.jsx)(d.U,{size:18,className:"animate-spin"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"m-0 p-0",children:l===a?"Confirm":"Overwrite"}),(0,n.jsx)(J.J,{size:18,className:"ml-1"})]})});return(0,n.jsx)(ed.M,{children:(0,n.jsx)(eo.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,filter:"blur(10px) red(1)"},children:(0,n.jsxs)("div",{className:(0,f.Z)("progress-update","group relative mb-8 mt-4 flex w-full flex-col items-start justify-start whitespace-pre-wrap text-sm leading-7 lg:pl-14"),children:[(0,n.jsxs)("div",{className:"dark:bg-shade sticky -top-1 w-full bg-white pt-1",children:[(0,n.jsxs)("div",{className:"mb-2 flex w-full flex-row items-center gap-2 lg:items-baseline dark:text-white",children:[(0,n.jsx)("div",{className:(0,f.Z)("mt-[5px] shrink-0 lg:absolute lg:-left-14","flex h-8 w-8 items-center justify-center rounded-md"),children:(0,n.jsx)(a5.Z,{size:40})}),(0,n.jsxs)("span",{className:"mr-auto text-sm font-semibold",children:["Devin proposes the following response for ",t.query_label,":"]}),t.wdw_url&&(0,n.jsxs)("a",{className:"mr-2 flex cursor-pointer flex-row items-center gap-1 text-[#888888] underline",href:t.wdw_url,target:"_blank",children:["Fix on WDW",(0,n.jsx)(aX.O,{size:18,className:"translate-y-[-1px]"})]}),(0,n.jsxs)("a",{className:"ml-auto mr-2 flex cursor-pointer flex-row items-center gap-1 text-sm text-[#888888] underline",href:t.original_query_playground_url,target:"_blank",children:["Playground URL",(0,n.jsx)(aX.O,{size:18,className:"translate-y-[-1px]"})]})]}),(0,n.jsxs)("div",{className:"relative my-2 max-w-full justify-between lg:flex lg:flex-row lg:gap-2",children:[(0,n.jsx)("div",{className:"flex w-full min-w-0 flex-1 flex-row items-center gap-2",children:(0,n.jsx)("input",{className:(0,f.Z)("w-full whitespace-nowrap rounded-sm border bg-neutral-400 bg-opacity-20 p-2 px-2 text-xs text-neutral-500 outline-none","bg-slate-100 dark:bg-[#484848] dark:text-slate-300"),value:c,placeholder:"Feedback, e.g. set up virtual environment before pip install",onChange:e=>{u(e.target.value),y(!1)}})}),(0,n.jsxs)("div",{className:(0,f.Z)("ml-auto gap-2","mt-2 grid grid-cols-12","lg:mt-0 lg:flex lg:flex-row"),children:[(0,n.jsx)("button",{className:(0,f.Z)("flex flex-row items-center rounded-sm bg-[#d8d9db] px-2 py-2 text-center text-[#212529] transition hover:bg-[#babec1] active:bg-[#95999d] md:py-1","col-span-6",h&&"bg-neutral-400 bg-opacity-10 text-neutral-400",c&&"bg-[#3784EB] text-white hover:bg-[#2b6bc5]"),onClick:function(){p(!0),(0,e_.xc)(c,t.original_query_oid,"unknown"===t.original_model?"gpt-4o-2024-08-06":t.original_model).then(e=>{p(!1),r(e.response),o(e.response),x(e.playgroundUrl),y(!0)})},disabled:h,children:h?(0,n.jsx)(d.U,{size:18,className:"animate-spin"}):(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)("span",{children:"Regenerate"}),(0,n.jsx)(az.d,{size:18,className:"ml-2"})]})}),C]})]}),(0,n.jsx)("div",{className:"mb-2 text-sm font-semibold text-neutral-700 dark:text-neutral-300",children:"Tags"}),(0,n.jsx)("div",{className:"mb-3",children:(0,n.jsx)(a9,{tags:Array.from(v),addNewTag:j,removeTag:w})})]}),a&&(0,n.jsx)(a7,{value:l,setValue:r,editing:g,setEditing:b})]})},"content")})},lt=e=>{let{event:t,emitRestoreToCheckpoint:s}=e,{data:a,isLoading:l}=(0,p.a)({queryKey:["humanModeInput",t.event_id],queryFn:()=>a3(t),enabled:!!t.event_id,retry:10}),{mutate:r}=(0,a4.Z)({queryKey:["humanModeInput",t.event_id],mutationFn:a6,updateStore:(e,t)=>({...e,disabled:t.disabled,tags:t.tags})}),{devinState:i,timelineActions:{exitReplayMode:o,selectAlternateTimeline:c}}=(0,D.j1)(),u=i.humanModeQueryOidToLastCheckpoint.get(t.original_query_oid),x=t.correct_response,[h,g]=(0,N.useState)(!1),b=(0,N.useMemo)(()=>{var e;return null!==(e=null==a?void 0:a.disabled)&&void 0!==e&&e},[null==a?void 0:a.disabled]),v=(0,N.useMemo)(()=>{var e,s;return null!==(s=null!==(e=null==a?void 0:a.tags)&&void 0!==e?e:t.tags)&&void 0!==s?s:[]},[null==a?void 0:a.tags,t.tags]),j=(0,N.useCallback)(e=>{r({disabled:e,event_id:t.event_id,tags:v})},[t,r,v]),w=(0,N.useCallback)(e=>{r({event_id:t.event_id,tags:[...v,e],disabled:b})},[t,v,r,b]),k=(0,N.useCallback)(e=>{r({event_id:t.event_id,tags:v.filter(t=>t!==e),disabled:b})},[t,v,r,b]),y=(0,N.useMemo)(()=>{let e=h?B.p:X.T;return(0,n.jsx)("span",{className:"flex cursor-pointer items-center",onClick:()=>g(!h),children:(0,n.jsx)(e,{size:16,className:"mr-1"})})},[h]),C=(0,N.useMemo)(()=>t.correct_command?t.correct_command.replaceAll("\n","").slice(0,100):t.query_label?t.query_label:"Unknown query label",[t.correct_command,t.query_label]);return(0,n.jsxs)(ed.M,{children:[(0,n.jsxs)("div",{className:(0,f.Z)("group relative flex min-w-full items-start justify-start whitespace-pre-wrap leading-7 text-[#888888] dark:text-neutral-400","px-2 sm:pl-0 sm:pr-8"),children:[(0,n.jsx)("div",{className:"w-16"}),(0,n.jsxs)("div",{className:"flex w-full flex-row justify-between",children:[(0,n.jsxs)("div",{className:"flex flex-grow cursor-pointer flex-row",onClick:()=>g(!h),children:[(0,n.jsx)(aQ.H,{size:18,className:"m-w-8 mr-2 mt-[5px] max-w-8 shrink-0"}),(0,n.jsx)("p",{className:"flex-1 space-y-2 sm:max-w-full",style:{overflowWrap:"break-word",wordBreak:"break-word"},children:C})]}),(0,n.jsxs)("div",{className:"flex flex-row items-center",children:[t.regeneration_playground_url&&(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"View in playground"}),side:"top",className:"px-1 py-1",delayDuration:200,children:(0,n.jsx)("a",{href:t.regeneration_playground_url,target:"_blank",rel:"noopener noreferrer",className:"text-[#888888] hover:text-[#6096FF]",children:(0,n.jsx)(m.r,{size:18})})}),u&&(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Undo action"}),side:"top",className:"px-2 py-1",delayDuration:200,children:(0,n.jsx)("span",{className:"flex cursor-pointer items-center",onClick:()=>void(s(u.checkpoint_id,{plan:"",currentStep:""}),o(),c(-1)),children:(0,n.jsx)(a0.D,{size:18,className:"mx-1 text-[#888888]"})})}),t.user_choice&&(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"confirm"===t.user_choice?"Confirmed":"Overwritten Response"}),side:"top",className:"px-2 py-1",delayDuration:200,children:"confirm"===t.user_choice?(0,n.jsx)(J.J,{size:18,className:"text-[#888888]"}):(0,n.jsx)(U.z,{size:18,className:"text-[#888888]"})}),y]})]})]},"accepted"),h&&(0,n.jsx)(eo.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,filter:"blur(10px) red(1)"},children:(0,n.jsxs)("div",{className:(0,f.Z)("progress-update","group relative mb-8 mt-4 flex w-full flex-col items-start justify-start whitespace-pre-wrap text-sm leading-7 lg:pl-14"),children:[(0,n.jsxs)("div",{className:"mb-2 flex w-full items-center justify-between pr-8",children:[(0,n.jsx)(a9,{tags:v,addNewTag:w,removeTag:k}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"mr-2 text-black dark:text-white",children:"Disabled"}),l?(0,n.jsx)("div",{className:"h-[20px] w-[20px] text-[#6096FF]",children:(0,n.jsx)(d.U,{size:18,weight:"bold",className:"animate-spin"})}):(0,n.jsx)(ss.r,{checked:b,onCheckedChange:j})]})]}),x&&(0,n.jsx)("div",{className:(0,f.Z)("prosegroup w-full rounded-sm bg-white px-1 py-1 opacity-90 dark:bg-[#222222]","p-5 text-black dark:text-white"),children:(0,n.jsx)("p",{children:x})})]})},"content")]})};var ls=s(18594),la=s(83059),ll=s(48536),ln=s(11360);let lr=e=>{let t=(0,b.b9)(aC.kJ),[s,a]=(0,N.useState)(null),l=Object.keys(s||{}).length>0,{data:n}=(0,eg.YO)(e);return(0,N.useEffect)(()=>{e&&n&&a(n)},[e,n]),{snapshotUsed:s,wasSnapshotAlreadyTaken:l,openSnapshotDialog:()=>{e&&!l&&(t5.Z.trackInteraction(t5.j.CREATE_SNAPSHOT),t(!0))}}};var li=s(99010),lo=s(67868);let ld=e=>{let{showHiddenContents:t,hiddenContents:s}=e;return(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("div",{className:"text-night dark:bg-night w-fit rounded-md border border-neutral-200 bg-gray-100 p-1 dark:border-zinc-800 dark:text-neutral-400",style:{wordBreak:"break-word"},children:t?s:(0,n.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,n.jsx)(lo.$,{}),(0,n.jsx)("span",{className:"cursor-default ",children:"Credentials hidden"})]})})})};var lc=s(61531),lu=s(73682);s(24606);var lm=e=>{var t;let{majorActions:s,isSmallerMobile:a=!1,onTerminalIconClick:l,onEditorIconClick:r,handleRestoreCheckpoint:i,disableRestoreCheckpoint:d}=e,{userId:c}=(0,T.aC)();if(!s)return null;let u=null===(t=s.noteId)||void 0===t?void 0:t.split("note-",2),m=u?u.length>1?u[1]:u[0]:null,x=(e,t,s,a)=>e?(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:t}),side:"top",className:"px-2 py-1",delayDuration:50,children:(0,n.jsx)("div",{className:(0,f.Z)("cursor-pointer duration-150","px-[0.125rem]","dark:bg-shade bg-white text-black dark:text-white","text-opacity-40 hover:text-opacity-100","dark:text-opacity-40 dark:hover:text-opacity-100"),onClick:a,children:s})}):null;return(0,n.jsxs)(n.Fragment,{children:[x(null==s?void 0:s.shellTimestamp,"View shell updates",(0,n.jsx)(lc.w,{size:a?14:17}),e=>{e.stopPropagation(),t5.Z.trackInteraction(t5.j.CHAT_HISTORY_VIEW_SHELL_UPDATES),l({e,timestampMs:s.shellTimestamp})}),x(null==s?void 0:s.editorTimestamp,"View code updates",(0,n.jsx)(o.Q,{size:a?14:17}),e=>{e.stopPropagation(),t5.Z.trackInteraction(t5.j.CHAT_HISTORY_VIEW_CODE_UPDATES),r({e,timestampMs:null==s?void 0:s.editorTimestamp})}),x(m,"View knowledge",(0,n.jsx)(aO.p,{size:a?14:17}),e=>{e.stopPropagation(),t5.Z.trackInteraction(t5.j.VIEW_KNOWLEDGE_EVENT);let t="/knowledge/".concat(m);window.open(t,"_blank")}),c&&x(!d&&!m,"Reset the session before this message",(0,n.jsx)(lu.y,{size:a?12:17}),e=>{e.stopPropagation(),i()})]})},lx=s(80736),lh=s(22706),lp=s(30883),lf=s.n(lp),lg=s(87553);let lb=e=>{let{lines:t}=e,[s,a]=(0,N.useState)(!1);return s?(0,n.jsxs)("p",{children:[(0,n.jsxs)("span",{className:" cursor-pointer rounded-sm bg-neutral-400 bg-opacity-20 px-1",onClick:()=>a(!1),children:["Hide ",t.length," lines"]}),t.map((e,t)=>(0,n.jsxs)("p",{className:"border-l border-neutral-400 border-opacity-50 pl-1",children:[e,(0,n.jsx)("br",{})]},t))]}):(0,n.jsx)("p",{children:(0,n.jsxs)("span",{className:" cursor-pointer rounded-sm bg-neutral-400 bg-opacity-20 px-1",onClick:()=>a(!0),children:["Show ",t.length," more lines"]})})},lv=e=>{let{knowledgeData:t,editing:s,onEdit:a,updateNewValue:l}=e,r=t.body,[i,o]=(0,N.useState)("update"===r.update.type?r.update.new_value:r.update.value),d=new(lf()),c="update"===r.update.type?d.diff_main(r.update.original_value,i):d.diff_main("",i);d.diff_cleanupSemantic(c);let u=(0,N.useCallback)(e=>{o(e),l(e)},[l]);return(0,n.jsxs)("div",{className:(0,f.Z)("group w-full overflow-x-scroll bg-neutral-400 bg-opacity-10 px-1 py-1","text-neutral-500 dark:text-neutral-400"),children:[s?(0,n.jsx)(a1.Z,{value:i,onChange:e=>u(e.target.value),className:"max-h-144 w-full overflow-hidden bg-transparent outline-none",style:{resize:"none"},minRows:1,maxRows:20}):c.map((e,t)=>{if(e[0]===lf().DIFF_EQUAL){let s=e[1].split("\n"),a=t>0?2:0,l=t<c.length-1?2:0;if(s.length>a+l+2)return(0,n.jsxs)("span",{className:" text-neutral-500 dark:text-neutral-400",children:[a>0&&(0,n.jsxs)("span",{className:"",children:[s.slice(0,a).join("\n"),(0,n.jsx)("br",{})]}),(0,n.jsx)("p",{className:"-ml-1",children:(0,n.jsx)(lb,{lines:s.slice(a,s.length-l)})}),l>0&&(0,n.jsx)("span",{className:"",children:s.slice(s.length-l).join("\n")})]},t)}return(0,n.jsx)("span",{className:(0,f.Z)(e[0]===lf().DIFF_DELETE?"text-red-600 line-through dark:text-red-300":"",e[0]===lf().DIFF_INSERT?"text-green-600 dark:text-green-300":""),children:e[1]},t)}),!s&&(0,n.jsxs)("button",{className:(0,f.Z)("absolute -bottom-4 right-2 flex flex-row items-center rounded-sm border border-neutral-400 px-1 text-sm opacity-0 group-hover:opacity-100","dark:bg-shade bg-white","cursor-pointer transition enabled:hover:brightness-110"),onClick:a,children:[(0,n.jsx)(U.z,{size:18})," Edit"]})]})};var lj=e=>{var t;let{event:s,accept:a,reject:l,r}=e,i=(0,y.useRouter)(),o=(0,ls.gm)(e=>e.getKnowledgeSuggestion(s.event_id)),c=(0,ls.gm)(e=>e.editKnowledgeSuggestion),u=null==o?void 0:o.status,m=null==o?void 0:o.merge_conflict,x=null==o?void 0:o.trigger_description,[h,p]=(0,N.useState)(!1),[g,b]=(0,N.useState)(!1),[v,j]=N.useState(!1),[w,k]=(0,N.useState)(void 0),[C,_]=(0,N.useState)(!1),[S,E]=(0,N.useState)(""),D=(0,N.useRef)(),T=(0,N.useCallback)(e=>{b(!0),D.current&&clearTimeout(D.current);let t=setTimeout(()=>{c(s.event_id,e).then(()=>{D.current===t&&(b(!1),D.current=void 0)})},400);D.current=t},[b,c]);(0,N.useEffect)(()=>{"create"===s.update.type&&k(s.update.trigger)},[s.update]);let F="update"==s.update.type?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"whitespace-nowrap text-neutral-400",children:"Update:"}),void 0!==x&&(0,n.jsx)(tp.P,{className:"min-w-0 flex-1",placeholder:"Select knowledge trigger",itemsList:[{value:x,label:x}],defaultValue:x,onValueChange:()=>{}})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"whitespace-nowrap text-neutral-400",children:"Use when:"}),(0,n.jsx)("input",{className:(0,f.Z)("w-full whitespace-nowrap rounded-sm bg-neutral-400 bg-opacity-20 px-2 text-xs text-neutral-400 outline-none","bg-slate-100 dark:bg-[#484848] dark:text-slate-300"),value:w,placeholder:"e.g. updating database schemas in the monorepo",onChange:e=>k(e.target.value)})]}),M=h?(0,n.jsx)("span",{className:"ml-2 cursor-pointer underline",onClick:()=>p(!1),children:"Hide"}):(0,n.jsx)("span",{className:"ml-2 cursor-pointer underline",onClick:()=>p(!0),children:"View"});if(void 0===u)return(0,n.jsx)(n.Fragment,{});let A="accepted"===u?(0,n.jsxs)("div",{className:(0,f.Z)("group relative flex min-w-full items-start justify-start whitespace-pre-wrap leading-7 text-[#888888] dark:text-neutral-400","px-2 sm:pl-0 sm:pr-8"),children:[(0,n.jsx)("div",{className:"w-16"}),(0,n.jsxs)("div",{className:"flex w-full flex-row",children:[(0,n.jsx)(lx.u,{size:18,className:"m-w-8 mr-2 mt-[5px] max-w-8 shrink-0"}),(0,n.jsxs)("p",{className:"flex-1 space-y-2 sm:max-w-full",style:{overflowWrap:"break-word",wordBreak:"break-word"},children:["Approved New Knowledge: ",x,M]})]}),(0,n.jsx)("div",{className:(0,f.Z)("progress-update-caret align-start absolute right-4 mt-[6.5px] flex items-center text-black dark:text-white","opacity-0 duration-300 group-hover:opacity-100"),children:(0,n.jsx)(lm,{majorActions:{noteId:null==o?void 0:null===(t=o.target)||void 0===t?void 0:t.knowledge_id},isSmallerMobile:!1,onTerminalIconClick:()=>{},onEditorIconClick:()=>{},handleRestoreCheckpoint:()=>{},disableRestoreCheckpoint:!0})})]},"accepted"):"rejected"===u?(0,n.jsxs)("div",{className:(0,f.Z)("group flex min-w-full items-start justify-start whitespace-pre-wrap leading-7 text-[#888888] dark:text-neutral-400","px-2 sm:px-0"),children:[(0,n.jsx)("div",{className:"w-16"}),(0,n.jsxs)("div",{className:"flex w-full flex-row",children:[(0,n.jsx)(eX.X,{size:18,className:"m-w-8 mr-2 mt-[5px] max-w-8 shrink-0"}),(0,n.jsxs)("p",{className:"flex-1 space-y-2 sm:max-w-full",style:{overflowWrap:"break-word",wordBreak:"break-word"},children:["Rejected Knowledge: ",x,M]})]})]},"rejected"):null,O=(0,n.jsx)("button",{className:(0,f.Z)("rounded-sm px-2 py-2 text-center transition md:py-1",!1===m&&!g&&"bg-[#6096FF] text-white enabled:hover:bg-blue-500",void 0===m&&"bg-neutral-400 bg-opacity-10 text-neutral-400",!0===m&&"bg-red-400 text-white","col-span-6",!1===m&&g&&"bg-neutral-400 bg-opacity-10 text-neutral-400"),onClick:()=>E("accept"),disabled:!1!==m||g,children:!1!==m||g?!0===m?(0,n.jsx)(sD.u,{content:(0,n.jsxs)("p",{className:"p-1 text-center text-xs",children:["There is a conflict with another change to the knowledge.",(0,n.jsx)("br",{}),"The update must be made manually."]}),delayDuration:50,side:"top",children:(0,n.jsx)(lh.v,{size:18,className:"mx-auto"})}):(0,n.jsx)(d.U,{size:18,className:"animate-spin"}):(0,n.jsx)(J.J,{size:18,className:"mx-auto"})});return(0,n.jsxs)(ed.M,{children:[A?(0,n.jsx)("div",{children:A},"acceptOrReject"):null,(0,n.jsx)("div",{className:"z-100 pointer-events-none absolute left-[50%] top-[50%]",children:(0,n.jsx)(lg.Z,{config:{angle:90,spread:360,startVelocity:40,elementCount:70,dragFriction:.12,duration:3e3,stagger:3,width:"10px",height:"10px",colors:["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a"]},active:v})}),(!A||h)&&(0,n.jsx)(eo.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,filter:"blur(10px) red(1)"},children:(0,n.jsxs)("div",{ref:r,className:(0,f.Z)("progress-update","group relative mb-8 mt-4 flex w-full flex-col items-start justify-start whitespace-pre-wrap text-sm leading-7 lg:pl-14"),children:[!A&&(0,n.jsxs)("div",{className:"dark:bg-shade sticky -top-1 w-full bg-white pt-1",children:[(0,n.jsxs)("div",{className:(0,f.Z)("flex w-full flex-row items-center gap-2 lg:items-baseline dark:text-white"),children:[(0,n.jsx)("div",{className:(0,f.Z)("mt-[5px] shrink-0 lg:absolute lg:-left-14","flex h-10 w-10 items-center justify-center rounded-md bg-[#6096FF]"),children:(0,n.jsx)(aP.v,{size:18})}),(0,n.jsxs)("span",{children:["create"==s.update.type?"Add":"Update"," Knowledge"]}),(0,n.jsxs)("span",{className:"flex cursor-pointer flex-row items-center gap-1 text-[#888888] underline",onClick:()=>{i.push("/knowledge")},children:["All Knowledge",(0,n.jsx)(aX.O,{size:18,className:"translate-y-[-1px]"})]})]}),(0,n.jsx)("div",{className:"mb-2 dark:text-neutral-300",children:(0,n.jsx)("span",{children:"Would you like Devin to remember this?"})}),(0,n.jsx)("div",{className:"relative my-2 max-w-full justify-between lg:flex lg:flex-row lg:gap-2",children:S?(0,n.jsxs)("div",{className:"flex w-full flex-row items-center gap-2 dark:text-white",children:[(0,n.jsx)("span",{children:"Are you sure?"}),(0,n.jsx)("button",{className:(0,f.Z)("nowrap flex h-full flex-1 items-center justify-center gap-2 rounded-sm border px-2 py-2 text-xs transition md:py-1","text-slate-400 transition md:py-1","dark:border-neutral-300 dark:text-neutral-300 dark:enabled:hover:border-neutral-200 dark:enabled:hover:text-neutral-200"),onClick:()=>E(""),disabled:g,children:"Cancel"}),(0,n.jsxs)("button",{className:(0,f.Z)("nowrap flex h-full flex-1 items-center justify-center gap-2 rounded-sm px-2 py-2 text-xs transition","reject"==S?"bg-slate-100 text-slate-400 enabled:hover:bg-slate-200 dark:bg-neutral-400 dark:text-white dark:enabled:hover:bg-neutral-500":"bg-[#6096FF] text-white enabled:hover:bg-blue-500"),disabled:g,onClick:()=>{let e;b(!0),"accept"==S?(t5.Z.trackInteraction(t5.j.ACCEPT_KNOWLEDGE_SUGGESTION),e=a(w).then(()=>{j(!0),setTimeout(()=>{j(!1)},500)})):(t5.Z.trackInteraction(t5.j.REJECT_KNOWLEDGE_SUGGESTION),e=l()),e.finally(()=>{b(!1)})},children:[g?(0,n.jsx)(d.U,{size:18,className:"animate-spin"}):"accept"==S?(0,n.jsx)(J.J,{size:18,className:""}):(0,n.jsx)(H.r,{size:18,className:""})," ","accept"==S?"Accept":"Reject"]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex w-full min-w-0 flex-1 flex-row gap-2",children:F}),(0,n.jsxs)("div",{className:(0,f.Z)("ml-auto gap-2","mt-2 grid grid-cols-12","lg:mt-0 lg:flex lg:flex-row"),children:[(0,n.jsx)("button",{className:(0,f.Z)("rounded-sm px-2 py-2 text-center transition md:py-1",!g&&["bg-slate-100 text-slate-400 enabled:hover:bg-slate-200","dark:bg-neutral-400 dark:text-white dark:enabled:hover:bg-neutral-500"],"col-span-6",g&&"bg-neutral-400 bg-opacity-10 text-neutral-400"),onClick:()=>E("reject"),disabled:g,children:g?(0,n.jsx)(d.U,{size:18,className:"animate-spin"}):(0,n.jsx)(H.r,{size:18,className:"mx-auto"})}),O]})]})}),(0,n.jsx)("hr",{className:"w-full border-neutral-400"})]}),o&&(0,n.jsx)(lv,{knowledgeData:o,editing:!h&&C,onEdit:()=>{t5.Z.trackInteraction(t5.j.EDIT_KNOWLEDGE_SUGGESTION),_(!0)},updateNewValue:T}),(0,n.jsx)("hr",{className:"w-full border-neutral-400"})]})},"content")]})};function lw(){let e=document.querySelector(".message-history--item.highlighted");e&&(e.classList.remove("flash"),requestAnimationFrame(()=>{e.classList.add("flash")}))}function lk(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"smooth",t=document.querySelector(".message-history--item.highlighted");t&&requestAnimationFrame(()=>{(0,aq.Z)(t,{block:"start",behavior:e,scrollMode:"if-needed"})})}let ly=()=>{let e=(0,y.useSearchParams)();return(0,N.useCallback)((t,s)=>{let a=new URLSearchParams(e.toString());a.set(t,s),window.history.pushState(null,"","?".concat(a.toString()))},[e])};function lN(e){let{devin:t,isDemoMode:s,isExample:a,emitUpdateMasterPlan:l,emitHumanModeUserResponse:r,emitRestoreToCheckpoint:i}=e,{userId:o}=(0,T.aC)(),{devinState:{messageHistoryEvents:d,status:c,masterPlan:m},timelineState:{currentTimestamp:x,allEvents:h},timelineActions:{setTimestamp:p,selectAlternateTimeline:g}}=(0,D.j1)(),v=(0,y.useSearchParams)(),j="undefined"!=typeof document&&document.body.clientWidth>1280,w=N.useRef(null),k=N.useRef(null),C=(0,N.useRef)(!1),[_,S]=(0,N.useState)(!1),[E,M]=(0,N.useState)(!1),[,A]=(0,b.KO)(aC.R_),O=(0,N.useRef)(x);(0,N.useEffect)(()=>{O.current=x},[x]),(0,N.useEffect)(()=>{let e=v.get("ts");if(e){let t=new Date(+e).getTime();isNaN(t)||t===O.current||p(t,!0)}},[v,p]),(0,N.useEffect)(()=>{d&&d.length||M(!1);let e=d[d.length-1];M((null==e?void 0:e.type)==="user_message")},[d]);let[z,I]=(0,N.useState)(!1),L=(0,N.useCallback)(()=>{I(e=>!e)},[]),Z=()=>{k.current&&(0,aq.Z)(k.current,{behavior:"smooth"})},[P,R]=(0,b.KO)(aC.kj),K=m.plan&&!!o,{filteredMessageHistoryEvents:V}=(0,N.useMemo)(()=>{let e=d.filter(e=>(0,tx.wj)(e)).map(e=>e.original_query_oid),t=d.filter(t=>!(0,tx.qQ)(t)||!e.includes(t.original_query_oid)),s="";return{filteredMessageHistoryEvents:t.filter(e=>{if((0,tx.LQ)(e)){var t;let a=null===(t=e.step.match(/(\d+|(DONE))\. ?/))||void 0===t?void 0:t[1];return!!a&&a!==s&&(s=a,!0)}return!0})}},[d]),H=(0,N.useMemo)(()=>V.filter(e=>(0,tx.KJ)(e)||(0,tx.wZ)(e)||(0,tx.Hz)(e)||(0,tx.yw)(e)||(0,tx.VT)(e)||(0,tx.tO)(e)||(0,tx.ed)(e)||(0,tx.qQ)(e)||(0,tx.Fo)(e)),[V]),W=(0,ls.gm)(e=>e.knowledgeSuggestions),q=(0,N.useRef)({}),B=(0,ls.gm)(e=>e.finalizeKnowledgeSuggestion),Y=(0,N.useCallback)((e,t)=>B(e,"accepted",t),[B]),J=(0,N.useCallback)(e=>B(e,"rejected",void 0),[B]),G=(0,N.useMemo)(()=>H.findLastIndex(e=>e.timestampMs<=x),[H,x]);(0,N.useLayoutEffect)(()=>{let e=w.current;e&&S(!(e.scrollHeight-e.scrollTop<=e.clientHeight+5))},[z]),(0,aH.Z)(()=>{E&&j&&Z()},[E,j]),(0,N.useEffect)(()=>{if(-1===G)return;let e=Array.from(document.querySelectorAll(".message-history--item")),t=e[G];!(!t||t.classList.contains("highlighted"))&&(e.forEach((e,t)=>{t!==G&&e.classList.remove("highlighted")}),s||!t||t.classList.contains("highlighted")||(t.classList.add("highlighted"),j&&C.current?lk("smooth"):a||(C.current=!0,lk("instant"))))},[G,x,s,j,a]);let $=(0,N.useCallback)(e=>{let t={},s=h.findIndex(t=>t.timestampMs===e.timestampMs);if(-1===s)return t;if((0,tx.wZ)(e))return t.noteId=e.note_id,t;for(;s<h.length;){let e=h[++s];if(!e||((0,tx.yi)(e)&&!t.editorTimestamp?h[s]&&(t.editorTimestamp=h[s].timestampMs):(0,tx.Fs)(e)&&!t.shellTimestamp&&(t.shellTimestamp=e.timestampMs),(0,tx.KJ)(e)||(0,tx.Hz)(e)||(0,tx.J8)(e)||t.shellTimestamp&&t.editorTimestamp))break}return t},[h]),X=(0,N.useMemo)(()=>d.map(e=>{if((0,tx.Hz)(e)||(0,tx.KJ)(e)||(0,tx.wZ)(e))return{...e,majorActions:$(e)}}),[d,$]),Q=ly(),ee=(0,b.b9)(F.x3),et=(0,b.b9)(F.g4),es=(0,b.b9)(F.is),ea=e=>{let{e:t,timestampMs:s}=e;es(null),null==t||t.stopPropagation(),s&&(Q("ts",s.toString()),p(s),ee(!0))},el=e=>{let{e:t,timestampMs:s}=e;es(null),null==t||t.stopPropagation(),s&&(Q("ts",s.toString()),p(s),et(!0))},en=(0,N.useMemo)(()=>{var e;let t=m.currentStep;return t?null===(e=t.match(/(\d+|(DONE))\. ?/))||void 0===e?void 0:e[1]:null},[m]),er=(0,N.useMemo)(()=>lF(m.plan).steps,[m]),ei=(0,N.useRef)(new(aK())),ec=(0,N.useCallback)(()=>{t5.Z.trackInteraction(t5.j.VSCODE),A(!0)},[A]),eu="DONE"==en||er.length>0&&en&&Number.parseInt(en)===er.length,{wasSnapshotAlreadyTaken:em,openSnapshotDialog:ex}=lr((null==t?void 0:t.devin_id)||null),[eh,ep]=(0,N.useState)([]),[ef,eg]=(0,N.useState)([]),[ev,ej]=(0,N.useState)([]),ew=(0,N.useCallback)(e=>{if(e){S(!(e.scrollHeight-e.scrollTop<=e.clientHeight));let t=Object.entries(W).filter(t=>{var s;let[a,l]=t;if((null==l?void 0:null===(s=l.result)||void 0===s?void 0:s.status)!=="pending"||(null==l?void 0:l.result.merge_conflict)!==!1)return!1;let n=q.current[a];return!!n&&n.offsetTop+n.clientHeight<e.scrollTop}),s=Object.entries(W).filter(t=>{var s;let[a,l]=t;if((null==l?void 0:null===(s=l.result)||void 0===s?void 0:s.status)!=="pending"||(null==l?void 0:l.result.merge_conflict)!==!1)return!1;let n=q.current[a];return!!n&&n.offsetTop+n.clientHeight>=e.scrollTop&&n.offsetTop<=e.scrollTop+e.clientHeight}),a=Object.entries(W).filter(t=>{var s;let[a,l]=t;if((null==l?void 0:null===(s=l.result)||void 0===s?void 0:s.status)!=="pending"||(null==l?void 0:l.result.merge_conflict)!==!1)return!1;let n=q.current[a];return!!n&&n.offsetTop>e.scrollTop+e.clientHeight});ep(t.map(e=>{let[t]=e;return t})),ej(s.map(e=>{let[t]=e;return t})),eg(a.map(e=>{let[t]=e;return t}))}},[W]);(0,N.useEffect)(()=>{let e=w.current,t=()=>ew(e);return null==e||e.addEventListener("scroll",t),()=>{null==e||e.removeEventListener("scroll",t)}},[ew]);let ek=0===ev.length&&0===eh.length&&ef.length>0,ey=(0,b.b9)(aC.So),eN=(0,b.b9)(aC.ON),eC=(0,N.useCallback)(e=>{ey(e),eN(!0)},[ey,eN]),{shouldRestrictFeatures:e_}=(0,eb.b1)(),eS=(0,N.useMemo)(()=>null==t?void 0:t.org_id.includes("org_"),[null==t?void 0:t.org_id]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)(ed.M,{mode:"wait",children:0===ev.length&&eh.length>0&&(0,n.jsxs)(eo.E.button,{initial:{scale:0},animate:{scale:1},exit:{scale:0},onClick:()=>{let e=Object.entries(q.current),t=w.current;if(!t)return;let s=e.filter(e=>{let[,s]=e;return!!s&&s.offsetTop+s.clientHeight<t.scrollTop}).sort((e,t)=>t[1].offsetTop-e[1].offsetTop)[0];s&&(0,aq.Z)(s[1],{behavior:"smooth"})},className:"absolute right-8 top-1 z-30 flex items-center justify-center gap-2 rounded-sm bg-[#6096FF] px-2 py-1 text-sm text-white md:top-2",children:[eh.length," Knowledge Suggestion",eh.length>1&&"s",(0,n.jsx)(aS.a,{className:"h-4 w-4 text-white"})]})})}),(0,n.jsxs)("div",{ref:w,className:"message-history h-full pb-2 pl-3 pr-4 md:pl-6 md:pr-6","data-mobile-draggable-allow":!0,children:[H.map((e,a)=>{var o,d,c;if((0,tx.Hz)(e))return(0,n.jsx)("div",{"data-timestamp":e.timestampMs,className:"message-history--item pb-4 pt-4",children:(0,n.jsx)(lS,{devin:t,message:e,isDemoMode:s,majorActions:null===(o=X[a])||void 0===o?void 0:o.majorActions,index:a,onTerminalIconClick:ea,onEditorIconClick:el,handleRestoreCheckpoint:eC,children:"send_secrets"===e.type?(0,n.jsx)(ld,{showHiddenContents:!1,hiddenContents:e.message}):(0,n.jsx)(lz,{devin:t,message:e,emitUpdateMasterPlan:l,onPlaybookCollapsedChange:L,triggerEditPlaybookEvent:ei.current})})},"".concat(e.timestamp,"-").concat(e.message));if((0,tx.KJ)(e))return(0,n.jsx)("div",{"data-timestamp":e.timestampMs,className:"message-history--item",children:(0,n.jsx)(lZ,{progressUpdate:e,majorActions:null===(d=X[a])||void 0===d?void 0:d.majorActions,onTerminalIconClick:ea,onEditorIconClick:el,handleRestoreCheckpoint:eC,children:e.message})},"".concat(e.timestamp,"-").concat(e.message));if((0,tx.wZ)(e))return(0,n.jsx)("div",{"data-timestamp":e.timestampMs,className:"message-history--item",children:(0,n.jsxs)(lR,{noteUsed:e,majorActions:null===(c=X[a])||void 0===c?void 0:c.majorActions,ignoreClick:!0,onTerminalIconClick:ea,onEditorIconClick:el,children:["Accessed knowledge: ",e.message]})},"".concat(e.timestamp,"-").concat(e.message));if((0,tx.yw)(e))return(0,n.jsx)("div",{"data-timestamp":e.timestampMs,className:"message-history--item",children:(0,n.jsx)(lK,{icon:(0,n.jsx)(aE.c,{size:20,className:"m-w-8 text-red  mr-2 max-w-8 text-red-500"}),message:"Session ended by user",event:e})},"".concat(e.timestamp));if((0,tx.tO)(e))return(0,n.jsx)("div",{"data-timestamp":e.timestampMs,className:"message-history--item",children:(0,n.jsx)(lK,{icon:(0,n.jsx)(aD.Q,{size:20,className:"m-w-8 text-red  text-cloud mr-2 max-w-8"}),message:"Devin went to sleep".concat("inactivity"===e.reason?" due to inactivity":["usage_limit_exceeded","out_of_credits"].includes(e.reason||"")?" due to usage limits":""),event:e})},"".concat(e.timestamp));if((0,tx.VT)(e))return(0,n.jsx)("div",{"data-timestamp":e.timestampMs,className:"message-history--item",children:(0,n.jsx)(lj,{event:e,accept:t=>Y(e.event_id,t),reject:()=>J(e.event_id),r:t=>{q.current[e.event_id]=t}})},"".concat(e.timestamp,"}"));if((0,tx.ed)(e))return(0,n.jsx)("div",{"data-timestamp":e.timestampMs,className:"message-history--item",children:(0,n.jsx)(lP,{commentEvent:e,children:"Received feedback from GitHub comments"})},"".concat(e.timestamp,"-").concat(e.message));else if((0,tx.qQ)(e))return(0,n.jsx)("div",{"data-timestamp":e.timestampMs,className:"message-history--item",children:(0,n.jsx)(le,{event:e,emitHumanModeUserResponse:r})},"".concat(e.timestamp,"}"));else if((0,tx.Fo)(e))return(0,n.jsx)("div",{"data-timestamp":e.timestampMs,className:"message-history--item",children:(0,n.jsx)(lt,{event:e,emitRestoreToCheckpoint:i})},"".concat(e.timestamp,"}"));return null}),(0,n.jsx)("div",{ref:k}),(0,n.jsxs)("div",{className:"ml-14 mt-6 flex flex-row gap-2",children:[P&&(0,n.jsx)("button",{onClick:()=>R(!1),className:"rounded-sm bg-[#6096FF] px-4 py-2 text-sm text-white",children:"View Devin's Work"}),"blocked"==c.enum&&eu&&K&&(0,n.jsx)("div",{children:(0,n.jsxs)("button",{className:"flex items-center gap-2 rounded-sm border border-black px-4 py-2 text-sm text-black opacity-70 hover:bg-white hover:bg-opacity-10 hover:opacity-80 dark:border-white dark:text-white dark:hover:bg-black",onClick:()=>{var e;null===(e=ei.current)||void 0===e||e.emit("addPlaybookStep")},children:[(0,n.jsx)(e5.v,{className:"h-4 w-4"}),"Playbook step"]})}),"initializing"==c.enum&&"Loading history..."!==c.message&&eS&&(0,n.jsx)(t9,{sessionId:(null==t?void 0:t.devin_id)||"",isInMenu:!1})]}),"rolledBack"===c.enum&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"ml-14 mt-2 flex flex-row gap-2",children:(0,n.jsx)("button",{className:"flex items-center gap-2 rounded-sm border border-black px-4 py-2 text-sm text-black opacity-70 hover:bg-white hover:bg-opacity-10 hover:opacity-80 dark:border-white dark:text-white dark:hover:bg-black",onClick:()=>g(-1),children:"Go to active timeline"})})}),"paused"==c.enum&&o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"ml-14 mt-6 text-sm text-black opacity-50 dark:text-white",children:"Suggested actions while Devin is paused"}),(0,n.jsxs)("div",{className:"ml-14 mt-2 flex flex-row gap-2",children:[K&&(0,n.jsx)("div",{children:(0,n.jsxs)("button",{className:"flex items-center gap-2 rounded-sm border border-[#6096FF] px-4 py-2 text-sm text-[#6096FF] hover:bg-[#6096FF] hover:bg-opacity-10",onClick:()=>{var e;null===(e=ei.current)||void 0===e||e.emit("modifyPlaybook")},children:[(0,n.jsx)(U.z,{className:"h-4 w-4"}),"Modify Playbook"]})}),(0,n.jsx)("div",{children:(0,n.jsx)(eb.Hd,{children:(0,n.jsxs)("button",{className:(0,f.Z)("flex items-center gap-2 rounded-sm border border-black px-4 py-2 text-sm text-black opacity-70 duration-100 enabled:hover:bg-black enabled:hover:bg-opacity-10 dark:border-white dark:text-white enabled:dark:hover:bg-white enabled:dark:hover:bg-opacity-10"),onClick:ec,disabled:e_,children:[(0,n.jsx)(u.H,{className:"h-4 w-4"}),"Open Devin's Machine"]})})})]})]}),("finished"==c.enum||"blocked"==c.enum)&&o&&!em&&(0,n.jsxs)("div",{className:"ml-10 md:ml-14",children:[(0,n.jsx)("div",{className:"mt-6 text-sm text-black opacity-50 dark:text-white",children:"Want to save Devin's work for another session?"}),(0,n.jsx)("div",{className:"mt-2 flex flex-row gap-2",children:(0,n.jsx)("div",{children:(0,n.jsx)(eb.Hd,{children:(0,n.jsxs)("button",{className:"flex items-center gap-2 rounded-sm border border-black px-4 py-2 text-sm text-black opacity-70 duration-100 enabled:hover:bg-black enabled:hover:bg-opacity-10 dark:border-white dark:text-white enabled:dark:hover:bg-white enabled:dark:hover:bg-opacity-10",onClick:ex,disabled:e_,children:[(0,n.jsx)(aT.V,{className:"h-4 w-4"}),"Create Machine Snapshot"]})})})})]})]}),(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)(ed.M,{mode:"wait",children:ek&&(0,n.jsxs)(eo.E.button,{initial:{scale:0},animate:{scale:1},exit:{scale:0},onClick:()=>{let e=Object.entries(q.current),t=w.current;if(!t)return;let s=e.filter(e=>{let[,s]=e;return!!s&&s.offsetTop>t.scrollTop}).sort((e,t)=>e[1].offsetTop-t[1].offsetTop)[0];s&&(0,aq.Z)(s[1],{behavior:"smooth"})},className:"absolute bottom-1 right-8 z-30 flex items-center justify-center gap-2 rounded-sm bg-[#6096FF] px-2 py-1 text-sm text-white md:bottom-2",children:[ef.length," Knowledge Suggestion",ef.length>1&&"s",(0,n.jsx)(aF.K,{className:"h-4 w-4 text-white"})]})})}),(0,n.jsx)("div",{className:"relative",children:(0,n.jsx)(ed.M,{mode:"wait",children:_&&!ek&&(0,n.jsx)(eo.E.button,{initial:{scale:0},animate:{scale:1},exit:{scale:0},onClick:Z,className:"absolute bottom-[-36px] right-8 z-30  flex h-7 w-7 items-center justify-center rounded-full bg-neutral-500",children:(0,n.jsx)(aF.K,{className:"h-4 w-4 text-white"})})})})]})}let lC=null,l_=[{left:"$$",right:"$$",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0},...["equation","equation*","matrix","Bmatrix","Bmatrix*","bmatrix","bmatrix*","cases","darray","dcases","drcases","gather","gathered","pmatrix","pmatrix*","rcases","smallmatrix","split","Vmatrix","vmatrix","Vmatrix*","vmatrix*","align","align*","aligned","alignat","alignat*","alignedat","gather","CD"].map(e=>({left:"\\begin{".concat(e,"}"),right:"\\end{".concat(e,"}"),display:!0}))],lS=e=>{let{devin:t,children:a,message:l,isDemoMode:r,majorActions:i,index:o,onTerminalIconClick:d,onEditorIconClick:c,handleRestoreCheckpoint:u}=e,{timelineActions:{setTimestamp:m},devinState:{status:x}}=(0,D.j1)(),h="finished"===x.enum,p=ly(),{user:g}=(0,T.aF)(),{immersiveLiveMode:b}=(0,e6.k)(),{isSmallerMobile:v}=(0,ay.Z)(),[j,w]=(0,N.useState)(null);(0,N.useEffect)(()=>{if(!t)return;let e="user_id"in l?l.user_id:null;if(!e){w(null);return}if((null==g?void 0:g.user_id)===e){w(g.picture);return}let s=async()=>{try{let s=await (0,e_.mg)(t.org_id,e);w(s)}catch(e){console.error(e)}};(null==g?void 0:g.user_id)&&s()},[t,l,null==g?void 0:g.user_id,null==g?void 0:g.picture]);let k=(0,N.useMemo)(()=>{switch(l.type){case"devin_message":return(0,n.jsx)(a5.Z,{size:v?25:40});case"send_secrets":case"user_message":case"initial_user_message":{var e,s,a,r;let i=l.user_id&&t?j:null!==(s=null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.image_url)&&void 0!==s?s:null;if(i)return(0,n.jsx)(li.T,{src:i,alt:"user avatar",height:v?25:40,width:v?25:40,className:"rounded-sm"});let o=null!==(a=l.username)&&void 0!==a?a:null==t?void 0:t.user.name;return null!==(r=null==o?void 0:o.split(" ")[0].split("")[0])&&void 0!==r?r:"?"}default:return"?"}},[l,t,j,v]),y=(0,N.useMemo)(()=>{switch(l.type){case"devin_message":return"Devin";case"send_secrets":case"user_message":case"initial_user_message":var e,s,a,n;if(!l.user_id&&(null==t?void 0:t.user_id)!==(null==g?void 0:g.user_id))return null!==(s=null!==(e=l.username)&&void 0!==e?e:null==t?void 0:t.user.name)&&void 0!==s?s:"?";if(l.user_id==(null==g?void 0:g.user_id)||!("user_id"in l)&&(null==t?void 0:t.user_id)==(null==g?void 0:g.user_id))return"You";return null!==(n=null!==(a=l.username)&&void 0!==a?a:null==t?void 0:t.user.name)&&void 0!==n?n:"?";default:return"?"}},[l,t,null==g?void 0:g.user_id]),C=(0,N.useMemo)(()=>(0,ln.i)(l.timestamp,!0),[l]),_=(0,N.useMemo)(()=>(0,ln.x)(l.timestamp),[l]),S=["devin_message","learnings"].includes(l.type),[E,F]=(0,N.useState)(!1),{devinState:{masterPlan:M}}=(0,D.j1)(),A=(0,N.useCallback)(()=>{let{contents:e,playbookContents:t,playbookHeader:s}=lO(l.message,M),a=s?"Playbook: ".concat(s,"\n").concat(t):t,n=e;n.endsWith("\n")||(n+="\n"),a&&(n+="PLAYBOOK:\n".concat(a)),navigator.clipboard.writeText(n),F(!0),setTimeout(()=>F(!1),1e3)},[l.message,M]),O=(0,N.useRef)(null);return(0,N.useEffect)(()=>{let e=O.current;if(!e)return;let t=e.textContent;t&&l_.some(e=>t.includes(e.left)||t.includes(e.right))&&(lC||(lC=Promise.all([s.e(8287),s.e(3330)]).then(s.bind(s,23330)).then(e=>e.default)),lC.then(t=>{t(e,{throwOnError:!1,errorColor:"currentColor",delimiters:l_})}))},[]),(0,n.jsxs)("div",{className:"message-item w-full",children:[(0,n.jsx)("div",{className:(0,f.Z)("flex h-8 w-8 flex-shrink-0  justify-center rounded-md font-bold",S||"string"!=typeof k?"items-start":"items-center bg-gray-200"),children:k}),(0,n.jsxs)("div",{ref:O,className:"message-item--content group relative w-full min-w-0 flex-1",children:[(0,n.jsxs)("div",{className:"mb-1 flex w-full cursor-pointer items-center",onClick:()=>{p("ts",l.timestampMs.toString()),m(l.timestampMs),setTimeout(lw,200)},children:[(0,n.jsx)("span",{className:"mr-2 font-bold dark:text-white",children:y}),(!r||!b)&&(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:_}),side:"top",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)("span",{className:"text-neutral-400",children:C})}),(0,n.jsxs)("div",{className:"absolute right-4 mt-[6.5px] flex items-center text-black duration-300 group-hover:opacity-100 sm:opacity-0 dark:text-white",children:[o>1&&(0,n.jsx)(lm,{majorActions:i||{},isSmallerMobile:v,onTerminalIconClick:d,onEditorIconClick:c,handleRestoreCheckpoint:()=>u(l.timestampMs),disableRestoreCheckpoint:h}),(0,n.jsx)("div",{className:"flex",children:(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Copy Message"}),side:"top",className:"px-2 py-1",delayDuration:50,children:(0,n.jsx)("div",{className:(0,f.Z)("cursor-pointer duration-150","px-[0.125rem]","dark:bg-shade bg-white text-black dark:text-white","text-opacity-40 hover:text-opacity-100","dark:text-opacity-40 dark:hover:text-opacity-100"),onClick:e=>{e.stopPropagation(),t5.Z.trackInteraction(t5.j.CHAT_HISTORY_COPY_MESSAGE),A()},children:E?(0,n.jsx)(J.J,{size:v?14:17}):(0,n.jsx)(aM.T,{size:v?14:17})})})})]})]}),a]})]})},lE=e=>{let t,{contents:s}=e,a=s.split("--multidevin")[0];try{t=a&&JSON.parse(a)}catch(e){console.error("Failed to parse tasks:",e)}let l=t.tasks||t.issues||[];return t?(0,n.jsxs)("div",{className:"dark:border-input-dark rounded-md border px-5 pb-3 pt-6 shadow-md dark:text-white",children:[(0,n.jsxs)("div",{className:"mx-2 flex items-center",children:[(0,n.jsx)(eu.default,{src:"/devin_v2.png",alt:"Devin",width:30,height:30}),(0,n.jsx)("span",{className:"ml-2 text-xl font-semibold",children:"MultiDevin"})]}),(null==t?void 0:t.manager_prompt)&&(null==t?void 0:t.manager_prompt)!==ek&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"dark:border-input-dark mt-3 border-t px-2 pt-3 text-sm font-medium opacity-70",children:"Manager Devin prompt:"}),(0,n.jsx)("div",{className:"dark:bg-night mx-1 mt-1 whitespace-pre-wrap rounded-md bg-slate-100 px-3 py-3 text-sm opacity-90",children:t.manager_prompt})]}),(null==t?void 0:t.custom_prompt)&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"dark:border-input-dark mt-3 border-t px-2 pt-3 text-sm font-medium opacity-70",children:"Worker Devin prompt:"}),(null==t?void 0:t.custom_prompt)&&(0,n.jsx)("div",{className:"dark:bg-night mx-1 mt-1 whitespace-pre-wrap rounded-md bg-slate-100 px-3 py-3 text-sm opacity-90",children:t.custom_prompt})]}),(0,n.jsxs)("div",{className:"dark:border-input-dark mt-3 border-t px-2 pt-3 text-sm font-medium opacity-70",children:["Batch Tasks (",l.length,"):"]}),(0,n.jsx)("div",{className:"dark:border-input-dark mx-1 border-l",children:l&&l.map((e,t)=>(0,n.jsx)(lD,{task:e,index:t},t))})]}):null},lD=e=>{let{task:t,index:s}=e,[a,l]=(0,N.useState)(!1),[r,i]=(0,N.useState)(!1),o=Object.entries(t.raw).length>1;return(0,n.jsxs)("div",{className:(0,f.Z)("group relative my-4 cursor-pointer px-2 opacity-90",o?"cursor-pointer":"cursor-text"),onClick:()=>o&&i(e=>!e),onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),children:[(0,n.jsx)("div",{className:"dark:bg-input-dark absolute left-0 top-1/2 h-[1px] w-4 -translate-y-1/2 bg-gray-200"}),(0,n.jsxs)("div",{className:"flex items-center justify-between px-5 text-xs font-medium",children:[(0,n.jsxs)("span",{className:"text-pacific",children:["Task ",s+1]}),o&&(0,n.jsx)("div",{className:(0,f.Z)("duration-100",a?"text-pacific":"text-neutral-700 dark:text-white"),children:(0,n.jsx)(sY.Z,{size:15,className:(0,f.Z)(r?"rotate-180":"rotate-0","duration-150")})})]}),(0,n.jsx)(eo.E.div,{initial:{height:0,opacity:0},animate:{height:r?"auto":0,opacity:r?1:0},transition:{duration:.1},className:"overflow-hidden",children:(0,n.jsx)("div",{className:"dark:bg-night mx-3 mt-1.5 rounded-md bg-slate-100 px-3 pb-1.5 pt-2 text-xs",children:Object.entries(null==t?void 0:t.raw).map(e=>{let[t,s]=e;return null!==s&&""!==s&&(0,n.jsxs)("div",{className:"mb-1",children:[(0,n.jsxs)("span",{className:"text-xs",children:[t,": "]}),(0,n.jsx)("span",{className:"whitespace-pre-wrap text-xs",children:s instanceof String?s:JSON.stringify(s)})]},t)})})})]})},lT=e=>{let{contents:t}=e,s=t.replace(/\\{1}/g,"\\\\");return(0,n.jsx)(S.U,{className:"prose prose-sm dark:prose-invert prose-p:whitespace-pre-wrap prose-pre:whitespace-pre-wrap max-w-none leading-[1.5] [overflow-wrap:anywhere] sm:leading-[1.7142855]",remarkPlugins:[aW.Z],rehypePlugins:[[ex.Z,{target:"_blank"}]],components:{a:aG,img:e=>{let{node:t,alt:s,...a}=e;return(0,n.jsxs)(tV.Vq,{modal:!0,children:[(0,n.jsx)(tV.hg,{children:(0,n.jsx)("img",{alt:s,...a,className:(0,f.Z)(a.className,"mx-auto my-4 max-w-[70%] rounded-sm")})}),(0,n.jsxs)(tV.cZ,{className:"max-w-[90%] outline-none sm:max-w-[525px]",children:[(0,n.jsx)(tV.fK,{children:(0,n.jsx)(tV.$N,{className:"text-md mb-1 tracking-tight",children:s})}),(0,n.jsx)("img",{...a,alt:s,className:(0,f.Z)(a.className,"rounded-sm")})]})]})},code:e=>{let{node:t,...s}=e;if(t&&t.data&&"meta"in t.data&&"string"==typeof t.data.meta){let e=t.data.meta.match(/filename=(.*) lines=(\d+)-(\d+)/);if(e){var a,l,r;let[,t,i,o]=e,d=null!==(r=null===(l=s.className)||void 0===l?void 0:null===(a=l.match(/language-(\w+)/))||void 0===a?void 0:a[1])&&void 0!==r?r:"plaintext";return(0,n.jsx)(sj,{removable:!1,defaultExpanded:!1,selection:{file:t,language:d,range:{startLine:Number(i),endLine:Number(o)},snippet:s.children}})}}return(0,n.jsx)("code",{...s})}},children:s})},lF=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=e.indexOf("## Procedure");if(-1===s)return{clean:e,steps:[]};let a=e.indexOf("\n## ",s+12),l=-1!==a?e.slice(s,a):e.slice(s),n=l.slice(l.trimEnd().length),r=l.split("\n"),i=r[0]+"\n",o=[],d=[];for(let e of r.slice(1)){if(/^(\d+\.?)+/.test(e)){d.length&&(o.push(d.join("\n")),d=[]);let t=e.replace(/^(\d+\.?)+/,"");d.push(t);let s=o.length+1;e="".concat(s,".").concat(t)}else d.length&&d.push(e);i+=e+"\n"}for(let e of(d.length&&(o.push(d.join("\n")),d=[]),t))o.push(e),i+="".concat(o.length,".").concat(e,"\n");return i=i.trimEnd()+n,{clean:e=e.slice(0,s)+i+(-1!==a?e.slice(a):""),steps:o}},lM=e=>(0,n.jsxs)("div",{className:"mt-2 rounded-md bg-gray-200 text-black shadow-md dark:bg-gray-300  dark:bg-opacity-15 dark:text-white",children:[(0,n.jsxs)("div",{className:"flex flex-col justify-center align-middle",children:[(0,n.jsx)("span",{className:"px-3 py-4 text-base font-semibold leading-none",children:"Playbook"}),(0,n.jsx)("div",{className:"mx-3 h-[1px] bg-gray-400 dark:bg-gray-500"})]}),(0,n.jsx)("div",{className:"py-2",children:(0,n.jsx)(lA,{...e})})]}),lA=e=>{let{devin:t,playbookContents:s,playbookHeader:a,setPlaybookContents:l,onPlaybookCollapsedChange:r,triggerEditPlaybookEvent:i,emitUpdateMasterPlan:o}=e,{devinState:{masterPlan:d},features:{checkpointingFeatureEnabled:c}}=(0,D.j1)(),{userId:u}=(0,T.aC)(),[m,x]=(0,N.useState)(!1),[h,p]=(0,N.useState)(!0),g=(0,b.Dv)(F.vl),v=(0,y.useRouter)(),j=(0,ev.vn)(e=>e.updatePlaybookDraft),_=(0,N.useCallback)(()=>{j({title:a,body:s}),v.push("/playbooks/create?from=file")},[s,a,v,j]),E=(0,N.useCallback)(async()=>{if(!(null==t?void 0:t.playbook_id))return;let e=await (0,ll.Y8)(null==t?void 0:t.playbook_id);await (0,ll.df)(null==t?void 0:t.playbook_id,{title:e.title,body:s,status:e.status,access:e.access,examples:e.examples.map(e=>e.devin_id)}),C.A.success("Playbook updated in library")},[s,null==t?void 0:t.playbook_id]),{data:M}=(0,ej.I4)(null==t?void 0:t.playbook_id),A=(null==M?void 0:M.access)==="community",O=(0,la.z)(),[z,I]=(0,N.useState)(s),L=(0,N.useRef)(null),Z=(0,N.useCallback)(e=>(l(e),e),[l]),P=(0,N.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];p(!0),x(!0),e&&Z(s)},[s,Z]);(0,N.useEffect)(()=>{if(i){let e=e=>{m||(P(e),setTimeout(()=>{var e,t;null===(e=L.current)||void 0===e||e.focus(),null===(t=L.current)||void 0===t||t.scrollIntoView({behavior:"smooth",block:"end"})},100))},t=()=>e(!0),s=()=>e(!1);return i.on("addPlaybookStep",t),i.on("modifyPlaybook",s),()=>{i.off("addPlaybookStep",t),i.off("modifyPlaybook",s)}}},[i,m,P]),(0,N.useEffect)(()=>{Z(s)},[]);let R=(0,N.useCallback)(()=>{m||(p(!h),r())},[m,h,r]),K=(0,N.useCallback)(e=>{null==e||e.stopPropagation(),x(!1),d.plan&&Z(d.plan)},[d.plan,Z,x]),V=(0,N.useCallback)(()=>{let e=new Blob([s],{type:"text/plain;charset=utf-8"});aV()(e,"".concat(w().kebabCase(g),".devin.md"))},[s,g]),H=(0,N.useCallback)(e=>{o(Z(e)),x(!1)},[Z,o,x]),W=(0,N.useCallback)(async()=>{(null==t?void 0:t.playbook_id)&&(H((await (0,ll.Y8)(null==t?void 0:t.playbook_id)).body),C.A.success("In session Playbook updated from library"))},[H,null==t?void 0:t.playbook_id]),q=(0,N.useMemo)(()=>0===z.length?"Playbook is empty":null,[z]),B=(0,eT._Z)();return(0,n.jsxs)("div",{className:" px-3",children:[(0,n.jsx)("div",{className:(0,f.Z)("flex items-center overflow-hidden  pt-1 text-[22px] text-black dark:text-white",m?"cursor-default":"cursor-pointer"),onClick:R,children:(0,n.jsxs)("div",{className:"flex w-full flex-col",children:[a&&(0,n.jsx)("div",{className:"mb-3",children:(0,n.jsx)("span",{className:"block text-wrap text-xs font-light opacity-50",children:a})}),(0,n.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm leading-none",children:"Contents"}),m?(0,n.jsx)("div",{className:"ml-auto flex items-center",children:(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Cancel"}),side:"top",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)("button",{className:"ml-2.5 opacity-70 duration-150 hover:opacity-100",onClick:K,children:(0,n.jsx)(eX.X,{size:"1rem"})})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"ml-auto flex items-center",children:[!!u&&(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Edit Playbook in session"}),side:"top",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)("button",{className:"opacity-70 duration-150 hover:opacity-100",onClick:e=>{e.stopPropagation(),P()},children:(0,n.jsx)(U.z,{size:"1rem"})})}),(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Download Playbook"}),side:"top",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)("button",{className:"ml-2.5 opacity-70 duration-150 hover:opacity-100",onClick:e=>{e.stopPropagation(),V()},children:(0,n.jsx)(aA.U,{size:"1rem"})})}),(null==t?void 0:t.playbook_id)&&(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"View in library"}),side:"top",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)(k.default,{href:"/playbooks/".concat((0,ev.I0)(t.playbook_id)),className:"ml-2.5 opacity-70 duration-150 hover:opacity-100",children:(0,n.jsx)(aO.p,{size:"1rem"})})}),(null==t?void 0:t.playbook_id)&&(!A||O)&&(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Update Playbook in library"}),side:"top",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)("button",{className:"ml-2.5 opacity-70 duration-150 hover:opacity-100",onClick:e=>{e.stopPropagation(),E()},children:(0,n.jsx)(e4.B,{size:"1rem"})})}),(null==t?void 0:t.playbook_id)&&B&&(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Update in session Playbook from library"}),side:"top",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)("button",{className:"ml-2.5 opacity-70 duration-150 hover:opacity-100",onClick:e=>{e.stopPropagation(),W()},children:(0,n.jsx)(az.d,{size:"1rem"})})}),(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Create new Playbook in library"}),side:"top",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)("button",{className:"mx-2.5 opacity-70 duration-150 hover:opacity-100",onClick:_,children:(0,n.jsx)(sw.i,{size:"1rem"})})})]}),(0,n.jsx)("div",{className:(0,f.Z)("w-min duration-150",h?"":"-rotate-90"),children:(0,n.jsx)(sY.Z,{size:"1rem"})})]})]})]})}),(0,n.jsx)("div",{className:(0,f.Z)("overflow-hidden duration-100 ",h?"visible mt-2 h-auto border-none border-gray-400 py-2 dark:border-gray-500":"invisible h-1"),children:m?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{children:[(0,n.jsx)(sl.b,{status:"info",className:"text-start text-xs",children:"Edits to the playbook only impact this session. Changes won't be reflected in your library."}),c&&(0,n.jsx)(sl.b,{status:"info",className:"mt-3 text-start text-xs",children:"Remember you can roll back to a previous checkpoint to test your playbook changes by rewinding the timeline and pressing restore."}),(0,n.jsx)("textarea",{ref:L,className:(0,f.Z)("prose prose-sm dark:prose-invert max-w-none whitespace-pre-wrap rounded-sm bg-white p-1 text-sm opacity-90 outline-none duration-150 [overflow-wrap:anywhere] dark:bg-black dark:bg-opacity-50",h?"mt-1 h-full":"mt-1 h-0","w-full resize-none"),value:z,rows:20,onChange:e=>{I(e.target.value)}}),q&&(0,n.jsx)("div",{className:"mt-1 text-xs text-red-400",children:q}),(0,n.jsxs)("div",{className:"mt-2 flex justify-end gap-2",children:[(0,n.jsx)(tO.z,{loading:!1,onClick:K,theme:"default",size:"sm",defaultTitle:"Cancel"}),(0,n.jsx)(tO.z,{loading:!1,disabled:null!==q,onClick:()=>H(z),theme:"primary",size:"sm",defaultTitle:"Save"})]})]})}):(0,n.jsx)(S.U,{className:(0,f.Z)("prose prose-sm dark:prose-invert prose-p:whitespace-pre-wrap prose-pre:whitespace-pre-wrap mb-2 max-w-none border-gray-200 text-sm opacity-90 duration-150 [overflow-wrap:anywhere] dark:border-gray-500",h?"h-full":"h-0"),remarkPlugins:[aW.Z],rehypePlugins:[[ex.Z,{target:"_blank"}]],components:{a:aG},children:s})})]})},lO=(e,t)=>{let s="",a="";if(e.match(/(PLAYBOOK:|PLAYBOOK_md:|PLAYBOOK_txt:)/))for(let l of["PLAYBOOK:","PLAYBOOK_md:","PLAYBOOK_txt:"]){let n=e.indexOf(l);if(-1!==n){s=t.plan||e.substring(n+l.length);let r=e.match(/(PLAYBOOK|PLAYBOOK_md|PLAYBOOK_txt):\s*([^\n#]*)(?=\n|#|Overview)/i);e=e.substring(0,n),(a=r?r[2].trim():"")&&(s=s.replace(r?r[0]:l,"").trim());break}}return{contents:e,playbookContents:s,playbookHeader:a}},lz=N.memo(function(e){let{devin:t,message:s,onPlaybookCollapsedChange:a,triggerEditPlaybookEvent:l,emitUpdateMasterPlan:r}=e,{devinState:{masterPlan:i}}=(0,D.j1)(),[o,d]=(0,N.useState)(aJ(s.message)),[c,u]=(0,N.useState)(""),[m,x]=(0,N.useState)(""),[h,p]=(0,N.useState)(""),f=(0,b.b9)(s_.q$),[g,v]=(0,N.useState)(!1),{shouldRestrictFeatures:j,planUsesCredits:w}=(0,eb.b1)();(0,N.useEffect)(()=>{if(-1!==o.indexOf("[SECURE_CHANNEL]")){v(!0);let e=o.indexOf("[SECURE_CHANNEL]"),t=o.indexOf("[/SECURE_CHANNEL]",e);p(o.substring(e+16,t)),d(o.substring(0,e).trim())}},[o,d,g]),(0,N.useEffect)(()=>{let{contents:e,playbookContents:t,playbookHeader:s}=lO(o,i);t&&(x(t),u(s),d(e))},[o,d,i]);let k=(0,N.useMemo)(()=>(0,n.jsx)(lT,{contents:o}),[o]);return"initial_user_message"===s.type&&o.includes("--multidevin")&&!o.includes("--multidevin-worker")?(0,n.jsx)(lE,{contents:o}):(0,n.jsxs)(n.Fragment,{children:[k,m.length>0?(0,n.jsx)(lM,{devin:t,playbookContents:m,playbookHeader:c,onPlaybookCollapsedChange:a,setPlaybookContents:x,triggerEditPlaybookEvent:l,emitUpdateMasterPlan:r}):null,g&&("devin_message"===s.type?(0,n.jsx)("div",{className:"mt-2 flex items-center space-x-2",children:(0,n.jsx)(eb.Hd,{children:(0,n.jsxs)("button",{className:"flex flex-row items-center gap-2 text-neutral-400 underline",onClick:()=>{f(!0)},disabled:j,children:[(0,n.jsx)(sC.s,{className:"text-lg"}),"Provide Secrets"]})})}):(0,n.jsx)(ld,{showHiddenContents:!1,hiddenContents:h})),"devin_message"===s.type&&(0,n.jsx)(lL,{message:s}),"initial_user_message"===s.type&&w&&(0,n.jsx)(lI,{session:t})]})}),lI=e=>{let{session:t}=e,{isSubscriptionValid:s}=(0,eb.b1)(),a=(0,b.b9)(F.DA);return t&&t.max_acu_limit&&s?(0,n.jsx)("div",{className:(0,f.Z)("relative  ml-[-38px] mt-4 px-2 sm:pl-0 md:ml-0","group flex min-w-full items-start justify-start whitespace-pre-wrap leading-7 text-[#888888] dark:text-neutral-400"),children:(0,n.jsxs)("div",{className:"flex w-full flex-row",children:[(0,n.jsx)(aI.a,{size:18,className:"m-w-8 mr-3 mt-[5px] max-w-8 shrink-0"}),(0,n.jsxs)("div",{className:"flex-1 sm:max-w-full",style:{overflowWrap:"break-word",wordBreak:"break-word"},children:["Devin will sleep after ".concat(null==t?void 0:t.max_acu_limit," ACUs are used. "),(0,n.jsx)("span",{onClick:()=>a(!0),className:"cursor-pointer text-wrap break-words underline",children:"Manage session usage limit."})," "]})]})}):null},lL=e=>{let{message:t}=e,[s,a]=(0,N.useState)(!1),l=t.message.match(/https:\/\/github\.com\/[a-zA-Z0-9_-]+\/[a-zA-Z0-9_-]+\/pull\/(\d+)/);if(!l)return null;let r=l[1],i="gh pr checkout ".concat(r);return(0,n.jsxs)("button",{onClick:()=>{l&&navigator.clipboard.writeText(i).then(()=>{C.A.success("Command copied to clipboard"),a(!0),setTimeout(()=>a(!1),2e3)},()=>{C.A.error("Failed to copy command")})},className:"bg-pacific mt-2 flex items-center rounded px-2.5 py-1.5 text-xs text-white transition hover:bg-blue-500",children:[(0,n.jsx)(aL.C,{size:16,className:"mr-1"}),s?"Copied!":i]})},lZ=e=>{let{children:t,progressUpdate:s,majorActions:a,onTerminalIconClick:l,onEditorIconClick:r,handleRestoreCheckpoint:i}=e,o=(0,N.useRef)(null),{timelineActions:{setTimestamp:d}}=(0,D.j1)(),c=ly(),u=(0,N.useCallback)(()=>{c("ts",s.timestampMs.toString()),d(s.timestampMs,!0),setTimeout(lw,200)},[d,s,c]),m=new Date(s.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return(0,n.jsxs)("div",{ref:o,onClick:u,className:(0,f.Z)("progress-update relative ","px-2 sm:pl-0 sm:pr-8","group flex min-w-full cursor-pointer items-start justify-start whitespace-pre-wrap leading-7 text-[#888888] dark:text-neutral-400"),children:[(0,n.jsx)("div",{className:"progress-update-timestamp w-16",children:(0,n.jsx)("span",{className:"text-xs text-neutral-400",children:m})}),(0,n.jsxs)("div",{className:"flex w-full flex-row",children:[(0,n.jsx)(aZ.f,{size:18,className:"m-w-8 mr-2 mt-[5px] max-w-8 shrink-0"}),(0,n.jsx)("p",{className:"flex-1 space-y-2 sm:max-w-full",style:{overflowWrap:"break-word",wordBreak:"break-word"},children:t})]}),(0,n.jsx)("div",{className:"progress-update-caret align-start absolute right-4 mt-[6.5px] flex items-center text-black dark:text-white",children:(0,n.jsx)(lm,{majorActions:a,isSmallerMobile:!1,onTerminalIconClick:l,onEditorIconClick:r,handleRestoreCheckpoint:()=>i(s.timestampMs),disableRestoreCheckpoint:!1})})]})},lP=e=>{let{children:t,commentEvent:s}=e,a=(0,N.useRef)(null),{timelineActions:{setTimestamp:l}}=(0,D.j1)(),r=ly(),i=(0,N.useCallback)(()=>{r("ts",s.timestampMs.toString()),l(s.timestampMs,!0),setTimeout(lw,200)},[l,s,r]),o=new Date(s.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return(0,n.jsxs)("div",{ref:a,onClick:i,className:(0,f.Z)("progress-update relative ","px-2 sm:pl-0 sm:pr-8","group flex min-w-full cursor-pointer items-start justify-start whitespace-pre-wrap leading-7 text-[#888888] dark:text-neutral-400"),children:[(0,n.jsx)("div",{className:"progress-update-timestamp w-16",children:(0,n.jsx)("span",{className:"text-xs text-neutral-400",children:o})}),(0,n.jsxs)("div",{className:"flex w-full flex-row",children:[(0,n.jsx)(aZ.f,{size:18,className:"m-w-8 mr-2 mt-[5px] max-w-8 shrink-0"}),(0,n.jsx)("p",{className:"flex-1 space-y-2 sm:max-w-full",style:{overflowWrap:"break-word",wordBreak:"break-word"},children:t})]}),(0,n.jsx)("div",{className:"progress-update-caret align-start absolute right-4 mt-[6.5px] flex items-center text-black dark:text-white",children:(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"View comment on Github"}),side:"top",className:"px-2 py-1",delayDuration:50,children:(0,n.jsx)("a",{href:s.changes.url,target:"_blank",rel:"noopener noreferrer",className:(0,f.Z)("cursor-pointer duration-150","px-[0.125rem]","dark:bg-shade bg-white text-black dark:text-white","text-opacity-40 hover:text-opacity-100","dark:text-opacity-40 dark:hover:text-opacity-100"),children:(0,n.jsx)(ea.b,{size:17})})})})]})},lR=e=>{let{children:t,noteUsed:s,majorActions:a,onTerminalIconClick:l,onEditorIconClick:r,ignoreClick:i}=e,o=(0,N.useRef)(null),{timelineActions:{setTimestamp:d}}=(0,D.j1)(),c=ly(),u=(0,N.useCallback)(()=>{i||(c("ts",s.timestampMs.toString()),d(s.timestampMs),setTimeout(lw,200))},[i,c,s.timestampMs,d]),m=new Date(s.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return(0,n.jsxs)("div",{ref:o,onClick:u,className:(0,f.Z)("progress-update relative","px-2 sm:pl-0 sm:pr-8","group flex min-w-full cursor-pointer items-start justify-start whitespace-pre-wrap leading-7 text-[#888888] dark:text-neutral-400"),children:[(0,n.jsx)("div",{className:"progress-update-timestamp w-16",children:(0,n.jsx)("span",{className:"text-xs text-neutral-400",children:m})}),(0,n.jsxs)("div",{className:"flex w-full flex-row",children:[(0,n.jsx)(aP.v,{size:18,className:"m-w-8 mr-2 mt-[5px] max-w-8 shrink-0 text-yellow-300 dark:text-yellow-200 dark:opacity-80"}),(0,n.jsx)("p",{className:"max-w-[73vw] space-y-2 sm:max-w-full",style:{overflowWrap:"break-word",wordBreak:"break-word"},children:t})]}),(0,n.jsx)("div",{className:"progress-update-caret align-start absolute right-4 mt-[6.5px] flex items-center text-black dark:text-white",children:(0,n.jsx)(lm,{majorActions:a,isSmallerMobile:!1,onTerminalIconClick:l,onEditorIconClick:r,handleRestoreCheckpoint:()=>{},disableRestoreCheckpoint:!0})})]})},lK=e=>{let{event:t,icon:s,message:a}=e,l=(0,N.useRef)(null),{timelineActions:{setTimestamp:r}}=(0,D.j1)(),i=(0,N.useCallback)(()=>{r(t.timestampMs),setTimeout(lw,200)},[r,t]),o=new Date(t.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return(0,n.jsxs)("div",{ref:l,onClick:i,className:(0,f.Z)("progress-update","flex min-w-full cursor-pointer items-center justify-start px-2 py-1 align-middle leading-7 text-[#888888] dark:text-neutral-400"),children:[(0,n.jsx)("div",{className:"progress-update-timestamp w-16",children:(0,n.jsx)("span",{className:"block text-xs text-neutral-400",children:o})}),(0,n.jsxs)("div",{className:"flex w-full flex-row align-middle",children:[s,(0,n.jsx)("span",{className:"block text-sm",children:a})]}),(0,n.jsx)("div",{className:"progress-update-caret w-16",children:(0,n.jsx)(X.T,{})})]})};var lU=s(90036),lV=s(67407);s(59026);var lH=s(29025),lW=s(55321),lq=s(87950),lB=s(8214),lY=s(10295),lJ=s(65336);s(78844);let lG=e=>{let{timestamp:t,timestampsList:s,exitReplayMode:a,bufferState:l,setTimestamp:r,disabled:i,isTimelineLoading:o}=e,d=(0,N.useMemo)(()=>{let e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,s=function(e,t){let s=e[0],a=t*(e[e.length-1]-s)/100,l=[],n=e[0];for(let t=1;t<e.length;t++)e[t]-n>a&&l.push(t),n=e[t];return l}(e,t),a=function(e,t){let s=[],a=0;for(let l of t)s.push(e.slice(a,l)),a=l;return s.push(e.slice(a)),s}(e,s),l=function(e,t){let s=[],a=0;for(let l of e){let e=100*l.length/t;s.push({start:a,end:a+e}),a+=e}return s}(a,e.length),n=function(e,t){let s=[];for(let a=0;a<e.length;a++){let l=e[a],n=t[a],r=l[0],i=l[l.length-1],o=i-r;0===o&&(o=i);for(let t=0;t<l.length;t++){let i=l[t],d=100;(a!==e.length-1||t!==l.length-1)&&(d=n.start+(l[t]-r)*(n.end-n.start)/o),s.push({value:i,position:d})}}return s}(a,l);return{gaps:s,dataByGaps:a,dataByGapsPositions:l,dataPositions:n,valueToPosition:e=>(function(e,t,s){let a=t[t.length-1];if(e>=a[a.length-1])return 100;let l=t.findIndex(t=>e>=t[0]&&e<=t[t.length-1]);if(l>-1){let a=t[l],n=s[l],r=a[0],i=a[a.length-1],o=i-r;return 0===o&&(o=i),n.start+(e-r)*(n.end-n.start)/o}return 0})(e,a,l),positionToValue:e=>(function(e,t,s){let a=s.findLastIndex(t=>e>=t.start&&e<=t.end);if(a>-1){let l=t[a],n=s[a],r=l[0],i=l[l.length-1];return r+(e-n.start)*(i-r)/(n.end-n.start)}return e>100?t[t.length-1][t[t.length-1].length-1]:0})(e,a,l)}}(s);return{gaps:w().dropRight(e.dataByGapsPositions),positionToValue:e.positionToValue,valueToPosition:e.valueToPosition}},[s]),c=(0,N.useMemo)(()=>d.valueToPosition(t),[d,t]),u=(0,N.useCallback)(e=>{let[t]=e;100===t?a():r(d.positionToValue(t))},[a,r,d]),[m,x]=(0,N.useState)(!1),h=(0,N.useCallback)(()=>{x(!0)},[x]),p=(0,N.useCallback)(()=>{x(!1)},[x]);return(0,n.jsx)(sD.u,{delayDuration:0,content:(0,n.jsx)("div",{children:(0,ln.x)(t)}),onPointerDownOutside:e=>{e.preventDefault()},arrowClassName:"dark:fill-[#3399FF]",className:"ml-[20px] rounded-md !bg-[#3399FF] px-2 py-1.5 text-center text-xs text-white",align:"start",sideOffset:12,disabled:!m,children:(0,n.jsxs)(lJ.fC,{className:"touch-action-none user-select-none relative z-10 flex h-1.5 w-full cursor-pointer items-center",value:[c],disabled:i,onValueChange:u,"data-mobile-draggable-allow":!0,onPointerEnter:h,onPointerLeave:p,children:[(0,n.jsxs)(lJ.fQ,{className:"relative h-full w-full grow-[1] bg-[#3399FF] bg-opacity-30",children:[o&&(0,n.jsx)("div",{className:"absolute right-0 flex max-h-1.5 min-w-full grow-[1] pr-1",children:l.map((e,t)=>(0,n.jsx)("div",{className:(0,f.Z)(" h-1.5 flex-1 ",e.loading?"bg-gray-500":"")},t))}),(0,n.jsx)(lJ.e6,{className:"absolute block h-full bg-[#3399FF]"})]}),d.gaps.map(e=>(0,n.jsx)("span",{className:(0,eD.cn)("slider-break",c>=e.end&&"slider-break--active"),style:{left:"".concat(e.end,"%")}},"".concat(e.start,"-").concat(e.end))),(0,n.jsx)(lJ.bU,{className:"block h-5 w-5 rounded-full bg-[#3399FF] hover:shadow-[0_0_0_6px_rgba(102,178,255,0.3)] focus:outline-none active:shadow-[0_0_0_8px_rgba(51,153,255,0.5)]"})]})})};var l$=s(87623);let lX=e=>{let{latestCheckpoint:t,isRunning:s,selectedTimelineIndex:a,timestamp:l,disabled:r}=e,i=(0,b.b9)(aC.ON),o=(0,b.b9)(aC.So),d=(0,N.useMemo)(()=>s?-1!==a?"Can only restore checkpoints in the active timeline":t?r?"Select a point in the session history before restoring":"Restore checkpoint at ".concat((0,ln.i)(null==t?void 0:t.timestamp,!0)):"No checkpoints found":"Cannot restore checkpoint: Devin is not running",[s,t,a,r]);return(0,n.jsx)("div",{className:"flex items-center justify-center dark:text-white",children:(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:d}),side:"left",className:"mr-2 px-2 py-1",delayDuration:100,onPointerDownOutside:e=>{e.preventDefault()},children:(0,n.jsx)("div",{className:"w-full",children:(0,n.jsx)("button",{disabled:-1!==a||!s||!t||r,onClick:()=>{t5.Z.trackInteraction(t5.j.RESTORE_CHECKPOINT),o(l),i(!0)},className:(0,f.Z)(" flex w-full items-center justify-center",s&&t&&!r?"cursor-pointer":"cursor-not-allowed opacity-40","focus:outline-none"),children:(0,n.jsx)(lu.y,{size:24,className:-1!==a?"text-gray-400":""})})})})})},lQ=e=>{let{onRestore:t,rollbackFunction:s}=e,[a,l]=(0,b.KO)(aC.ON),[r]=(0,b.KO)(aC.So),[i,o]=(0,N.useState)({checkpoint:null,masterPlan:null}),{allEvents:d,timelineActions:{exitReplayMode:c,selectAlternateTimeline:u}}=(0,D.j1)();return(0,N.useEffect)(()=>{if(r){let{checkpoint:e,masterPlan:t}=l0(d,r);o({checkpoint:e,masterPlan:t})}},[d,r]),(0,n.jsx)(tV.Vq,{open:a,onOpenChange:l,children:(0,n.jsxs)(tV.cZ,{className:"text-slate-800 sm:max-w-[625px]",children:[(0,n.jsxs)(tV.fK,{children:[(0,n.jsx)(tV.$N,{className:"mb-3 text-2xl tracking-tight",children:"Restore checkpoint"}),(0,n.jsxs)(tV.Be,{className:"font-medium  dark:text-slate-200",children:["Restoring a checkpoint will rewind Devin's brain and machine to a previous point in time."," ",(0,n.jsx)("span",{className:"text-red-500",children:"It will kill any running shell processes."})]}),(0,n.jsx)(tV.Be,{className:"mx-0.5 flex flex-col pb-4 pt-4 tracking-wide text-slate-800 dark:text-slate-200",children:"All the actions and messages that occurred after the checkpoint will be undone. Devin's file system will be reverted to the state it was in when the checkpoint was created. Devin's brain and plan will also be reverted accordingly."})]}),(0,n.jsxs)("div",{className:"flex flex-col space-y-2.5 pb-4",children:[i.checkpoint&&(0,n.jsxs)(tV.Be,{className:"font-bold dark:text-slate-200",children:["You are rewinding to"," ",(0,ln.i)(i.checkpoint.timestamp,!0),". Proceed?"]}),!i.checkpoint&&(0,n.jsx)(tV.Be,{className:"font-medium",children:"Error: No checkpoint available to restore"}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)(tO.z,{className:"mt-2",type:"submit",loading:!1,onClick:()=>{s(i.checkpoint.checkpoint_id,i.masterPlan),c(),u(-1),l(!1),t()},theme:"primary",size:"sm",disabled:!i.checkpoint,defaultTitle:"Confirm"})})]})]})})},l0=(e,t)=>{let s={plan:"",currentStep:""},a=null;for(let l of e){if(l.timestampMs>t)break;(0,tx.h6)(l)?"updated_master_plan"===l.type||"user_update_master_plan"==l.type?s.plan=l.plan:"new_master_plan_step"===l.type&&(s.currentStep=l.step):(0,tx.pY)(l)&&(a=l)}return{checkpoint:a,masterPlan:s}};var l1=s(41656);let l2=()=>{let{timelineActions:{selectAlternateTimeline:e},timelineState:{alternateTimelines:t,selectedTimelineIndex:s}}=(0,D.j1)(),a=t.map((e,t)=>{let{timestamp:s}=e;return{label:"Past Timeline @ ".concat((0,ln.i)(s,!0)),value:"".concat(t)}}).concat({label:"Active Timeline",value:"-1"});return(0,n.jsx)(tO.P,{className:"w-full",itemsList:a,value:"".concat(s),onValueChange:t=>e(parseInt(t))})};function l5(e){let{workspaceRef:t,isDemoMode:s}=e,[a,,l]=(0,l$.F)(),{timelineState:{isScrubbingEnabled:r,currentTimestamp:i,isReplayMode:o,relevantTimestamps:d,relevantEvents:c},bufferState:u,devinState:{status:m},features:{checkpointingFeatureEnabled:x,revivingFeatureEnabled:h},allEvents:p,timelineActions:{setTimestamp:f,exitReplayMode:g,selectAlternateTimeline:v}}=(0,D.j1)(),{devinState:j,timelineState:{alternateTimelines:k,selectedTimelineIndex:y}}=(0,D.j1)(),{immersiveLiveMode:C}=(0,e6.k)(),_=p.length>0&&"finished"!==m.enum&&-1===y,[S,E]=(0,b.KO)(F.is),T=(0,N.useCallback)(()=>{t5.Z.trackInteraction(t5.j.HISTORY_NEXT);let e=w().find(d,e=>e>i);e&&f(e),e===w().last(d)&&g()},[d,i,f,g]),M=(0,N.useCallback)(()=>{t5.Z.trackInteraction(t5.j.HISTORY_PREVIOUS);let e=w().findLast(d,e=>e<i);e&&f(e)},[d,i,f]),A=(0,N.useCallback)(e=>{null==a||a.setTimestamp(e),f(e)},[a,f]);(0,N.useEffect)(()=>{let e=t.current;if(!e)return;let s=e=>{requestAnimationFrame(()=>{switch(e.key){case"ArrowRight":T();break;case"ArrowLeft":M()}})};return e.addEventListener("keydown",s),()=>{e.removeEventListener("keydown",s)}},[t,T,M]);let O=(0,eT.tw)();return(0,n.jsxs)("div",{className:"timeline-controls",children:[d&&(!C||!s)&&(0,n.jsx)(lG,{timestampsList:d,bufferState:u,disabled:!r,timestamp:i,isTimelineLoading:l,exitReplayMode:g,setTimestamp:A}),(0,n.jsxs)("div",{className:"dark:border-night dark:bg-night flex justify-between rounded-b-lg !border-t-0 bg-slate-100 align-middle",children:[(0,n.jsxs)("div",{className:"timeline-controls--main dark:border-night dark:bg-night flex ",children:[(0,n.jsx)(ed.M,{children:S&&(0,n.jsx)(sD.u,{className:"px-2 py-1",delayDuration:100,side:"top",content:"Skip to the previous event in ".concat(S),children:(0,n.jsx)(eo.E.button,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>{let e;if(t5.Z.trackInteraction(t5.j.HISTORY_REWIND),!S)return;let t=0,s=c.findIndex(e=>e.timestampMs===i),a=S;for(;t<s;){let s=c[t++];(a=(0,tx.dr)(s)?s.app:(0,tx.Fs)(s)?"shell":(0,tx.yi)(s)?"editor":a)===S&&(e=s.timestampMs)}e&&f(e)},className:"focus:outline-none",children:(0,n.jsx)(lW.F,{className:"dark:text-white"})})})}),(0,n.jsx)("button",{onClick:M,className:"focus:outline-none",children:(0,n.jsx)(lq.k,{className:"dark:text-white"})}),(0,n.jsx)("button",{onClick:T,className:"focus:outline-none",children:(0,n.jsx)(lB.V,{className:"dark:text-white"})}),(0,n.jsx)(ed.M,{children:S&&(0,n.jsx)(sD.u,{className:"px-2 py-1",delayDuration:100,side:"top",content:"Skip to the next event in ".concat(S),children:(0,n.jsx)(eo.E.button,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>{let e;if(t5.Z.trackInteraction(t5.j.HISTORY_FASTFORWARD),!S)return;let t=S,s=c.findIndex(e=>e.timestampMs===i);for(;s<c.length;){let a=c[++s];if(!a)break;let l=(0,tx.dr)(a)?a.app:(0,tx.Fs)(a)?"shell":(0,tx.yi)(a)?"editor":void 0;if((0,tx.dr)(a)||(0,tx.Fs)(a)||(0,tx.yi)(a)){if(l===S){e=a.timestampMs;break}l&&(t=l)}else if(t===S){e=a.timestampMs;break}}e&&f(e),e===w().last(d)&&g()},className:"focus:outline-none",children:(0,n.jsx)(lY.Z,{className:"dark:text-white"})})})}),_&&(0,n.jsxs)("button",{onClick:()=>{t5.Z.trackInteraction(t5.j.HISTORY_LIVE),f(w().last(d)),g(),E(null),v(-1)},className:(0,eD.cn)("timeline-controls--live-indicator inline-flex items-center dark:text-white",o?"cursor-pointer":"cursor-default"),children:[(0,n.jsx)("div",{className:(0,eD.cn)("h-3 w-3 rounded-full border border-[#FF5E5E] bg-[#FF5E5E]",(o||"finished"===j.status.enum)&&(!C||!s)&&"dark:border-cloud border-neutral-400 bg-neutral-100 dark:bg-transparent")}),(0,n.jsx)("span",{className:"ml-1",children:"Live"})]}),k.length>0&&(0,n.jsx)(l2,{})]}),(0,n.jsx)("div",{className:"mr-4 flex min-h-full",children:x&&(0,n.jsx)(n.Fragment,{children:"finished"!==j.status.enum?(0,n.jsx)(lX,{isRunning:!0,selectedTimelineIndex:y,latestCheckpoint:j.latestCheckpoint,timestamp:i,disabled:!o}):h&&O&&(0,n.jsx)(l1.TJ,{selectedTimelineIndex:y,latestCheckpoint:j.latestCheckpoint,timestamp:i})})})]})]})}s(79037);var l4=s(36441),l8=s(75419);let l3=e=>{let{runStatus:t,isReplayMode:s,devinId:a}=e,{wasSnapshotAlreadyTaken:l,openSnapshotDialog:r,snapshotUsed:i}=lr(a),{shouldRestrictFeatures:o}=(0,eb.b1)(),d=(0,N.useMemo)(()=>!l&&(!!s||"finished"!==t&&"blocked"!==t||!!o),[s,t,l,o]),c=(0,N.useMemo)(()=>s?"You cannot take a snapshot while you are replaying.":"finished"===t||"blocked"===t?"You may only take a snapshot when Devin is paused or finished.":"You cannot take a snapshot while Devin is running.",[s,t]);return(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:c}),side:"left",className:"mr-4 px-2 py-1",delayDuration:100,disabled:!d||o,children:(0,n.jsx)("div",{children:l?(0,n.jsx)(t_,{disabled:d,children:(0,n.jsxs)("div",{onClick:()=>(0,l8.K)((null==i?void 0:i.snapshot_id)||""),className:"group flex h-full w-max items-center dark:text-white",children:[(0,n.jsx)("div",{className:"cursor-pointer truncate duration-100",children:"Copy snapshot url"}),(0,n.jsx)(l4.K,{size:13,className:"ml-2 opacity-0 duration-75 group-hover:opacity-100"})]})}):(0,n.jsx)(eb.Hd,{side:"left",children:(0,n.jsx)("div",{children:(0,n.jsx)(t_,{disabled:d,children:(0,n.jsx)("div",{className:"w-full",children:(0,n.jsx)("button",{onClick:r,disabled:d,className:(0,f.Z)(" w-full text-left",d?"cursor-not-allowed opacity-40":"cursor-pointer"),children:"Create machine snapshot"})})})})})})})},l6=e=>{let{onKill:t,isRunFinished:s,devinId:a}=e,[l,r]=(0,b.KO)(aC.kJ),i=(0,y.useRouter)();return(0,n.jsx)(tV.Vq,{open:l,onOpenChange:r,children:(0,n.jsxs)(tV.cZ,{className:"sm:max-w-[625px]",children:[(0,n.jsxs)(tV.fK,{children:[(0,n.jsx)(tV.$N,{className:"mb-1 text-3xl tracking-tight",children:"Create New Snapshot"}),(0,n.jsx)(tV.Be,{className:"font-medium text-red-500",children:s?"Note: Taking a snapshot kills its session and any hosted services.":"Warning: Taking a snapshot will kill your current session and any hosted services!"}),(0,n.jsxs)(tV.Be,{className:"mx-0.5 flex flex-col pb-4 pt-4 tracking-wide text-slate-800 dark:text-slate-200",children:["Your snapshot will capture the current state of Devin's machine (loading time is approximately 15-30 minutes from session end). Going forward, you'll be able to select this snapshot when starting a new session with Devin!",(0,n.jsx)("a",{href:"https://docs.devin.ai/Onboard_Devin/snapshots",className:"hover:text-pacific mt-2 w-fit underline duration-100",target:"_blank",children:"Learn more here."})]})]}),(0,n.jsx)("div",{className:"flex flex-col space-y-2.5 pb-4",children:(0,n.jsx)(l7,{onSuccess:()=>{r(!1),i.push("/")},onKill:t,devinId:a})})]})})},l7=e=>{let{onSuccess:t,onKill:s,devinId:a}=e,[l,r]=(0,N.useState)(!1),[i,o]=(0,N.useState)(!1),[c,u]=(0,N.useState)([]),[m,x]=(0,N.useState)(""),[h,p]=(0,N.useState)(""),f=(0,N.useCallback)(async()=>{let e=await (0,e_.DE)(a);e&&(u(e.startup_commands||[]),p(e.description||""))},[a]);(0,N.useEffect)(()=>{f()},[f,a]);let g=(0,N.useCallback)(async e=>{if(e.preventDefault(),!i)try{r(!1),o(!0),s(),await (0,e_.Ox)(a,m,h,c),t()}catch(e){r(!0)}finally{o(!1)}},[a,t,i,s,c,m,h]);return(0,n.jsxs)("form",{className:"items w-full",onSubmit:g,children:[l&&(0,n.jsx)(sl.b,{status:"error",className:"mb-8 text-xs",children:"There was a problem submitting your request. Please try again in a moment."}),(0,n.jsxs)("div",{className:"mb-6 flex flex-col",children:[(0,n.jsx)("label",{htmlFor:"snapshot_name",className:"mx-1 text-sm font-medium text-gray-700 dark:text-gray-200",children:"Snapshot name"}),(0,n.jsx)("input",{className:"mb-4 mt-1 min-w-full resize-none rounded-sm border pl-2 text-[0.8rem] leading-8 dark:border-none",type:"text",placeholder:"Snapshot name",required:!0,value:m,onChange:e=>x(e.target.value),maxLength:255}),(0,n.jsxs)("label",{htmlFor:"description",className:"mx-1 text-sm font-medium text-gray-700 dark:text-gray-200",children:["Snapshot description",(0,n.jsx)("span",{className:"ml-1 text-xs font-normal",children:"(IMPORTANT: Devin needs this to understand the snapshot contents)"})]}),(0,n.jsx)("textarea",{className:"mb-2 mt-1 min-w-full resize-none rounded-sm border px-2 py-1.5 text-[0.8rem] leading-relaxed dark:border-none",placeholder:"Snapshot description",value:h,onChange:e=>p(e.target.value),rows:3}),(0,n.jsx)(sW.Z,{isInModal:!0,isEditing:!0,snapshotStartupCommands:c,setSnapshotStartupCommands:u})]}),(0,n.jsxs)("button",{className:"bg-pacific ml-auto flex items-center rounded-md px-4 py-2 text-center text-white duration-150 hover:bg-blue-500 disabled:cursor-not-allowed disabled:bg-gray-300 disabled:text-gray-600",disabled:i,children:[!i&&(0,n.jsx)("span",{className:"text-sm",children:"Create snapshot & kill session"}),i&&(0,n.jsx)("div",{className:"flex justify-center text-sm",children:(0,n.jsx)(d.U,{size:24,className:"animate-spin"})})]})]})};var l9=s(382),ne=s(4382),nt=s(75147),ns=s(84323),na=s(80070),nl=s(97946),nn=s(13784),nr=s(32609),ni=s(34750);s(45793);let no=e=>{var t;let{allTabs:s,shouldFollow:a,activeFilename:l}=e,[r,i]=(0,N.useState)(l||(null===(t=s[0])||void 0===t?void 0:t.filename)),d=s.some(e=>e.loading),[c]=(0,b.KO)(F.vl);(0,N.useEffect)(()=>{var e,t;r&&!s.find(e=>e.filename===r)&&i(null===(e=s[0])||void 0===e?void 0:e.filename),!r&&s.length&&i(null===(t=s[0])||void 0===t?void 0:t.filename)},[a,r,s]),(0,aH.Z)(()=>{a&&i(l)},[a,l]),(0,aH.Z)(()=>{if(!window.matchMedia("(max-width: 1279px)").matches){let e=document.getElementById("tab-".concat(r));e&&e.scrollIntoView({behavior:"instant",block:"nearest",inline:"center"})}},[r]);let u=(0,N.useMemo)(()=>s.find(e=>e.filename===r),[s,r]),[m,x]=(0,b.KO)(F.Ot),[h,p]=(0,b.KO)(F.g4),[f,g]=(0,b.KO)(F.D7),v=()=>(0,l9.u)(s,c),j=(0,N.useCallback)(()=>x(!1),[x]);return s.length?(0,n.jsxs)("div",{className:"flex h-full flex-col",children:[(0,n.jsxs)("div",{className:"relative flex overflow-hidden  bg-white dark:bg-zinc-900",children:[(0,n.jsx)("div",{className:"no-scrollbar flex w-full items-center overflow-x-auto pr-[132px]","data-mobile-draggable-allow":!0,style:{scrollbarWidth:"thin"},children:(0,n.jsx)(nl.x,{allTabs:s.map(e=>({id:e.filename,firstActive:e.firstActive,lastActive:e.lastActive})),formatter:e=>w().last(e.split("/")),active:r,setActive:i})}),(0,n.jsx)("div",{children:(0,n.jsxs)(lH.sX,{className:"bg-white dark:bg-zinc-900",children:[(0,n.jsx)(na.K,{onClick:()=>{t5.Z.trackInteraction(t5.j.EDITOR_EXPAND),x(!m)},isActive:m,title:"Expand editor",children:(0,n.jsx)(e0.S,{size:18})}),(0,n.jsx)(na.K,{onClick:()=>{t5.Z.trackInteraction(t5.j.EDITOR_TOGGLE_DIFF),g(!f)},isActive:f,title:"View comparison with previous state",children:(0,n.jsx)(ne.k,{size:18})}),(0,n.jsx)(na.K,{onClick:()=>{t5.Z.trackInteraction(t5.j.EDITOR_VIEW_GLOBAL_WORK_DIFF),p(!0)},isActive:h,title:"View global work diff",children:(0,n.jsx)(o.Q,{size:18})}),(0,n.jsx)(na.K,{onClick:()=>{t5.Z.trackInteraction(t5.j.EDITOR_DOWNLOAD_FILES),v()},title:d?"Files are loading":"Download",disabled:d,children:(0,n.jsx)(aA.U,{size:18})}),m&&(0,n.jsx)(lH.mH,{onClose:j,open:m,allTabs:s,activeFilename:r,setActiveFilename:i,isShowingDiff:f,setIsShowingDiff:g,onDownload:v,areFilesLoading:d})]})})]}),(0,n.jsx)(lH.a_,{activeFilename:r}),u&&(0,n.jsx)("div",{className:"editor-app--monaco-wrapper overflow-hidden py-4",children:(0,n.jsx)("div",{className:"editor-app--monaco-container","data-mobile-draggable-allow":!0,children:(0,n.jsx)(n.Fragment,{children:f?(0,n.jsx)(nu,{data:u}):(0,n.jsx)(nc,{data:u,activeFilename:r})})})})]}):(0,n.jsx)("div",{className:"flex h-full flex-col",children:(0,n.jsx)(nd,{})})},nd=()=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,n.jsx)("p",{className:"text-neutral-400",children:"Devin has no code to share yet!"})})}),nc=e=>{let{data:t,activeFilename:s}=e,[,,a,,l]=(0,ns.j)(t.filename),{handleEditorDidMount:i}=(0,nt.L)(l),{resolvedTheme:o}=(0,ec.F)(),d=(0,nr.n)(),{isSignedIn:c}=(0,T.aC)(),u=(0,F.Q6)(e=>e.addSelection),m=(0,ni.x)({filename:t.filename,getDomNode(e){let t=document.createElement("button");return t.innerHTML="Add to chat",t.className="!ml-0.5 mt-1.5 ring-2 text-sm shadow-sm shadow-gray-900 ring-sky rounded-sm bg-[hsl(216,34%,37%)] dark:bg-[hsl(216,34%,17%)] transition px-2.5 py-1 font-light text-white absolute z-10 w-max",t.addEventListener("click",()=>{u(e)}),t}}),{value:x,loading:h}=(0,st.Z)(async()=>{if(c)return(await (0,e_.o)(d)).link},[d,c]);return a||h?(0,n.jsx)("div",{className:"dark:bg-night flex h-full w-full items-center justify-center align-middle",children:(0,n.jsx)(tz.g,{})}):(0,n.jsx)(r.ZP,{options:{readOnly:!0,minimap:{renderCharacters:!1},readOnlyMessage:{value:"<a href='".concat(x,"'>Open VSCode in Devin's Machine</a>"),supportHtml:!0,isTrusted:!0}},theme:"dark"===o?"vs-dark":"vs-light",loading:(0,n.jsx)("div",{className:"bg-shade-50 dark:bg-night flex h-full w-full items-center justify-center align-middle",children:(0,n.jsx)(tz.g,{})}),path:"small".concat(s),value:t.contents,className:"font-mono",onMount:(e,t)=>{i(e,t),m(e)}},"".concat(t.contents,"-").concat(o))},nu=e=>{let{data:t}=e,[s,a,l]=(0,ns.j)(t.filename),{resolvedTheme:i}=(0,ec.F)(),{loadManager:o}=(0,N.useContext)(nn.Z);return(o&&!a&&o.requestHighPriorityDownload(e=>"editor_update"===e.type&&e.file===t.filename),l)?(0,n.jsx)("div",{className:"dark:bg-night flex h-full items-center justify-center align-middle",children:(0,n.jsx)(tz.g,{})}):(0,n.jsx)(r.SV,{options:{readOnly:!0,ignoreTrimWhitespace:!1,renderSideBySide:!0},theme:"dark"===i?"vs-dark":"vs-light",loading:(0,n.jsx)("div",{className:"dark:bg-night flex h-full w-full items-center justify-center align-middle",children:(0,n.jsx)(tz.g,{})}),original:s,modified:a,className:"bg-white font-mono dark:bg-zinc-900"},"".concat(a,"-").concat(i))};var nm=s(21338),nx=s(36709),nh=s(55072),np=s(80420);s(53645);var nf=s(78745),ng=s.n(nf),nb=s(29843),nv=s(84946);let nj=(0,nb.Cl)(),nw=[nj.accessor("command",{cell:e=>e.getValue(),header:()=>"Command History"}),nj.accessor("outputTrunc",{cell:e=>{var t;return null!==(t=e.getValue())&&void 0!==t?t:""},header:()=>"Output"}),nj.accessor("shellName",{cell:e=>e.getValue(),header:()=>"Shell"}),nj.accessor(e=>{if(e.endingTimestampMs){let t=e.endingTimestampMs-e.startingTimestampMs,s=t<6e4?"".concat((t/1e3).toFixed(1),"s"):t<36e5?"".concat((t/6e4).toFixed(1),"min"):"".concat((t/36e5).toFixed(1),"h");return e.aborted?"".concat(s," (aborted)"):"0"!==e.exitCode?"".concat(s," (exit code: ").concat(e.exitCode,")"):s}return e.isFuture?"":"Running"},{id:"duration",cell:e=>(0,n.jsx)("span",{title:e.getValue(),children:e.getValue()}),header:()=>"Duration"}),nj.accessor(e=>({shortTimestamp:(0,ln.i)(e.startingTimestampMs,!0),fullTimestamp:(0,ln.x)(e.startingTimestampMs)}),{id:"timestamps",cell:e=>(0,n.jsx)("span",{title:e.getValue().fullTimestamp,children:e.getValue().shortTimestamp}),header:()=>"Start Timestamp"})],nk=e=>"command"===e?"40%":"timestamps"===e?"25%":"auto",ny=e=>{let{history:t,jumpToCommand:s}=e,a=(0,nv.b7)({data:t.commands,columns:nw,getCoreRowModel:(0,nb.sC)()}),l=e=>{var t;navigator.clipboard.writeText(null!==(t=e.outputTrunc)&&void 0!==t?t:"")},r=e=>{navigator.clipboard.writeText(e.command)};return(0,N.useEffect)(()=>{let e=document.querySelector(".futureShellCommand");e&&e.scrollIntoView({behavior:"smooth",block:"center"})},[s,t]),(0,n.jsxs)("div",{className:"jsx-ef98e2dd0a5261d2 flex h-full w-full flex-col overflow-auto border-t border-neutral-300 dark:border-neutral-600",children:[(0,n.jsxs)("table",{className:"jsx-ef98e2dd0a5261d2 shell-history-table w-full",children:[(0,n.jsx)("thead",{className:"jsx-ef98e2dd0a5261d2 sticky top-0 bg-gray-200 dark:bg-black",children:a.getHeaderGroups().map(e=>(0,n.jsxs)("tr",{className:"jsx-ef98e2dd0a5261d2",children:[(0,n.jsx)("th",{style:{width:"3%"},className:"jsx-ef98e2dd0a5261d2"}),e.headers.map(e=>(0,n.jsx)("th",{style:{width:nk(e.id)},className:"jsx-ef98e2dd0a5261d2",children:e.isPlaceholder?null:(0,nv.ie)(e.column.columnDef.header,e.getContext())},e.id))]},e.id))}),(0,n.jsx)("tbody",{className:"jsx-ef98e2dd0a5261d2",children:a.getRowModel().rows.map(e=>(0,n.jsxs)("tr",{onClick:()=>s(e.original),className:"jsx-ef98e2dd0a5261d2 "+((0,f.W)({futureShellCommand:e.original.isFuture})||""),children:[(0,n.jsxs)("td",{style:{width:"3%"},className:"jsx-ef98e2dd0a5261d2 dropdown",children:[(0,n.jsxs)(eh.h_,{modal:!1,children:[(0,n.jsx)(eh.$F,{asChild:!0,onClick:e=>{e.preventDefault(),e.stopPropagation()},children:(0,n.jsx)("button",{className:"jsx-ef98e2dd0a5261d2 block h-full w-2 align-middle text-lg",children:(0,n.jsx)(es.F,{})})}),(0,n.jsxs)(eh.AW,{side:"left",className:"dark:border-cloud dark:bg-input-dark w-56 bg-white",children:[(0,n.jsx)(eh.Xi,{className:"",onClick:()=>r(e.original),children:(0,n.jsx)("span",{className:"jsx-ef98e2dd0a5261d2 ml-2 dark:text-white",children:"Copy Command"})}),(0,n.jsx)(eh.Xi,{className:"",disabled:void 0===e.original.outputTrunc,title:void 0===e.original.outputTrunc?"No output":void 0,onClick:()=>l(e.original),children:(0,n.jsx)("span",{className:"jsx-ef98e2dd0a5261d2 ml-2 dark:text-white",children:"Copy Output"})})]})]})," "]}),e.getVisibleCells().map(t=>(0,n.jsx)("td",{className:"jsx-ef98e2dd0a5261d2 "+((0,f.W)("font-mono ",e.original.isFuture?"dark:text-neutral-400":"dark:text-neutral-200")||""),children:(0,nv.ie)(t.column.columnDef.cell,t.getContext())},t.id))]},e.id))})]}),(0,n.jsx)(ng(),{id:"ef98e2dd0a5261d2",children:".shell-history-table.jsx-ef98e2dd0a5261d2{font-size:.75rem;table-layout:fixed}.shell-history-table.jsx-ef98e2dd0a5261d2 td.jsx-ef98e2dd0a5261d2{overflow:hidden;white-space:nowrap;padding:2px 8px;-o-text-overflow:ellipsis;text-overflow:ellipsis;cursor:pointer}.futureShellCommand.jsx-ef98e2dd0a5261d2{font-style:italic;color:#8f8f8f}.dropdown.jsx-ef98e2dd0a5261d2{opacity:0;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-transition:opacity.2s;-moz-transition:opacity.2s;-o-transition:opacity.2s;transition:opacity.2s}tr.jsx-ef98e2dd0a5261d2:hover .dropdown.jsx-ef98e2dd0a5261d2{opacity:1}"})]})};var nN=s(26628);let nC={foreground:"#d8d8d8",background:"rgb(36,36,36)",cursor:"#d8d8d8",black:"rgb(36,36,36)",red:"#ab4642",green:"#a1b56c",yellow:"#f7ca88",blue:"#7cafc2",magenta:"#ba8baf",cyan:"#86c1b9",white:"#d8d8d8",brightBlack:"#585858",brightRed:"#ab4642",brightGreen:"#a1b56c",brightYellow:"#f7ca88",brightBlue:"#7cafc2",brightMagenta:"#ba8baf",brightCyan:"#86c1b9",brightWhite:"#f8f8f8"},n_={foreground:"#333333",background:"#ffffff",cursor:"#333333",black:"#000000",red:"#cd3131",green:"#00BC00",yellow:"#949800",blue:"#0451a5",magenta:"#bc05bc",cyan:"#0598bc",white:"#555555",brightBlack:"#666666",brightRed:"#cd3131",brightGreen:"#14CE14",brightYellow:"#b5ba00",brightBlue:"#0451a5",brightMagenta:"#bc05bc",brightCyan:"#0598bc",brightWhite:"#a5a5a5",selectionBackground:"#e0e0e0"},nS=e=>(0,n.jsxs)("div",{className:"shell-app dark:bg-night flex h-full flex-col items-stretch rounded-tl-sm rounded-tr-sm dark:text-white",children:[(0,N.createElement)(nD,{...e,key:e.activeTabId||"default"}),(0,n.jsx)(nE,{...e})]}),nE=e=>{let{shellCommandHistory:t}=e,{timelineState:{getNextRelevantTimestamp:s},timelineActions:{setTimestamp:a}}=(0,D.j1)(),l=(0,b.Dv)(F.x3);return(0,n.jsx)(n.Fragment,{children:t.commands.length>0&&l&&(0,n.jsx)("div",{className:"flex max-h-[40%] flex-[2] flex-col items-stretch",children:(0,n.jsx)(ny,{history:t,jumpToCommand:e=>{let{startingTimestampMs:t}=e;a(s(t))}})})})},nD=e=>{let[t,s]=(0,N.useState)(e.activeTabId),[a,l]=(0,b.KO)(F.x3),r=(0,N.useMemo)(()=>{var s;return null!==(s=e.allTabs.find(e=>e.id===t))&&void 0!==s?s:e.allTabs.find(e=>"default"===e.id)},[t,e.allTabs]);return(0,N.useEffect)(()=>{"default"===e.activeTabId||e.allTabs.find(e=>e.id===t)||s("default")},[e.shouldFollow,e.activeTabId,t,e.allTabs]),(0,aH.Z)(()=>{e.shouldFollow&&s(e.activeTabId)},[e.shouldFollow,e.activeTabId]),(0,aH.Z)(()=>{if(!window.matchMedia("(max-width: 1279px)").matches){let e=document.getElementById("tab-".concat(t));e&&e.scrollIntoView({behavior:"instant",block:"nearest",inline:"center"})}},[t]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"relative flex overflow-hidden bg-white dark:bg-zinc-900",children:[(0,n.jsx)("div",{className:"no-scrollbar flex w-full items-center overflow-x-auto pr-[0px]","data-mobile-draggable-allow":!0,style:{scrollbarWidth:"thin"},children:(0,n.jsx)(nl.x,{allTabs:e.allTabs,active:t,setActive:s,className:"min-w-28 justify-center"})}),(0,n.jsx)("div",{className:"flex h-full flex-1 items-center border-b border-b-gray-300 px-4 dark:border-b-zinc-700",children:e.shellCommandHistory.commands.length>0&&(0,n.jsx)("div",{className:"space-around ml-auto flex items-center",children:(0,n.jsx)(na.K,{onClick:()=>{l(!a)},isActive:a,title:"Show Command History",children:(0,n.jsx)(nm.a,{size:18})})})})]}),r&&(0,n.jsxs)("div",{className:"relative flex flex-[3] flex-col items-stretch",children:[r.loading&&(0,n.jsx)("div",{className:"dark:bg-night/80 absolute z-50 flex h-full w-full items-center justify-center",children:(0,n.jsx)(tz.g,{weight:"bold"})}),(0,n.jsx)(nT,{loading:r.loading,contents:r.contents},r.id)]})]})},nT=e=>{let t=(0,N.useRef)(void 0),s=(0,N.useRef)(null),a=(0,N.useRef)(null),l=(0,N.useRef)(null),r=(0,N.useRef)(null),i=(0,N.useRef)(""),[o,d]=(0,N.useState)(!1),{resolvedTheme:c}=(0,ec.F)(),u=(0,N.useMemo)(()=>w().debounce(()=>{if(r.current&&a.current){let e=r.current.querySelector(".xterm-screen"),t=null==e?void 0:e.querySelector("canvas");e&&t&&(e.style.height="unset",a.current.fit(),e.style.height=t.style.height)}}),[]);(0,N.useEffect)(()=>{var n;if(!r.current||!l.current||t.current)return;let i=l.current.offsetHeight/l.current.offsetWidth*1.62,o=new np.Terminal({allowProposedApi:!0,cursorBlink:!1,cursorStyle:"underline",cursorInactiveStyle:"underline",fontFamily:'"Fira Code VF", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',fontWeight:400,fontWeightBold:500,fontSize:null!==(n=e.fontSize)&&void 0!==n?n:12,lineHeight:1.06,scrollback:5e3,rows:Math.floor(24*i),cols:80,theme:"dark"===c?nC:n_});try{let e=new nh.SearchAddon;o.loadAddon(e),s.current=e;let t=new nx.FitAddon;o.loadAddon(t),a.current=t;let l=new nN.WebglAddon;o.loadAddon(l)}catch(e){console.warn("WebGL not supported falling back to node rendering, error:",e)}r.current.innerHTML="",o.open(r.current),u(),t.current=o},[t,u,c,e.fontSize]),(0,N.useEffect)(()=>{t.current&&(t.current.options.theme="dark"===c?nC:n_)},[c]),(0,N.useEffect)(()=>{let s=t.current;if(!s)return;let a=e.contents;if(i.current&&a.startsWith(i.current)){let e=a.replace(i.current,"");s.write(e)}else s.reset(),s.write(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;return e.split("\n").slice(-t).join("\n")}(a,e.truncationLimit));i.current=a},[t,e.contents]),(0,N.useEffect)(()=>{let e=new ResizeObserver(u);return e.observe(l.current),u(),()=>{null==e||e.disconnect()}},[l,u]),(0,N.useEffect)(()=>{let e=setInterval(()=>{if(!t.current)return;let{baseY:e,viewportY:s}=t.current.buffer.active;d(e!==s)},1e3);return()=>{clearInterval(e)}},[]);let[m]=(0,em.Z)("disable-scroll-in-shell",!1);return function(e,t,s){let a=(0,N.useMemo)(()=>w().debounce(()=>{let t=e.current.element.querySelector(".xterm-viewport"),s=document.querySelector("#shell-scrollbar"),a=document.querySelector("#shell-scrollbar-thumb");if(!s||!a||!t)return;let l=t.scrollTop/t.scrollHeight*s.clientHeight,n=s.clientHeight/t.scrollHeight;a.style.height="".concat(100*Math.min(n,1),"%"),a.style.transform="translateY(".concat(Math.max(Math.min(l,0),s.clientHeight-a.offsetHeight),"px)")}),[e]);(0,N.useEffect)(()=>{var l;if(t||s)return;a();let n=null===(l=e.current)||void 0===l?void 0:l.buffer.onBufferChange(a);return()=>{null==n||n.dispose()}},[a,e,t,s]),(0,N.useEffect)(()=>{if(t||s)return;let l=e.current;if(!l)return;let n=l.element;if(!n)return;let r=n.querySelector(".xterm-viewport");if(!r)return;let i=document.querySelector("#shell-scrollbar"),o=document.querySelector("#shell-scrollbar-thumb"),d=!1,c=0,u=0,m=e=>{d=!0,c=e,u=r.scrollTop,document.body.style.userSelect="none"},x=e=>{if(!d)return;let t=u+(e-c)*r.scrollHeight/i.clientHeight;r.scrollTop=t;let s=t/r.scrollHeight*i.clientHeight,a=i.clientHeight-o.offsetHeight;o.style.transform="translateY(".concat(Math.min(Math.max(s,0),a),"px)")},h=()=>{d=!1,document.body.style.userSelect="auto"},p=e=>m(e.clientY),f=e=>x(e.clientY),g=()=>h(),b=e=>m(e.touches[0].clientY),v=e=>x(e.touches[0].clientY),j=()=>h(),w=e=>{if(e.target===o)return;let t=(e.clientY-i.getBoundingClientRect().top)/i.clientHeight*r.scrollHeight;r.scrollTop=t,a()};return i.addEventListener("click",w),o.addEventListener("mousedown",p),document.addEventListener("mousemove",f),document.addEventListener("mouseup",g),o.addEventListener("touchstart",b),document.addEventListener("touchmove",v),document.addEventListener("touchend",j),r.addEventListener("scroll",a),()=>{i.removeEventListener("click",w),o.removeEventListener("mousedown",p),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),o.removeEventListener("touchstart",b),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",j),r.removeEventListener("scroll",a)}},[t,e,a,s])}(t,e.loading,!!m),(0,n.jsxs)("div",{ref:l,className:"shell-app--xterm-container","data-mobile-draggable-allow":!0,children:[(0,n.jsxs)("div",{className:"shell-app--xterm-inner w-full",children:[(0,n.jsx)("div",{ref:r,className:"h-full w-full"}),(0,n.jsx)(ed.M,{mode:"wait",children:o&&(0,n.jsx)(eo.E.button,{initial:{scale:0},animate:{scale:1},exit:{scale:0},onClick:()=>{var e;null===(e=t.current)||void 0===e||e.scrollToBottom()},className:"absolute bottom-[5px] right-4 z-30 flex h-8 w-8 items-center justify-center rounded-full bg-neutral-500",children:(0,n.jsx)(aF.K,{className:"h-4 w-4 text-white"})})})]}),(0,n.jsx)("div",{className:"dark:bg-input-dark absolute right-0 h-full w-2 bg-slate-50",id:"shell-scrollbar",children:(0,n.jsx)("button",{tabIndex:-1,id:"shell-scrollbar-thumb",className:"dark:hover:bg-cloud/70 dark:active:bg-cloud/70 dark:bg-cloud/50 relative z-10 h-20 w-full cursor-pointer rounded-md bg-slate-200/50 transition-colors hover:bg-slate-300/70 active:bg-slate-300/70"})})]})};var nF=e=>{let{devinId:t}=e,[s,a]=(0,N.useState)(!1),[l,r]=(0,N.useState)(tg.iW.EVAL_PROMPT),[i,o]=(0,N.useState)(""),[d,c]=(0,N.useState)(!1),[u,m]=(0,N.useState)(null),[x,h]=(0,N.useState)(null);return(0,n.jsx)(sD.u,{content:"Verify (experimental)",className:"p-2",children:(0,n.jsxs)("div",{className:"scale-[0.9]",children:[(0,n.jsx)("button",{onClick:()=>a(!0),className:"flex items-center justify-center rounded-md border border-gray-300 px-4 py-2 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"☑️"}),s&&(0,n.jsx)(tV.Vq,{open:s,onOpenChange:a,children:(0,n.jsxs)(tV.cZ,{className:"sm:max-w-md",children:[(0,n.jsx)(tV.fK,{children:(0,n.jsx)(tV.$N,{children:"Verify (experimental)"})}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),async function(){if(!l){console.error("No eval type selected");return}if(l===tg.iW.EVAL_COMMAND){h("Eval command not supported yet");return}if(0===i.length){h("Eval content is empty");return}if(!t){h("No devin id");return}c(!0),h(null);try{let e=await (0,tg.Yc)({eval_request:{id:Math.random(),type:l,content:i}},t);m(e)}catch(e){m(null),h("Error verifying devin")}c(!1)}()},children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{htmlFor:"type",className:"mb-2 block text-sm font-medium text-gray-700",children:"Type"}),(0,n.jsxs)("select",{id:"type",className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",value:l,onChange:e=>r(e.target.value),children:[(0,n.jsx)("option",{value:"",children:"Select type"}),(0,n.jsx)("option",{value:tg.iW.EVAL_PROMPT,children:tg.iW.EVAL_PROMPT}),(0,n.jsx)("option",{value:tg.iW.EDIT_EVAL_PROMPT,children:tg.iW.EDIT_EVAL_PROMPT}),(0,n.jsx)("option",{value:tg.iW.EVAL_COMMAND,children:tg.iW.EVAL_COMMAND})]})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{htmlFor:"content",className:"mb-2 block text-sm font-medium text-gray-700",children:"Content"}),(0,n.jsx)("textarea",{id:"content",rows:3,className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",onChange:e=>o(e.target.value)})]}),(0,n.jsxs)(tV.cN,{children:[(0,n.jsx)("button",{type:"button",onClick:()=>a(!1),className:"mr-2 rounded-md bg-gray-200 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"}),(0,n.jsx)("button",{type:"submit",disabled:d,className:"rounded-md bg-blue-500 px-4 py-2 text-sm font-medium text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ".concat(d?"cursor-not-allowed opacity-50":""),children:d?(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsxs)("svg",{className:"-ml-1 mr-3 h-5 w-5 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):"Submit"})]}),u&&(0,n.jsxs)("div",{className:"mt-4 rounded-md bg-gray-100 p-4",children:[(0,n.jsx)("h3",{className:"mb-2 text-lg font-semibold",children:"Evaluation Result"}),(0,n.jsxs)("p",{className:"text-md",children:["Eval score:"," ",(0,n.jsx)("span",{className:"font-bold text-blue-600",children:Number(u.eval_score).toFixed(2)})]})]}),x&&(0,n.jsxs)("div",{className:"mt-4 rounded-md bg-red-100 p-4",children:[(0,n.jsx)("h3",{className:"mb-2 text-lg font-semibold",children:"Error"}),(0,n.jsx)("p",{className:"text-md",children:x})]})]})]})})]})})},nM=s(40311),nA=s(48891);s(49563);var nO=s(60096),nz=s(91580);function nI(){let{timelineState:{currentTimestamp:e,relevantEvents:t},timelineActions:{setTimestamp:s},devinState:{activeApp:a}}=(0,D.j1)(),l=(0,N.useRef)(e),r=(0,N.useMemo)(()=>(function(e){let t=[];for(let s=0;s<e.length;s++){let a=e[s],l=e[s+1];((0,tx.KJ)(a)||(0,tx.yi)(a)||(0,tx.Fs)(a)&&(!l||!(0,tx.Fs)(l)||(0,tx.Fs)(l)&&l.shell_id!==a.shell_id)||(0,tx.dr)(a)||(0,tx.Bd)(a))&&t.push(a)}return t})(t),[t]),i=ef(),o=(0,N.useMemo)(()=>(function(e,t,s){var a,l;let r,i,o,d;let c=new Map,u=null,m=null!==(l=null===(a=e.findLast(e=>e.timestampMs<=t))||void 0===a?void 0:a.timestampMs)&&void 0!==l?l:t,x=[],h=0;for(;h<e.length;){let t=e[h-1];(!t||(0,tx.KJ)(t))&&(d={event_id:Math.random().toString(),message:"Devin is working...",timestamp:t?t.timestamp:e[0].timestamp,timestampMs:t?t.timestampMs:e[0].timestampMs,type:"progress_update"},x.push(d));let s=e[h];(0,tx.KJ)(s)?d&&Object.assign(d,{message:s.message,event_id:s.event_id,endTimestamp:s.timestampMs}):x.push(s),h++}return x.map((e,t)=>{if((0,tx.Fs)(e)||(u=null),(0,tx.KJ)(e))return(0,n.jsx)(nL,{setTimestamp:s,startTimestamp:e.timestampMs,endTimestamp:e.endTimestamp,message:e.message},t);if((0,tx.Bd)(e)){let a="eval_command"===e.query.type?"Command":"Prompt";return(0,n.jsx)(nL,{setTimestamp:s,startTimestamp:e.timestampMs,endTimestamp:e.timestampMs,message:"".concat(a,": ").concat(e.query.content," ").concat(e.eval_score>.8?"✅":"❌")},t)}if((0,tx.yi)(e)){let a=c.get(e.file),l=a!==e.contents;return c.set(e.file,e.contents||""),(0,n.jsx)(nZ,{setTimestamp:s,timestamp:e.timestampMs,currentTimestamp:m,message:"Editor: ".concat(a?l?"edited":"opened":"created"," '").concat(e.file.split("/").at(-1),"' file")},t)}if((0,tx.Fs)(e)){let a=u===e.shell_id;return(u=e.shell_id,a)?null:(0,n.jsx)(nZ,{setTimestamp:s,timestamp:e.timestampMs,currentTimestamp:m,message:"Terminal: ran command in '".concat(e.shell_id,"'")},t)}if((0,tx.dr)(e)){if("planner"===e.app){let a=!r,l=r!==e.plan;return r=e.plan,(0,n.jsx)(nZ,{setTimestamp:s,timestamp:e.timestampMs,currentTimestamp:m,message:"Planner: ".concat(a?"created":l?"edited":"viewed"," plan")},t)}if("browser"===e.app){let a=o!==e.screenshot_image_url;return i=e.url,o=e.screenshot_image_url,(0,n.jsx)(nZ,{setTimestamp:s,timestamp:e.timestampMs,currentTimestamp:m,message:"Browser: ".concat(i===e.url?a?"interacted with":"opened":"navigated to"," '").concat(e.url,"'")},t)}}return null})})(r,e,s),[r,e,s]);return(0,N.useEffect)(()=>{l.current=e},[e]),(0,N.useEffect)(()=>{let e=document.querySelector("[data-active-step]");e&&["lg","xl","2xl"].includes(i)&&(0,aq.Z)(e,{behavior:"smooth",block:"start",scrollMode:"if-needed"})},[i,e]),(0,n.jsxs)("div",{className:"flex h-full w-full flex-col gap-4 p-4 dark:text-white",children:[(0,n.jsx)("div",{className:"flex h-2/3 flex-[2] overflow-hidden",children:(0,n.jsx)("div",{className:"flex h-full w-full items-center",children:(0,n.jsx)(ed.M,{mode:"wait",children:(0,n.jsx)(eo.E.div,{transition:{type:"tween",duration:.3,ease:"easeInOut"},className:(0,f.Z)("flex max-h-full w-full grow flex-col gap-2","shell"===a&&"h-full"),children:(0,n.jsx)(nP,{})},"".concat(e,"-").concat(a))})})}),(0,n.jsx)("div",{className:"dark:border-cloud relative h-1/3 flex-1 overflow-y-auto rounded-lg border dark:bg-[#3b3b3b]",children:(0,n.jsx)("div",{className:"scrollbox py-2",children:o})})]})}function nL(e){let{startTimestamp:t,message:s,endTimestamp:a}=e;return(0,n.jsxs)("div",{className:"text-input-dark flex items-start gap-3 px-4 py-2 text-[15px] leading-5 dark:text-white",children:[(0,n.jsx)(aZ.f,{className:"mt-[3px] flex-shrink-0",size:20}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{children:s}),t&&(0,n.jsxs)("p",{className:"text-cloud mt-1",children:[(0,nM.WU)(t,"h:mma")," -"," ",a?(0,nM.WU)(a,"h:mma"):"Present"]})]})]})}function nZ(e){let{setTimestamp:t,timestamp:s,currentTimestamp:a,message:l}=e;return(0,n.jsxs)("div",{className:"ml-12 flex items-stretch pr-4 text-sm text-[#888888] dark:text-white",children:[(0,n.jsx)("div",{className:"dark:bg-cloud -my-[2px] min-h-[calc(100%+4px)] w-1 rounded-md bg-neutral-200"}),(0,n.jsxs)("div",{onClick:()=>t(s),"data-active-step":s===a||null,className:(0,f.Z)("dark:hover:bg-cloud/80 my-px ml-2 flex w-fit cursor-pointer items-center gap-2 rounded-md px-1.5 py-1 hover:bg-neutral-200/80",{"dark:bg-cloud/80 bg-neutral-200/80":s===a}),children:[(0,n.jsx)(aZ.f,{className:"flex-shrink-0",size:18}),(0,n.jsx)("span",{className:"leading-none",children:l}),(0,n.jsx)(X.T,{className:"ml-2 flex-shrink-0",size:18})]})]})}function nP(){let{devinState:{activeApp:e,allApplications:t,shellCommandHistory:s}}=(0,D.j1)();if("shell"===e){let e=w().maxBy(t.shell,e=>e.lastActive),a=s.commands.findLast(t=>!t.isFuture&&t.shellName===(null==e?void 0:e.id));return e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mb-1 text-center text-lg",children:e.prevContents?a?(0,n.jsxs)(n.Fragment,{children:["Ran"," ",(0,n.jsx)("span",{className:"dark:bg-input-dark rounded-sm bg-neutral-200 p-1 font-mono leading-none",children:a.command})," ","in"," ",(0,n.jsx)("span",{className:"dark:bg-input-dark rounded-sm bg-neutral-200 p-1 font-mono leading-none",children:e.id})]}):null:(0,n.jsxs)(n.Fragment,{children:["Started process"," ",(0,n.jsx)("span",{className:"dark:bg-input-dark rounded-sm bg-neutral-200 p-1 font-mono leading-none",children:e.id}),a&&(0,n.jsxs)(n.Fragment,{children:["and ran"," ",(0,n.jsx)("span",{className:"dark:bg-input-dark rounded-sm bg-neutral-200 p-1 font-mono leading-none",children:a.command})]})]})}),(0,n.jsx)(nU,{shell:e})]}):null}if("editor"===e){let e=w().maxBy(t.editor,e=>e.lastActive);return e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"mb-1 text-center text-lg",children:[e.prevContents?e.prevContents===e.contents?"Opened":"Edited":"Created"," ",(0,n.jsx)("span",{className:"dark:bg-input-dark rounded-sm bg-neutral-200 p-1 font-mono leading-none",children:e.filename})]}),(0,n.jsx)(nK,{editor:e,mode:e.prevContents!==e.contents&&e.prevContents?"diff":"view"})]}):null}if("planner"===e){let e=t.planner;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"mb-1 text-center text-lg",children:[e.prevContents?e.prevContents===e.contents?"Viewed":"Edited":"Created"," ","Plan"]}),(0,n.jsx)(nK,{editor:{...e,app:"editor",firstActive:0,lastActive:0,loading:!1,filename:"Plan",contents:e.contents,prevContents:e.prevContents},mode:e.prevContents!==e.contents&&e.prevContents?"diff":"view"})]})}if("browser"===e){let e=t.browser;return(0,n.jsxs)(n.Fragment,{children:[e.prevUrl===e.url?e.screenshotImageUrl===e.prevScreenshotImageUrl?(0,n.jsxs)("div",{className:"mb-1 text-center text-lg",children:["Interacted with"," ",(0,n.jsx)("span",{className:"dark:bg-input-dark rounded-sm bg-neutral-200 p-1 font-mono leading-none",children:e.url})]}):(0,n.jsxs)("div",{className:"mb-1 text-center text-lg",children:["Opened"," ",(0,n.jsx)("span",{className:"dark:bg-input-dark rounded-sm bg-neutral-200 p-1 font-mono leading-none",children:e.url})]}):(0,n.jsxs)("div",{className:"mb-1 text-center text-lg",children:["Navigated to"," ",(0,n.jsx)("span",{className:"dark:bg-input-dark rounded-sm bg-neutral-200 p-1 font-mono leading-none",children:e.url})]}),(0,n.jsx)(nR,{browser:e})]})}}function nR(e){let{browser:t}=e;return(0,n.jsx)("div",{className:"mx-auto grow overflow-hidden",children:(0,n.jsx)("img",{src:t.screenshotImageUrl,className:"rounded-md"})})}function nK(e){let{editor:t,mode:s}=e,a=(0,N.useRef)(null),l=(0,ec.F)().resolvedTheme;return(0,N.useEffect)(()=>{if(a.current){let e=new nO.a(a.current,(0,nA.rh)(t.filename,"view"===s?"":t.prevContents||"",t.contents||""),{outputFormat:"line-by-line",fileContentToggle:!1,fileListToggle:!1,highlight:!0,drawFileList:!1,colorScheme:"dark"===l?nz.ux.DARK:nz.ux.LIGHT});e.draw(),e.highlightCode()}},[t.filename,t.contents,t.prevContents,s,l]),(0,n.jsx)("div",{ref:a,className:(0,f.Z)("scrollbar-hide relative overflow-auto rounded-md",{editor_view:"view"===s})})}function nU(e){let{shell:t}=e,s=(0,ec.F)().resolvedTheme;return(0,n.jsx)("div",{className:"dark:bg-night relative flex grow rounded-md border border-neutral-200 dark:border-transparent",children:(0,n.jsx)(nT,{loading:t.loading,contents:"".concat(t.prevContents?t.prevContents:"").concat(t.rawContents?"\x1b".concat("dark"===s?"[48;5;240m":"[48;5;254m").concat(t.rawContents,"\x1b[0m"):""),fontSize:14})})}s(67462);var nV=s(5360),nH=s(20582),nW=s(95831);s(40512);let nq=(0,nH.default)(()=>s.e(5880).then(s.bind(s,91057)).then(e=>e.VncScreen),{loadableGenerated:{webpack:()=>[null]},ssr:!1}),nB=e=>{let{screenshotImageUrl:t,screenshotIsLoading:s}=e;return(0,n.jsxs)("div",{className:"screenshot-viewer w-full",children:[!s&&(0,n.jsx)(eu.default,{src:t,alt:"screenshot",width:"0",height:"0",sizes:"100vw",className:"top-0 h-full w-full object-contain"}),s&&(0,n.jsx)("div",{className:"mt-20 flex h-full w-full flex-1 items-center justify-center",children:(0,n.jsx)(tz.g,{})})]})};function nY(){let{resolvedTheme:e}=(0,ec.F)(),[t,s]=(0,b.KO)(F.J1),{shouldRestrictFeatures:a}=(0,eb.b1)();return(0,n.jsxs)("div",{className:"mb-1 mt-2 flex h-10 cursor-pointer items-center rounded-md border border-gray-200 text-[13px] dark:border-gray-600 dark:text-slate-100",children:[(0,n.jsx)(nJ,{selected:!t,onClick:()=>s(!1),className:"mr-[1px] rounded-l-md",children:"Devin's view"}),(0,n.jsx)(eb.Hd,{children:(0,n.jsx)("div",{className:"h-full",children:(0,n.jsxs)(nJ,{selected:t,onClick:()=>s(!0),disabled:a,className:"rounded-r-md border-none",children:[(0,n.jsx)(nV.C,{size:15,weight:"fill",color:"dark"===e?"#fff":t?"#3b82f6":"#000",className:"mr-1"}),"Interactive"]})})})]})}let nJ=e=>{let{selected:t,onClick:s,disabled:a,children:l,className:r}=e;return(0,n.jsx)("button",{className:(0,f.Z)("enabled:dark:hover:bg-extra-night flex h-full flex-1 items-center justify-center text-nowrap px-2.5 font-medium duration-150 enabled:hover:bg-slate-100 enabled:hover:text-blue-500 dark:border-gray-700 enabled:hover:dark:text-slate-300",t?"dark:bg-extra-night bg-slate-100 text-blue-500 ring-1 dark:text-slate-300 dark:ring-slate-400":"bg-transparent",r),onClick:s,disabled:a,children:l})},nG=e=>{var t,s;let{data:a,devinId:l}=e,{userId:r}=(0,T.aC)(),[i]=(0,b.KO)(F.J1),o=(0,eg.ib)(l),[d,c]=(0,N.useState)(!0),{devinState:u}=(0,D.j1)(),m="finished"===u.status.enum,x="undefined"!=typeof navigator&&/mac/i.test(navigator.platform),h=(0,N.useRef)(null),[p,f]=(0,b.KO)(aC.sf);return(0,n.jsxs)("div",{className:"browser-app flex flex-col overflow-hidden",ref:h,children:[(0,n.jsxs)("div",{className:"flex h-16 w-full flex-shrink-0 items-center justify-start gap-4 px-4 py-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"h-2 w-2 rounded-full bg-red-500"}),(0,n.jsx)("div",{className:"h-2 w-2 rounded-full bg-yellow-500"}),(0,n.jsx)("div",{className:"h-2 w-2 rounded-full bg-green-500"})]}),(0,n.jsx)("a",{href:null!==(t=a.url)&&void 0!==t?t:"about:blank",target:"_blank",rel:"noreferrer",className:"grow truncate rounded-full bg-gray-200 px-4 py-2 text-sm text-neutral-500 hover:underline",children:null!==(s=a.url)&&void 0!==s?s:"about:blank"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[!m&&r&&(0,n.jsx)(nY,{}),(0,n.jsx)("button",{className:"text-night dark:text-slate-100",onClick:()=>f(e=>!e),children:p?(0,n.jsx)(eQ.G,{size:22}):(0,n.jsx)(e0.S,{size:22})})]})]}),i&&!m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,n.jsx)("div",{className:"vnc-wrapper",children:(0,n.jsx)(nW.d$,{initialScale:1,wheel:{activationKeys:x?["Meta"]:[]},panning:{activationKeys:x?["Meta","Control"]:["Control"]},children:(0,n.jsx)(nW.Uv,{children:o.data&&(0,n.jsx)(nq,{url:"wss://".concat(o.data),scaleViewport:!0,background:"#2e2e2e",clipboardEnabled:!0,className:"flex aspect-[16/10] h-full w-full items-center justify-center",rfbOptions:{credentials:{password:"devin"}},onConnect:()=>{c(!1)},onDisconnect:()=>{c(!0)}})})})})}),(0,n.jsx)("p",{className:"w-full py-2 text-center text-sm italic text-gray-500",children:"Devin might be delayed in seeing changes in the interactive browser"}),d&&(0,n.jsx)(to.T,{size:"md"})]}):a.url&&(0,n.jsx)(nB,{screenshotIsLoading:a.loading,screenshotImageUrl:a.screenshotImageUrl})]})},n$=e=>{let t;let{devinState:{status:s},allEvents:a}=(0,D.j1)(),{shouldRestrictFeatures:l}=(0,eb.b1)(),[r,i]=(0,N.useState)(!1);(0,N.useEffect)(()=>{r||i(a.some(e=>"terminal_update"===e.type))},[a,r]);let o=r&&"finished"!==s.enum&&!l,[,d]=(0,b.KO)(aC.R_),c=(0,N.useCallback)(()=>{o&&(t5.Z.trackInteraction(t5.j.VSCODE),d(!0))},[d,o]);return t=o?"Open VSCode on Devin's machine":"finished"===s.enum?"Devin is sleeping":"Initializing...",(0,n.jsx)(nX,{tooltipContent:t,children:e.children({shouldShowVSCode:o,handleClick:c})})},nX=e=>{let{children:t,tooltipContent:s}=e,{shouldRestrictFeatures:a}=(0,eb.b1)();return a?(0,n.jsx)(eb.Hd,{side:"left",children:t}):(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:s}),side:"left",className:"mr-4 px-2 py-1",delayDuration:100,children:t})},nQ=async e=>{C.A.info("Opening VSCode on Devin's machine...");let t=await (0,e_.o)(e);t.link&&window.open(t.link,"_blank")},n0=e=>{let{devinId:t}=e,[s,a]=(0,b.KO)(aC.R_),l=async()=>{a(!1),nQ(t)};return(0,n.jsx)(su.T,{title:"Use Devin's machine",description:"If you modify any files, make sure to tell Devin what you changed!",open:s,onCancel:()=>a(!1),onConfirm:l,confirmLabel:"Use Devin's machine",submitColor:"bg-pacific hover:bg-blue-500"})},n1=(0,nb.Cl)(),n2=[n1.accessor("step",{id:"step",cell:e=>(0,n.jsx)("span",{title:e.getValue(),children:e.getValue()}),header:()=>"Step"}),n1.accessor("grade",{cell:e=>(0,n.jsx)(n8,{grade:e.getValue()}),header:()=>"Outcome"}),n1.accessor("time_taken",{id:"time_taken",cell:e=>n4(+e.getValue()),header:()=>"Time Taken"}),n1.accessor("timestampMs",{id:"timestamps",cell:e=>(0,n.jsx)("span",{title:(0,ln.i)(e.getValue(),!0),children:(0,ln.i)(e.getValue(),!0)}),header:()=>"Timestamp"})],n5=e=>"step"===e?"35%":"timestamps"===e||"time_taken"===e?"25%":"auto",n4=e=>{let t=e,s="second";return t>=60&&(s="minute",(t/=60)>=60&&(s="hour",(t/=60)>=24&&(t/=24,s="day"))),"".concat(t.toFixed(1)," ").concat(s).concat(t>1?"s":"")},n8=e=>{let{grade:t}=e,s="bg-red-500";return["A","B","C"].includes(t)&&(s="bg-green-500"),["D"].includes(t)&&(s="bg-yellow-500"),(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsx)("div",{className:(0,f.W)("mx-3 h-3 w-3 rounded-full",s)})})},n3=e=>{let{items:t,onClick:s}=e,a=(0,nv.b7)({data:t,columns:n2,getCoreRowModel:(0,nb.sC)()}),{timelineState:{getNextRelevantTimestamp:l},timelineActions:{setTimestamp:r}}=(0,D.j1)();return t&&t.length?(0,n.jsxs)("div",{className:"jsx-107fa0fcbc481daf flex h-full w-full flex-col overflow-auto border-t border-neutral-300 dark:border-neutral-600",children:[(0,n.jsxs)("table",{className:"jsx-107fa0fcbc481daf log-table w-full ",children:[(0,n.jsx)("thead",{className:"jsx-107fa0fcbc481daf sticky top-0 bg-gray-200 dark:bg-black dark:text-white",children:a.getHeaderGroups().map(e=>(0,n.jsxs)("tr",{className:"jsx-107fa0fcbc481daf",children:[(0,n.jsx)("th",{style:{width:"3%"},className:"jsx-107fa0fcbc481daf"}),e.headers.map(e=>(0,n.jsx)("th",{style:{width:n5(e.id)},className:"jsx-107fa0fcbc481daf",children:e.isPlaceholder?null:(0,nv.ie)(e.column.columnDef.header,e.getContext())},e.id))]},e.id))}),(0,n.jsx)("tbody",{className:"jsx-107fa0fcbc481daf font-mono dark:text-neutral-200",children:a.getRowModel().rows.map(e=>(0,n.jsx)(n6,{row:e,onClick:s,jumpToLog:e=>{r(l(e))}},e.id))})]}),(0,n.jsx)(ng(),{id:"107fa0fcbc481daf",children:".log-table.jsx-107fa0fcbc481daf{font-size:.75rem;table-layout:fixed}.log-table.jsx-107fa0fcbc481daf td.jsx-107fa0fcbc481daf{overflow:hidden;white-space:nowrap;padding:2px 8px;-o-text-overflow:ellipsis;text-overflow:ellipsis}.log-entry-header.jsx-107fa0fcbc481daf{cursor:pointer}.log-entry-content.jsx-107fa0fcbc481daf{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}"})]}):null},n6=e=>{let{row:t,jumpToLog:s}=e,[a,l]=(0,N.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:5,className:"p-0",children:(0,n.jsxs)("div",{onClick:()=>s(t.original.timestampMs),className:(0,f.W)("log-entry-header flex cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",t.original.isFuture&&"text-cloud italic"),children:[(0,n.jsx)("div",{style:{width:"3%"},onClick:e=>{e.stopPropagation(),l(!a)},className:"ml-1 flex items-center justify-center",children:a?(0,n.jsx)(B.p,{className:"h-4 w-4 self-start"}):(0,n.jsx)(X.T,{className:"h-4 w-4 self-start"})}),t.getVisibleCells().map(e=>(0,n.jsx)("div",{className:(0,f.W)("flex-1","grade"==e.column.id&&"mt-1","timestamps"==e.column.id&&"mr-2","step"!==e.column.id?"text-center":"overflow-hidden text-ellipsis text-nowrap break-all pl-4"),children:(0,nv.ie)(e.column.columnDef.cell,e.getContext())},e.id))]})})},t.id),(0,n.jsx)("tr",{className:(0,f.W)("w-full transition-all ease-in-out",a?"":"hidden"),children:(0,n.jsx)("td",{colSpan:5,children:(0,n.jsx)("div",{className:"log-entry-content flex w-full flex-col overflow-x-hidden hyphens-auto px-4 pb-4 pt-1 text-[#8f8f8f] dark:text-neutral-200",children:(0,n.jsx)("div",{className:"w-full whitespace-break-spaces",children:t.original.description})})})})]})},n7=e=>{let{data:t}=e,[s,a]=(0,N.useState)(!0),{devinState:{workLogEvents:l}}=(0,D.j1)(),r=(0,b.b9)(F.x3);return(0,n.jsxs)("div",{className:"dark:bg-night flex h-full flex-col",children:[l&&l.length>0&&(0,n.jsx)("div",{className:"flex min-h-[38px] flex-1 items-center border-b border-b-gray-300 px-4 dark:border-b-zinc-700 dark:bg-zinc-900 dark:text-white",children:(0,n.jsx)("div",{className:"space-around ml-auto flex items-center",children:(0,n.jsx)(na.K,{onClick:()=>{t5.Z.trackInteraction(t5.j.SHOW_WORK_LOG),a(!s),r(!s)},isActive:s,title:"Show work log",children:(0,n.jsx)(nm.a,{size:18})})})}),(0,n.jsx)(n9,{content:t.contents,nextStepsMap:t.next_steps_map}),(null==l?void 0:l.length)>0&&s&&(0,n.jsx)(rt,{workLogItems:l})]})},n9=e=>{let{content:t,nextStepsMap:s}=e,a=t.replace("<plan>","").replace("</plan>","");return a.startsWith("```")?(0,n.jsx)(re,{content:t,nextStepsMap:s}):(0,n.jsx)(S.U,{className:"planner-app prose prose-sm dark:prose-invert dark:border-dark-border dark:bg-night h-full max-w-none overflow-auto p-8 dark:border-transparent",remarkPlugins:[aW.Z],children:a},a)};function re(e){var t,s;let{content:a,nextStepsMap:l}=e,r=a.match(/```\s([\s\S]*)\s+```([\s\S]*)/),i=null!==(t=null==r?void 0:r[1])&&void 0!==t?t:"",o=null!==(s=null==r?void 0:r[2])&&void 0!==s?s:"",d=ef(),c=(0,N.useRef)(null);(0,N.useEffect)(()=>{if(c.current&&["lg","xl","2xl"].includes(d)){let e=c.current.querySelector("[data-scroll-target]");e&&e.scrollIntoView({behavior:"smooth"})}},[d,a]);let u=(0,eT._Z)(),[m,x]=(0,N.useState)(null),h=e=>{u&&e&&(null==l?void 0:l[e])&&x(e)},p=()=>{u&&x(null)};return(0,n.jsx)("div",{className:"relative h-full overflow-hidden p-4",children:(0,n.jsx)("div",{className:"h-full w-full",ref:c,children:(0,n.jsxs)("div",{className:"prose prose-sm dark:prose-invert dark:border-dark-border h-full max-w-none overflow-scroll dark:border-transparent",children:[(0,n.jsx)("pre",{children:i.split("\n").map((e,t)=>{var s,a;let r=null===(s=e.match(/^(>|\s) (\d+)/))||void 0===s?void 0:s[2],i=u&&m===r,o=u&&m&&r&&(null==l?void 0:null===(a=l[m])||void 0===a?void 0:a.includes(r));return(0,n.jsxs)("code",{"data-scroll-target":!!e.startsWith(">")||null,onMouseEnter:()=>h(r),onMouseLeave:p,className:(0,eD.cn)(i?"bg-blue-500":o?"bg-green-700":""),children:[e,(0,n.jsx)("br",{})]},t)})}),(0,n.jsx)(S.U,{remarkPlugins:[aW.Z],children:o})]},a)})})}let rt=e=>{let{workLogItems:t}=e;return(0,n.jsx)("div",{className:"relative flex max-h-[40%] min-h-[40%] flex-[2] flex-col items-stretch",children:(0,n.jsx)("div",{className:"h-full overflow-auto",children:(0,n.jsx)(n3,{items:t,onClick:()=>{}})})})};s(15315);let rs=e=>{var t,s;let{devin:a,devinId:l,isDemoMode:r,onKill:i,emitUpdateMasterPlan:o,emitUserMessage:d,emitRestoreToCheckpoint:c,emitHumanModeUserResponse:u,emitHumanModeStatus:m,onReviveDevin:x}=e,h=(0,eT._Z)(),[p]=(0,em.Z)("progress_app_enabled",!0),g=h&&p,[v]=(0,em.Z)("disable_verifier",!1),j=!h||v,{devinState:{allApplications:k,activeApp:y,shellCommandHistory:C,status:_,humanModeEnabled:S},timelineState:{isReplayMode:E,currentTimestamp:A}}=(0,D.j1)(),O=(0,eT.K7)(),{userId:z}=(0,T.aC)(),[I,L]=(0,b.KO)(F.is),Z=(0,N.useMemo)(()=>{let e=[{tab:"shell",flowId:"e4a2fa9c-6c2b-46ca-a986-a58755dd7af3"},{tab:"browser",flowId:""},{tab:"editor",flowId:"435fb181-f1fc-4b2b-8d08-673fd3bb1dd9"},{tab:"planner",flowId:""}];return g&&e.unshift({tab:"progress",flowId:""}),e},[g]),[P,R]=(0,N.useState)("");(0,N.useEffect)(()=>{g&&L("progress"),R(y)},[l,g]),(0,N.useEffect)(()=>{I?I!==y&&R(I):R(y)},[y,I,L]);let K={progress:(0,n.jsx)(nI,{}),chat:(0,n.jsxs)("div",{className:"relative flex h-full flex-col pb-4",children:[(0,n.jsx)(lN,{devin:a,isDemoMode:r,isExample:!1,emitUpdateMasterPlan:o,emitHumanModeUserResponse:u,emitRestoreToCheckpoint:c}),(0,n.jsx)(M,{devinId:l||""})]}),shell:(0,n.jsx)(nS,{activeTabId:null===(t=w().maxBy(k.shell,e=>e.lastActive))||void 0===t?void 0:t.id,allTabs:k.shell,shouldFollow:"shell"!==I,shellCommandHistory:C}),browser:(0,n.jsx)(nG,{data:k.browser,devinId:l}),planner:(0,n.jsx)(n7,{data:k.planner}),editor:(0,n.jsx)(no,{activeFilename:null===(s=w().maxBy(k.editor,e=>e.lastActive))||void 0===s?void 0:s.filename,allTabs:k.editor,shouldFollow:"editor"!==I})},U=(0,N.useRef)(null),[V,H]=(0,N.useState)(!1),W=(0,N.useCallback)(()=>{document.body.clientWidth<=1280&&H(!1)},[H]);(0,N.useEffect)(()=>(window.addEventListener("resize",W),()=>{window.removeEventListener("resize",W)}),[W]);let{isMobile:q}=(0,ay.Z)(),{resolvedTheme:B}=(0,ec.F)(),[Y,J]=(0,b.KO)(aC.sf);(0,N.useEffect)(()=>{Y||H(!1)},[Y,H]);let G=(0,N.useCallback)(()=>{t5.Z.trackInteraction(t5.j.TOGGLE_WORK_VIEW),V||J(!V),H(!V)},[V,H,J]),$=(0,N.useCallback)(()=>{t5.Z.trackInteraction(t5.j.EXPAND_WORKSPACE),Y&&H(!1),J(!Y)},[Y,J,H]),[X,Q]=(0,b.KO)(F.g4),ee=(0,b.b9)(F.D7),et=(0,b.b9)(F.Ot),es=(0,b.b9)(F.x3),ea=(0,b.b9)(F.J1),el=(0,N.useCallback)(()=>Q(!1),[Q]);return(0,N.useEffect)(()=>{ea(!1),et(!1),ee(!1),es(!1),ee(!1)},[ea,et,ee,es]),(0,n.jsxs)("div",{ref:U,className:"workspace-panel lg:dark:bg-shade bg-white dark:bg-[#242424]",children:[(0,n.jsx)(lH.EG,{onClose:el,open:X,emitUserMessage:d}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"panel-header",children:(0,n.jsx)("h1",{className:"hidden text-xl md:block dark:text-white",children:"Devin's Workspace"})}),(0,n.jsxs)("div",{className:"ml-4 flex items-center gap-4",children:[l&&!j&&(0,n.jsx)(nF,{devinId:l}),z&&(0,n.jsx)(n$,{children:e=>{let{handleClick:t,shouldShowVSCode:s}=e;return(0,n.jsx)("button",{onClick:t,className:(0,f.Z)(s?"cursor-pointer opacity-100":"cursor-not-allowed opacity-40"),children:(0,n.jsx)("img",{src:"/vscode-".concat("light"===B?"black":"white",".svg"),height:19,width:19,alt:"Visual Studio Code"})})}}),(0,n.jsx)("div",{children:(0,n.jsxs)(tC,{children:[z&&(0,n.jsx)(n$,{children:e=>{let{handleClick:t,shouldShowVSCode:s}=e;return(0,n.jsx)(t_,{disabled:!s,children:(0,n.jsx)("button",{className:(0,f.Z)("w-full text-left",s?"cursor-pointer opacity-100":"cursor-not-allowed opacity-40"),onClick:t,disabled:!s,children:"Use Devin's Machine"})})}}),(0,n.jsx)(n.Fragment,{children:q?null:(0,n.jsxs)(n.Fragment,{children:[z&&(0,n.jsx)(l3,{runStatus:_.enum,isReplayMode:E,devinId:l}),(0,n.jsx)(t_,{onClick:G,children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"Toggle work view"}),(0,n.jsx)("div",{className:"scale-[0.9]",children:(0,n.jsx)(ss.r,{checked:V})})]})}),(0,n.jsx)(t_,{onClick:$,children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"Expand workspace"}),(0,n.jsx)("div",{className:"scale-[0.9]",children:(0,n.jsx)(ss.r,{checked:Y})})]})})]})}),O&&(0,n.jsx)(t_,{children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"Human Mode"}),(0,n.jsx)("div",{className:"scale-[0.9]",children:(0,n.jsx)(ss.r,{checked:S,onCheckedChange:e=>m(e?"enable":"disable")})})]})}),(!q||z)&&(0,n.jsx)(tE,{}),(0,n.jsx)("div",{className:"flex w-full justify-end py-1 pr-3 text-[10px] italic text-gray-500 dark:text-gray-400",children:"Selected time: ".concat(A>0?(0,ln.i)(A,!0):"Now")}),(0,n.jsxs)(tS,{title:"Editor",children:[(0,n.jsx)(t_,{onClick:()=>{t5.Z.trackInteraction(t5.j.VIEW_GLOBAL_WORK_DIFF),Q(!0)},children:(0,n.jsx)("span",{children:"View global file diff"})}),(0,n.jsx)(t_,{onClick:()=>{t5.Z.trackInteraction(t5.j.VIEW_FILE_DIFF_HISTORY),L(null),R("editor"),ee(!0),q||et(!0)},children:(0,n.jsx)("span",{children:"View file diff history"})}),(0,n.jsx)(t_,{children:(0,n.jsx)(rr,{editor:k.editor})})]}),(0,n.jsx)(tS,{title:"Shell",children:(0,n.jsx)(t_,{children:(0,n.jsx)(ra,{onClick:()=>{t5.Z.trackInteraction(t5.j.VIEW_SHELL_HISTORY),R("shell")},shell:k.shell})})}),z&&(0,n.jsx)(tS,{title:"Browser",children:(0,n.jsx)(rl,{onClick:()=>{t5.Z.trackInteraction(t5.j.USE_DEVINS_BROWSER),R("browser")}})})]})}),(0,n.jsx)(n0,{devinId:l}),(0,n.jsx)(l6,{onKill:i,devinId:l,isRunFinished:"finished"!==_.enum}),(0,n.jsx)(lQ,{rollbackFunction:c,onRestore:()=>{L(null)}}),(0,n.jsx)(l1.DL,{reviveFunction:x})]})]}),V?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"quad-view mt-4 grid flex-1 grid-cols-2 grid-rows-2 gap-4",children:[(0,n.jsx)("div",{className:"quad-panel",children:(0,n.jsx)("div",{className:"quad-panel--inner rounded-xl border border-neutral-200 dark:border-neutral-600 [&_button]:bottom-5",children:K.chat})}),(0,n.jsx)("div",{className:"quad-panel",children:(0,n.jsx)("div",{className:"quad-panel--inner rounded-xl border border-neutral-200 dark:border-neutral-600",children:K.shell})}),(0,n.jsx)("div",{className:"quad-panel",children:(0,n.jsx)("div",{className:"quad-panel--inner rounded-xl border border-neutral-200 dark:border-neutral-600",children:K.browser})}),(0,n.jsx)("div",{className:"quad-panel",children:(0,n.jsx)("div",{className:"quad-panel--inner rounded-xl border border-neutral-200 dark:border-neutral-600",children:K.editor})})]}),(0,n.jsx)("div",{className:"dark:bg-night mt-4 rounded-xl border border-neutral-200 bg-slate-100 pl-4 pr-4 pt-4 dark:border-neutral-600",children:(0,n.jsx)(l5,{workspaceRef:U,isDemoMode:r})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"scrollbar-hide mb-4 mt-4 flex items-center overflow-x-auto md:mt-8",children:(0,n.jsx)("div",{className:"flex gap-2",children:Z.map((e,t)=>{let{tab:s,flowId:a}=e;return(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("div",{onClick:()=>{a&&("editor"===s&&0!==k.editor.length&&lV.default.start(a,{once:!0}),"shell"===s&&C.commands.length>0&&lV.default.start(a,{once:!0})),s!==P&&(s!==I&&L(null),R(s))},className:(0,eD.cn)("group flex cursor-pointer items-center text-sm font-medium capitalize transition duration-200 md:text-base",P===s?"text-neutral-600 dark:text-white":"dark:text-inactive text-neutral-400"),children:(0,n.jsxs)("span",{className:"flex w-max items-center gap-1.5",children:[(0,n.jsx)(eu.default,{src:"/devin.svg",alt:"Active tab",height:16,width:16,className:(0,eD.cn)("invisible h-4 w-4",{visible:y===s})}),s,(0,n.jsx)("button",{className:(0,eD.cn)("invisible group-hover:visible",{visible:I===s}),onClick:e=>{e.stopPropagation(),L(I===s?null:s)},children:(0,n.jsx)(lU.Q,{size:16,weight:I===s?"fill":"regular",className:"text-pacific"})})]})}),t!==Z.length-1&&(0,n.jsx)("div",{className:"dark:bg-input-dark block h-full w-px bg-slate-300"})]},s)})})}),(0,n.jsxs)("div",{className:"flex flex-1 flex-col overflow-hidden",children:[(0,n.jsx)("div",{className:"panel-content flex flex-1",children:(0,n.jsx)("div",{className:"panel-content--inner rounded-tl-xl rounded-tr-xl border border-neutral-200 dark:border-neutral-600",children:P in K?K[P]:null})}),(0,n.jsx)(l5,{workspaceRef:U,isDemoMode:r})]})]})]})},ra=e=>{let{onClick:t,shell:s}=e,a=(0,b.b9)(F.x3),l=s.length>0,r=(0,N.useCallback)(()=>{l&&(a(!0),t())},[a,t,l]);return(0,n.jsx)(rn,{enabled:l,tooltipContent:"Devin has not used the shell",onClick:r,children:"View command history"})},rl=e=>{let{onClick:t}=e,s=(0,b.b9)(F.J1),{devinState:{status:a}}=(0,D.j1)(),{shouldRestrictFeatures:l}=(0,eb.b1)(),r="finished"!==a.enum&&!l,i=(0,N.useCallback)(()=>{r&&(s(!0),t())},[s,t,r]);return(0,n.jsx)(eb.Hd,{side:"left",children:(0,n.jsx)("div",{children:(0,n.jsx)(t_,{disabled:!r,children:(0,n.jsx)(rn,{enabled:r,tooltipContent:"Devin is sleeping",onClick:i,children:"Use Devin's browser"})})})})},rn=e=>{let{enabled:t,tooltipContent:s,children:a,onClick:l}=e;return(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:s}),side:"left",className:(0,f.Z)("mr-4 px-2 py-1"),delayDuration:100,disabled:t,children:(0,n.jsx)("div",{className:"w-full ",children:(0,n.jsx)("button",{className:(0,f.Z)("w-full text-left",t?"cursor-pointer opacity-100":"cursor-not-allowed opacity-40"),onClick:l,disabled:!t,children:a})})})},rr=e=>{let{editor:t}=e,[s]=(0,b.KO)(F.vl),a=t.some(e=>e.loading),l=!t.length,r=!a&&!l,i=(0,N.useCallback)(()=>{r&&(t5.Z.trackInteraction(t5.j.DOWNLOAD_CHANGES),(0,l9.u)(t,s))},[t,s,r]),o="";return a&&(o="Files are loading"),l&&(o="No files to download"),(0,n.jsx)(rn,{enabled:r,tooltipContent:o,onClick:i,children:"Download Devin's code"})};var ri=s(78748);let ro=e=>{let{onKill:t,className:s,sessionId:a}=e,[l,r]=(0,N.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Terminate this session"}),side:"bottom",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)("button",{className:(0,f.Z)(" rounded-md ",s),onClick:()=>r(!0),children:(0,n.jsx)(aE.c,{className:"h-6 w-6 text-red-400"})})}),(0,n.jsx)(rd,{open:l,onOpenChange:()=>r(!1),onConfirm:()=>{t(),r(!1)},sessionId:a})]})},rd=e=>{let{open:t,onOpenChange:s,onConfirm:a,sessionId:l}=e,[{loading:r,value:i},o]=(0,tT.Z)(async()=>await e_.R9.getHostedServices(l),[l]);return(0,N.useEffect)(()=>{t&&o()},[o,t]),(0,n.jsx)(tV.Vq,{open:t,onOpenChange:s,children:(0,n.jsxs)(tV.cZ,{className:"outline-none sm:max-w-[525px]",children:[(0,n.jsx)(tV.fK,{children:(0,n.jsx)(tV.$N,{className:"text-md mb-1 tracking-tight",children:"Are you sure you want to terminate the session?"})}),(0,n.jsx)("div",{className:"text-sm",children:r?(0,n.jsx)("div",{className:"flex h-full w-full items-center justify-center align-middle",children:(0,n.jsx)(tz.g,{})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mb-4 flex flex-col space-y-2.5 ",children:"Stopping Devin will terminate all work and the current session. This cannot be reverted."}),i&&i.length>0&&(0,n.jsx)("div",{children:"This session contains ".concat(i.length," ").concat(i.length>1?"services":"service"," running. Terminating the session will also terminate all hosted services.")}),(0,n.jsxs)("div",{className:"mt-4 flex w-full justify-end",children:[(0,n.jsx)(tO.z,{className:"rounded-lg border [&>button]:w-20",loading:r,size:"sm",onClick:()=>s(),theme:"default",type:"button",disabled:r,defaultTitle:"Cancel"}),(0,n.jsx)(tO.z,{size:"sm",className:"ml-2 rounded-lg border !border-transparent [&>button]:h-8 [&>button]:w-40",loading:r,onClick:()=>a(),theme:"danger",type:"button",defaultTitle:"Terminate session",disabled:r})]})]})})]})})};var rc=s(11554),ru=s(48905);let rm=e=>{let{isPaused:t,emitLoopSignal:s}=e,a=(0,N.useCallback)(async()=>{t5.Z.trackInteraction(t5.j.PAUSE_SESSION),s("play")},[s]),l=(0,N.useCallback)(async()=>{t5.Z.trackInteraction(t5.j.PAUSE_SESSION),s("pause")},[s]);return(0,n.jsxs)("div",{className:"flex flex-row items-center justify-center space-x-4 text-xl",children:[t&&(0,n.jsx)(rx,{children:(0,n.jsx)("button",{className:"ml-1 mr-4 rounded-md lg:ml-auto",onClick:a,children:(0,n.jsx)(rc.s,{className:"h-6 w-6 dark:text-white"})})}),!t&&(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Pause session"}),side:"bottom",className:"px-2 py-1",delayDuration:100,children:(0,n.jsx)("button",{className:"ml-1 mr-4 rounded-md lg:ml-auto",onClick:l,children:(0,n.jsx)(ru.d,{className:"h-6 w-6 dark:text-white"})})})]})},rx=e=>{let{children:t}=e,{shouldRestrictFeatures:s}=(0,eb.b1)();return s?(0,n.jsx)(eb.Hd,{children:t}):(0,n.jsx)(sD.u,{content:(0,n.jsx)("span",{className:"text-xs",children:"Resume session"}),side:"bottom",className:"px-2 py-1",delayDuration:100,children:t})};var rh=s(2373),rp=s(6472),rf=e=>{let{title:t,canUserInteractWithDevin:s,devinId:a,hasDevin:l,isSettings:r,snapshotName:i,handleKillSession:o,userId:d}=e,c=(0,y.usePathname)(),[u,m]=(0,N.useState)(!1),[x,h]=(0,N.useState)(!1),{data:p,isLoading:g}=(0,eg.iA)(a),{data:b}=(0,eg.vz)(d||""),v=(0,N.useMemo)(()=>{var e;return s&&!!(null==b?void 0:null===(e=b.slack)||void 0===e?void 0:e.user_id)},[b,s]);(0,N.useEffect)(()=>{p&&!g&&h(p.notifications_enabled)},[p,g]);let j=(0,N.useCallback)(async()=>{h(e=>!e),await (0,e_.J4)(a,!x)},[a,x]),w=(0,N.useCallback)(async()=>{try{let e=c.split("/").pop();await (0,e_.lP)("devin-"+e),C.A.success("Your session link was copied to the clipboard")}catch(e){C.A.error("Something went wrong, please try again!")}},[c]),k=(0,N.useCallback)(()=>{o(),m(!1)},[o,m]);return(0,n.jsxs)("div",{className:"flex max-w-full justify-between gap-4",children:[(0,n.jsx)(rp.f,{icon:"straight"}),l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(rd,{open:u,onOpenChange:()=>m(!1),onConfirm:k,sessionId:a}),(0,n.jsxs)("div",{className:"flex flex-1 flex-col justify-center overflow-hidden",children:[(0,n.jsx)("h2",{title:t,className:"truncate text-center text-base font-bold sm:max-w-[400px] md:mx-[6rem] md:max-w-full dark:text-white",children:t||"Untitled"}),i&&(0,n.jsxs)("div",{className:"text-pacific flex items-center justify-center",children:[(0,n.jsxs)("span",{className:"mr-1 flex w-min items-center whitespace-nowrap text-xs font-semibold",children:[(0,n.jsx)("span",{className:"hidden md:block",children:"Started from snapshot:"}),(0,n.jsx)("span",{className:"block md:hidden",children:"Snapshot:"})]}),(0,n.jsx)("div",{className:"truncate text-xs",children:i})]})]}),!r&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(eh.h_,{children:[(0,n.jsx)(eh.$F,{children:(0,n.jsx)(K.x,{size:28,className:"text-pacific font-bold dark:text-white"})}),(0,n.jsxs)(eh.AW,{side:"top",className:"dark:border-cloud dark:bg-input-dark w-56 bg-white",children:[(0,n.jsxs)(eh.Xi,{onClick:w,children:[(0,n.jsx)(tQ.D,{size:16,className:"mr-1.5"})," Share"]}),(0,n.jsxs)(eh.Xi,{onClick:()=>m(!0),children:[(0,n.jsx)(rh.Z,{size:16,className:"mr-1.5 text-red-500"})," ","Terminate Session"]}),v&&(0,n.jsxs)(eh.Xi,{onClick:j,children:[(0,n.jsx)("div",{className:(0,f.Z)(x?"text-pacific":""," duration-100"),children:(0,n.jsx)(t7.M,{size:16,className:"mr-1.5"})}),x?"Disable":"Enable"," Slack Notifications"]})]})]})})]})]})},rg=s(72053);let rb=e=>{"Notification"in window&&(new Notification("Devin needs your attention",{body:e,icon:"/devin_v4.png"}).onclick=function(){window.focus()})},rv=()=>{let{devinState:e}=(0,D.j1)(),{windowIsActive:t}=(0,N.useContext)(rg.Z),s=e.status.enum,a="Notification"in window,[l]=(0,em.Z)("allows-devin-notifications",!0),n=(0,N.useMemo)(()=>tl()(e=>rb(e),6e4),[]);return(0,N.useEffect)(()=>{if(!t&&a&&"granted"===Notification.permission&&l){if("blocked"===s){n("Devin has stopped and is waiting for your input");return}if("waiting"===s){n("Devin is waiting for your input to proceed");return}}},[s,l,n]),null};function rj(e){var t;let{devinId:s,isDemoMode:a}=e,{userId:l,orgId:m,isLoaded:x}=(0,T.aC)(),{user:j}=(0,T.aF)(),{immersiveLiveMode:k}=(0,e6.k)(),_=(0,h.NL)(),S=(0,y.useRouter)(),E=(0,b.b9)(F.qb),[A,O]=(0,b.KO)(F.JU);r._m.config({paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.48.0/min/vs"}});let{enrichedEventsList:z,loading:I,emitUserMessage:L,emitRestoreToCheckpoint:Z,emitLoopSignal:P,emitUpdateMasterPlan:R,emitSecrets:K,emitSpeedUpdate:U,emitHumanModeUserResponse:V,emitHumanModeStatus:H,sessionSecrets:W,disconnected:q}=(0,ri.h)(s);(0,eb.b1)();let B=(0,D.xN)(z,I,!!a);(0,te.VX)(B.devinState,s);let Y=B.devinState.isPaused,{isMobile:J}=(0,ay.Z)(),G=(0,N.useMemo)(()=>s?"You're in the queue for Devin"===B.devinState.status.message?"You're in the queue for Devin...":"resume_requested"===B.devinState.status.enum?"Waiting for Devin to resume...":J?"Send a message":-1!==B.timelineState.selectedTimelineIndex?"This alternate timeline is read-only":"Send a message":"Give Devin a task to work on...",[s,B.devinState.status.message,B.devinState.status.enum,B.timelineState.selectedTimelineIndex,J]),$=(0,eS.F)(e=>e.selectedPlaybook),X=null==$?void 0:$.id,Q=(0,eS.F)(e=>e.selectedSnapshot),ee=(0,eS.F)(e=>e.selectedConfigId),et=(0,y.useSearchParams)(),[es]=(0,b.KO)(F._Z),[ea,el]=(0,N.useState)(!1),en=(0,F.Q6)(),[er,ei]=(0,N.useState)([]),{data:eo}=(0,p.a)({queryKey:["snapshots","used"],queryFn:()=>(0,e_.DE)(s),enabled:!!l}),[ed,ec]=(0,N.useState)(""),[eu,em]=(0,N.useState)({channelId:"",checked:!1}),ex=(0,y.usePathname)(),eh=(0,N.useRef)(!1),ep=(0,N.useCallback)((e,t)=>{em({channelId:e,checked:t})},[]),ef=(0,N.useCallback)(async e=>{let t=new AbortController;ei(s=>[...s,{file:e,controller:t}]),(e.name.endsWith(".playbook.txt")||e.name.endsWith(".script.txt"))&&C.A.info("Playbook uploaded");let s=await (0,e_.cT)(e,t);ei(t=>t.map(t=>t.file===e?{...t,url:s}:t))},[ei]),eg=(0,N.useMemo)(()=>w().every(er,e=>!!e.url),[er]);(0,N.useEffect)(()=>{s&&("You're in the queue for Devin"===B.devinState.status.message||B.devinState.status.message.includes("Devin is reverting to a previous checkpoint")||"resume_requested"===B.devinState.status.enum?el(!0):el(!1))},[s,el,B.devinState.status.message,B.devinState.status.enum]);let{isLoading:ev,data:ej,error:ew}=(0,te.Wq)(s),ek=(0,N.useCallback)(()=>B.devinState.messageHistoryEvents.filter(e=>"user_message"===e.type).length,[B.devinState.messageHistoryEvents]),[ey,eN]=(0,N.useState)(null),[eC,eE]=(0,N.useState)(!1);(0,N.useEffect)(()=>{null===$&&eN(null)},[$,eN]),(0,N.useEffect)(()=>{s&&!l&&0===B.devinState.messageHistoryEvents.filter(e=>"user_message"===e.type).length&&el(!0)},[l,B.devinState.messageHistoryEvents,s]);let eF=!s,eM=!!s,eA=(0,N.useCallback)(async e=>{if(t5.Z.trackInteraction(t5.j.SEND_MESSAGE),!eF&&"finished"===B.devinState.status.enum&&!(await (0,e_.Zk)(l,m,s)).success)return C.A.error("Failed to resume Devin"),!1;let t=null,a=!1;if(!l&&0===ek())return window.open("https://www.cognition.ai/get-started","_blank"),!1;if(!eg)return alert("wait for all uploads to complete..."),!1;let n="",r=-1!==e.indexOf("PLAYBOOK_md:")?e.indexOf("PLAYBOOK_md:"):e.indexOf("PLAYBOOK:");for(let{url:s}of(-1!==r&&(n=e.slice(r),e=e.slice(0,r)),er)){if((null==s?void 0:s.endsWith(".playbook.txt"))||(null==s?void 0:s.endsWith(".playbook.md"))||(null==s?void 0:s.endsWith(".devin.md"))){t=s,a=null==s?void 0:s.endsWith(".playbook.txt");continue}e+="\nATTACHMENT:"+JSON.stringify(s)}for(let t of en.selections)e+="\n```".concat(t.language," filename=").concat(t.file," lines=").concat(t.range.startLine,"-").concat(t.range.endLine,"\n").concat(t.snippet,"\n```");if(n)e+="\n".concat(n);else if(ey)e+="\nPLAYBOOK_md: ".concat($?$.title:"","\n").concat(ey);else if($&&!s)e+="\nPLAYBOOK_md: ".concat($.title,"\n").concat($.body);else if(t){let s=await fetch(t),l=await s.text();e+="\nPLAYBOOK_".concat(a?"txt":"md",":")+l}if((e.includes("PLAYBOOK_md:")&&e.trim().startsWith("PLAYBOOK_md:")||e.includes("PLAYBOOK_txt:")&&e.trim().startsWith("PLAYBOOK_txt:")||e.includes("PLAYBOOK:")&&e.trim().startsWith("PLAYBOOK:"))&&(e="run the playbook \n ".concat(e)),ei([]),en.clear(),s)Y&&P("play"),L(e);else try{var i;el(!0);let t=(await (0,te.ed)(e,null!==(i=null==j?void 0:j.given_name)&&void 0!==i?i:"user",Q.ami_id,Q.snapshot_id,X,(null==es?void 0:es.value)==="None"?void 0:null==es?void 0:es.value,ed,eu.checked?eu.channelId:void 0)).devin_id;if(A&&((0,tg.io)(t,A),O(null)),ee)await (0,e_.Ut)(ee),_.invalidateQueries({queryKey:["shortcuts",l,m]});else if("baseline"!==Q.snapshot_id||X){let e=async()=>{await (0,e_.ZA)({title:"(Recent)",snapshot_id:Q.snapshot_id,playbook_id:null!=X?X:null}),E(!1)},t=async()=>{E(!0)};(0,C.A)("Want to save this as a shortcut?",{description:"Saving allows you to quick start future sessions with this playbook and snapshot",position:"bottom-left",duration:1e4,classNames:{actionButton:"!bg-pacific",closeButton:"dark:!bg-shade dark:hover:bg-cloud bg-slate-50 border-slate-200 hover:border-transparent dark:border-input-dark text-black dark:text-white",toast:"dark:bg-extra-night bg-slate-100 dark:text-white text-black dark:border-input-dark border-slate-200"},action:{label:"Save",onClick:t},closeButton:!0,onDismiss:e,onAutoClose:e})}S.push("/sessions/".concat(t.substr(6)))}catch(e){if(e instanceof v.B){let t=await e.response.json();C.A.error("Cannot create Devin session. ".concat(t.detail))}throw el(!1),e}return!0},[l,ek,eg,ey,$,s,en,er,null==j?void 0:j.given_name,Q.ami_id,Q.snapshot_id,X,null==es?void 0:es.value,ed,eu.checked,eu.channelId,ee,S,_,m,E,Y,L,P,eF,B.devinState.status.enum]),eO=(0,b.b9)(aC._T),ez=(0,b.Dv)(F.i6);(0,N.useEffect)(()=>{eO(!!a)},[a,eO]),(0,N.useEffect)(()=>{B.devinState.messageHistoryEvents.length>0&&_.refetchQueries({queryKey:["userDevins-".concat(l,"-").concat(m)],type:"all"})},[B.devinState.messageHistoryEvents.length,m,_,l]);let[eI,eL]=(0,b.KO)(aC.g4),[eZ,eP]=(0,b.KO)(aC.sf);(0,N.useEffect)(()=>{eP(!1)},[s,eP]);let[eR,eK]=(0,b.KO)(aC.kj),eU=(0,N.useCallback)(e=>{ei(t=>t.filter(t=>t!==e))},[ei]),eV=(0,N.useCallback)(e=>{e.controller.abort(),ei(t=>t.filter(t=>t!==e))},[ei]),eH=(0,N.useCallback)((e,t)=>{ef(new File([t],e,{type:"text/plain"}))},[ef]),[eW,eq]=(0,b.KO)(F.vl);(0,N.useEffect)(()=>{ej&&eq(ej.title||"Untitled")},[ej,eq]);let eB=(0,N.useCallback)(async(e,t)=>{let a=(await (0,e_.al)(s||"",e,t)).devin_id;S.push("/sessions/".concat(a.substr(6)),{})},[s,S]),{renameInputRef:eY,sessionName:eJ,renameIsEnabled:eG,handleRenameChange:e$,handleRenameEnable:eX,handleRenameKeyDown:eQ,handleRenameOnBlur:e0}=sc(ej),e1=eM&&(ev||!x||0===z.length),e2=!!(eM&&!e1&&ew),e5=!!(e2&&ew instanceof v.B&&404===ew.response.status),e4=eM&&!e2&&!e1&&ej,e8=(0,N.useMemo)(()=>e4&&(ej.readonly||ej.is_example_session)&&ej.created_by.id!==l?[]:["write"],[e4,ej,l]),[e3,e7]=(0,N.useState)(0),e9=(0,N.useCallback)((e,t)=>{if(!t.target||!(t.target instanceof Element))return!0;let s="data-mobile-draggable-allow",a=t.target;return!(a.getAttribute(s)||a.closest("[".concat(s,"]")))},[]),[tt,ts]=(0,g.Z)({breakpoints:{"(min-width: 1024px)":{active:!1}},watchDrag:e9}),ta=(0,N.useCallback)(e=>{e7(e.selectedScrollSnap())},[]),tl=(0,N.useCallback)(()=>{P("stop"),t5.Z.trackInteraction(t5.j.TERMINATE_SESSION)},[P]);(0,N.useEffect)(()=>{ts&&(ta(ts),ts.on("reInit",ta),ts.on("select",ta))},[ts,ta]),function(){var e;let{isSignedIn:t,sessionId:s}=(0,T.aC)(),{user:a}=(0,T.aF)(),{data:l}=(0,tF.o8)(),n=(0,eb.b1)(),r=(0,aN.E_)(),[i]=(0,b.KO)(aC.kj),[o,d]=(0,N.useState)(!1),c=("20240910a"===n.billingExperimentVersion||"20240910b"===n.billingExperimentVersion)&&(null===(e=r.data)||void 0===e?void 0:e.available_acus)&&r.data.available_acus<=1,u=(0,N.useRef)(!1);(0,N.useEffect)(()=>{a_&&t&&!o&&(ak.Z.init(3853323,6),d(!0))},[t,o]),(0,N.useEffect)(()=>{if(o&&t&&a){let e={id:null==a?void 0:a.user_id,fullName:null==a?void 0:a.name,email:null==a?void 0:a.email,orgId:null==l?void 0:l.id,orgName:null==l?void 0:l.display_name,orgSlug:w().kebabCase(null==l?void 0:l.name),orgRole:null==l?void 0:l.role,sessionId:s,ENV:"production",billingExperimentVersion:n.billingExperimentVersion,isEnterprise:n.isEnterprise,planUsesCredits:n.planUsesCredits,hasSubscriptionOrCredits:n.hasSubscriptionOrCredits,isSubscriptionValid:n.isSubscriptionValid,billingMethod:n.billingMethod};ak.Z.identify(a.user_id,e)}},[t,a,l,s,o,n]),(0,N.useEffect)(()=>{if(!o)return;let e=document.querySelector("._hj_feedback_container");e&&(e.style.display=i?"none":"block")},[i,o]),(0,N.useEffect)(()=>{o&&c&&!u.current&&(ak.Z.event("has_1_acu_left"),u.current=!0)},[c,o])}(),(0,N.useEffect)(()=>{let e=et.get("attachments");if(e&&!eh.current&&eF){let t=new URLSearchParams(et);eh.current=!0,t.delete("attachments");try{for(let t of JSON.parse(e))"pasted"===t.type?eH(t.name,t.contents):ei(e=>[...e,{url:t.contents,file:new File([],t.name,{type:"text/plain"}),controller:new AbortController}]);S.replace("".concat(ex,"?").concat(t.toString()))}catch(e){console.error("Error parsing attachments",e)}}},[eH,eF,ex,S,et]);let tn="finished"!==B.devinState.status.enum&&e8.includes("write")&&!(a&&!k),tr="clerk-org_2gRltRfqyiDFAFBOJHfWH9TxVJb"===m,ti={onSelectCustomDevin:ec,attachments:er,onChangePlaybookContents:eN,onSubmit:eA,emitLoopSignal:P,disabled:ea||B.devinState.status.isInputDisabled,isAboveUserLimits:B.devinState.status.isAboveUserLimits,handleAttachmentDelete:eU,handleAttachmentCancelUpload:eV,handleTextAttach:eH,permissions:e8,isDemoMode:a||!1,placeholderText:G,devinId:s,isHome:eF,isTechnicalPreview:tr,isAlternateTimeline:-1!==B.timelineState.selectedTimelineIndex,onSelectSlackChannel:ep,inputBoxOpen:eC,setInputBoxOpen:eE,humanModeEnabled:!1},td=(0,eT._Z)(),tc=(0,N.useMemo)(()=>{var e;return null===(e=B.devinState.lastPRCreatedEvent)||void 0===e?void 0:e.pr_data},[B.devinState.lastPRCreatedEvent]),tu=(0,n.jsxs)(sy,{className:(0,eD.cn)("dark:shadow-extra-night dark:bg-shade rounded-0 relative flex h-full min-w-0 flex-col bg-white shadow-md focus-visible:outline-none sm:pb-[1.5rem] md:rounded-[0.5rem] md:pb-[2rem]"),onUploadFile:ef,disabled:ez,children:[!eI&&(0,n.jsx)(aw,{collapsed:eI,onClick:()=>eL(!0),className:"absolute left-0 top-1/2 hidden -translate-y-1/2 lg:!block"}),eF&&(0,n.jsx)(N.Suspense,{children:(0,n.jsx)(s9,{...ti})}),e4&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{overflowWrap:"anywhere"},className:"hidden px-6 py-5 shadow-sm lg:block",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between text-2xl font-bold",children:[(0,n.jsx)(sd,{sessionName:eJ,handleRenameChange:e$,handleRenameKeyDown:eQ,handleRenameOnBlur:e0,renameIsEnabled:eG,renameInputRef:eY}),l&&(0,n.jsxs)("div",{className:"flex flex-row items-center pl-4",children:[td&&(0,n.jsx)("button",{className:(0,f.Z)(" rounded-md ","ml-1 mr-4 lg:ml-auto"),onClick:()=>window.open("".concat(window.location.origin).concat(window.location.pathname,"/wdw"),"_blank"),title:"Open WDW",children:(0,n.jsx)(i.w,{className:"h-6 w-6 dark:text-white"})}),tn?(0,n.jsxs)(n.Fragment,{children:["rolledBack"!==B.devinState.status.enum&&(0,n.jsx)(rm,{isPaused:Y,emitLoopSignal:P}),(0,n.jsx)(ro,{onKill:tl,className:"ml-1 mr-4 lg:ml-auto",sessionId:s})]}):null,(0,n.jsx)(so,{session:ej,handleRenameEnable:eX})]})]}),(0,n.jsxs)("div",{className:"flex h-8 w-full flex-row items-center",children:[(0,n.jsxs)("div",{className:"flex flex-row items-center",children:[!!ej.custom_devin&&(0,n.jsx)("div",{className:"mr-4 flex-shrink-0",children:(0,n.jsx)(rk,{customDevin:ej.custom_devin})}),(0,n.jsx)(rw,{snapshotUsed:eo,orgName:ej.organization.name}),tc&&(0,n.jsx)("div",{className:"ml-auto hidden flex-shrink-0 items-center text-black opacity-50 lg:flex dark:text-white",children:(0,n.jsxs)("a",{href:"https://github.com/".concat(tc.owner,"/").concat(tc.repo,"/pull/").concat(tc.pull_number),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 rounded-md text-xs font-medium text-black transition-all duration-200 hover:!text-blue-500 hover:underline dark:text-white",children:[(0,n.jsx)(o.Q,{size:14}),"View PR #",tc.pull_number]})})]}),(null===(t=ej.organization.name)||void 0===t?void 0:t.length)&&td&&(0,n.jsx)("div",{className:"ml-auto hidden flex-shrink-0 items-center text-black opacity-50 lg:flex dark:text-white",children:(0,n.jsx)("span",{className:"text-xs font-medium",children:ej.organization.name})})]})]}),(0,n.jsx)(lN,{devin:ej,isDemoMode:a||!1,isExample:ej.is_example_session,emitUpdateMasterPlan:R,emitHumanModeUserResponse:V,emitRestoreToCheckpoint:Z}),(0,n.jsx)(M,{devinId:s}),(0,n.jsx)(tq,{devinId:s}),(0,n.jsx)(tJ,{emitSpeedUpdate:U}),(0,n.jsx)(rv,{}),(0,n.jsx)(aw,{collapsed:eR,onClick:()=>{eK(!eR)},direction:"right",className:"absolute right-0 top-1/2 z-20 hidden -translate-y-1/2 lg:!block"})]}),e5&&(0,n.jsx)(aj.m,{title:"404",description:"This page could not be found."}),e2&&!e5&&(0,n.jsx)(aj.m,{title:"Error",description:"Internal error."}),!e1&&!e2&&eM&&(0,n.jsx)(N.Suspense,{children:(0,n.jsx)("div",{className:(0,eD.cn)("relative z-40 mx-auto mt-10 w-full","sm:px-4 sm:pt-2"),style:{marginTop:"auto"},children:(0,n.jsx)(sI,{...ti})})}),e1&&(0,n.jsx)(to.T,{size:"md"})]});return(0,n.jsxs)(D.Pn.Provider,{value:B,children:[(0,n.jsx)(sN,{onUploadFile:ef}),(0,n.jsx)(s_.et,{setSecrets:K,sessionSecrets:W}),(0,n.jsx)(eb.qI,{}),(0,n.jsx)(eb.vD,{}),(0,n.jsxs)("div",{className:(0,f.Z)("absolute left-0 top-0 flex h-full w-full flex-shrink-0 flex-col transition-all duration-150 lg:static lg:w-auto lg:flex-1",!eI&&"left-[0px] lg:left-[270px]"),children:[(0,n.jsx)("div",{id:"sidebar-overlay",className:(0,f.Z)("bg-shade absolute left-0 top-0 z-10 h-full w-full bg-opacity-50 lg:hidden",eI&&"hidden"),onClick:()=>{eL(!0)}}),(0,n.jsx)("div",{className:"dark:bg-night relative border-b border-b-[#c9c4c4] bg-white p-3 lg:hidden dark:border-b-[#5d5a5a]",children:(0,n.jsx)(rf,{hasDevin:!!ej,title:eW||"Untitled",canUserInteractWithDevin:tn,isSettings:!1,devinId:s,snapshotName:null==eo?void 0:eo.snapshot_name,handleKillSession:tl,userId:l||""})}),(0,n.jsx)("div",{className:(0,f.Z)("flex-1 overflow-hidden p-0 md:p-[1rem]",eZ?"pl-8":"pl-0 md:pl-[1rem]"),ref:tt,children:(0,n.jsxs)("div",{className:(0,eD.cn)("relative h-full w-full gap-4 lg:w-auto",eF?"flex flex-row":"flex h-full flex-row lg:grid lg:grid-cols-2 lg:grid-rows-1"),children:[q&&(0,n.jsx)(sD.u,{content:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"text-xs",children:"Connection with the server was lost, attempting to reconnect automatically."}),(0,n.jsx)("div",{className:"text-xs",children:"You may try refreshing the page for updated results"})]}),side:"top",className:"px-2 py-1",delayDuration:200,children:(0,n.jsxs)("div",{className:"disconnected absolute left-1/2 top-[5px] z-50 flex -translate-x-1/2 transform items-center gap-2 rounded-xl bg-stone-800 px-4 py-1 text-sm shadow-2xl transition duration-700 ease-in-out md:top-[-5px]",children:[(0,n.jsx)("span",{className:"text-white",children:"Reconnecting"}),(0,n.jsx)(d.U,{size:18,className:"animate-spin text-[#6096FF]"})]})}),!eZ&&(0,n.jsx)("div",{className:eF?"lg:flex-basis-[50%] flex-[0_0_100%] lg:flex-1 ":eR?"flex-[0_0_100%] lg:col-span-2":"flex-[0_0_100%] lg:col-span-1",children:tu}),!eF&&(0,n.jsxs)("div",{className:(0,eD.cn)("dark:bg-shade dark:shadow-extra-night rounded-0 relative min-w-0 flex-[0_0_100%] bg-white shadow-md transition-all duration-200 md:rounded-[0.5rem] lg:flex-none",eR?"hidden":eZ?"lg:col-span-2":"lg:col-span-1"),children:[(0,n.jsx)(aw,{collapsed:!eZ,direction:"right",onClick:()=>eP(!eZ),className:"absolute left-0 top-1/2 hidden -translate-y-1/2 lg:!block"}),(0,n.jsx)("div",{className:(0,eD.cn)("workspace-container home-panel lg:dark:bg-shade h-full w-full overflow-y-auto rounded-[0.5rem] bg-white px-5 pb-[20px] pt-3.5 transition duration-75 md:px-6 md:pb-[34px] md:pt-6 dark:bg-[#242424]"),children:(0,n.jsx)(rs,{devin:ej,devinId:s,isDemoMode:!!a,onKill:tl,emitUpdateMasterPlan:R,emitUserMessage:L,emitRestoreToCheckpoint:Z,emitHumanModeUserResponse:V,emitHumanModeStatus:H,onReviveDevin:eB})})]})]})}),e4&&!eC&&(0,n.jsxs)("div",{className:"dark:bg-night flex bg-white lg:hidden dark:border dark:border-t-[#2e2e2e]",children:[(0,n.jsx)("button",{className:(0,f.Z)("flex flex-1 flex-col items-center justify-center py-3 text-xs font-medium",0===e3?"cursor-default text-[#6096FF]":"text-[#8f8f8f] hover:text-[#7b7b7b]"),onClick:()=>{null==ts||ts.scrollTo(0)},children:(0,n.jsx)(c.j,{size:22,className:"mb-1"})}),(0,n.jsx)("button",{className:(0,f.Z)("flex flex-1 flex-col items-center justify-center py-3 text-xs font-medium",1===e3?"cursor-default text-[#6096FF]":"text-[#8f8f8f] hover:text-[#7b7b7b]"),onClick:()=>{null==ts||ts.scrollTo(1)},children:(0,n.jsx)(u.H,{size:22,className:"mb-1"})})]})]})]})}let rw=e=>{let{snapshotUsed:t}=e,s=null==t?void 0:t.deleted,a=null==t?void 0:t.snapshot_name,l=null==t?void 0:t.snapshot_id;return a?(0,n.jsx)("div",{className:"text-ray flex w-full items-center",children:(0,n.jsx)("div",{className:"flex w-full flex-shrink items-center overflow-hidden",children:t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"mr-1 w-min whitespace-nowrap text-xs font-semibold",children:"Started from snapshot:"}),(0,n.jsxs)("div",{className:(0,f.Z)("flex w-min items-center whitespace-nowrap pr-2",s?"cursor-default":"group"),children:[s?(0,n.jsx)("span",{className:"!max-w-[120px] truncate text-xs lg:max-w-[270px]",children:a}):(0,n.jsx)(k.default,{className:"!max-w-[120px] truncate text-xs duration-150 group-hover:underline lg:max-w-[270px]",href:"/snapshots/".concat((0,eC.I)(l)),children:a}),s?(0,n.jsx)("span",{className:"ml-1 text-xs font-medium",children:"[DELETED]"}):(0,n.jsx)(m.r,{size:13,className:"ml-1 opacity-0 duration-75 group-hover:opacity-100"})]})]})})}):null},rk=e=>{let{customDevin:t}=e,s={"devin-sparkop-0607":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.J,{}),"SparkOps Devin"]})};return t&&s[t]?(0,n.jsx)("div",{className:"flex items-center gap-1 text-xs text-green-400",children:s[t]}):null}},22785:function(e,t,s){"use strict";s.d(t,{P:function(){return h},Z:function(){return p}});var a=s(27573),l=s(18914),n=s(18544),r=s(57908),i=s(81086),o=s(43478),d=s(7653),c=s(70987),u=s(53358),m=s(3830),x=s(75113);let h=e=>{let{orgId:t}=e,[s,l]=(0,d.useState)([]),[,n]=(0,i.KO)(m._Z),{data:r,isLoading:o}=(0,c.nA)(t);return(0,d.useEffect)(()=>{r&&!o&&l([{value:"None",label:"None"},...r.sort((e,t)=>new Date(t.last_seen_at).getTime()-new Date(e.last_seen_at).getTime()).map(e=>({value:e.orchestrator_id,label:e.orchestrator_id}))])},[r,o]),(0,a.jsx)(u.P,{placeholder:"Select orchestrator",itemsList:s,defaultValue:"",onValueChange:e=>n({value:e,label:e})})},p=e=>{let{isInModal:t,isEditing:s,snapshotStartupCommands:n,setSnapshotStartupCommands:i}=e;(0,d.useEffect)(()=>{s&&0===n.length&&i([""])},[s,i,n]);let c=(0,d.useMemo)(()=>""===n[(null==n?void 0:n.length)-1],[n]),u=(e,t)=>{let s=[...n];s[t]=e,i(s)},m=e=>{if(1===n.length){i([""]);return}let t=[...n];t.splice(e,1),i(t)};return(0,a.jsxs)("div",{className:(0,r.Z)(s?"border-dashed border-slate-300":"border-solid",t?"border-none":"border","dark:border-input-dark mt-3 flex flex-col rounded-[6px] border dark:shadow-sm"),children:[(0,a.jsxs)("div",{className:(0,r.Z)(t?"border-none text-slate-700 dark:text-white":"dark:bg-shade dark:border-input-dark rounded-t-md border-b border-gray-300 bg-blue-50 opacity-80 shadow-sm dark:text-gray-200 dark:shadow-md","flex items-center px-2 py-1 text-sm font-medium text-black"),children:[(0,a.jsx)(x.u,{content:(0,a.jsxs)("ul",{className:"text-xs",children:[(0,a.jsx)("li",{children:"1. Startup commands run in the home directory"}),(0,a.jsx)("li",{children:"2. They execute in the order listed"}),(0,a.jsx)("li",{children:"3. Each command has a 2 minute timeout"})]}),side:"bottom",className:"px-2 py-1",delayDuration:100,children:(0,a.jsx)(o.Z,{size:13,className:"mr-1"})}),"Startup commands"," ",t?(0,a.jsxs)("span",{className:"ml-1 text-xs font-normal",children:["(automatically run on snapshot startup from the"," ",(0,a.jsx)("b",{children:"home directory"}),")"]}):null]}),(0,a.jsxs)("div",{className:(0,r.Z)(t?"rounded-md border dark:border-none dark:bg-[#121212]":"dark:bg-night rounded-b-md bg-slate-100","flex flex-col text-black dark:text-white"),children:[n.length?n.map((e,t)=>(0,a.jsx)(f,{command:e,editStartupCommand:u,index:t,isEditing:s,removeCommand:m},t)):(0,a.jsx)("div",{className:"flex w-full justify-center py-1.5 text-[10.5px] opacity-50",children:"No startup commands"}),(0,a.jsxs)("div",{onClick:s?()=>{(null==n?void 0:n.length)?c||i([...n,""]):i([""])}:()=>{},className:(0,r.Z)(s?"z-[1] h-7 opacity-80":"-z-10 h-0 opacity-0",c?"cursor-initial text-gray-400":"dark:hover:bg-extra-night cursor-pointer hover:bg-gray-200","dark:border-input-dark flex items-center justify-center rounded-b-md border-t border-dotted border-gray-400 px-2 text-[10.5px] duration-150"),children:[(0,a.jsx)("span",{className:"mr-1",children:"Add"}),(0,a.jsx)(l.F,{size:18})]})]})]})},f=e=>{let{command:t,editStartupCommand:s,index:l,isEditing:i,removeCommand:o}=e,c=(0,d.useRef)(null),u=()=>{if(c.current){c.current.style.height="auto";let e=Math.min(c.current.scrollHeight,60);c.current.style.height="".concat(e,"px")}};return(0,d.useEffect)(()=>{u()},[t]),(0,a.jsxs)("div",{className:(0,r.Z)(i?"opacity-100":"opacity-40","dark:border-input-dark group relative flex w-full items-center border-t border-dotted border-gray-400 first:border-0"),children:[(0,a.jsx)("textarea",{ref:c,className:" w-full resize-none overflow-hidden overflow-y-scroll bg-transparent px-2 py-1.5 font-mono text-[10.5px] last:rounded-b-md focus:outline-slate-400",onChange:e=>{s(e.target.value,l),u()},value:t,rows:1,disabled:!i,spellCheck:"false",autoCorrect:"off",autoCapitalize:"off",placeholder:"Enter command",style:{minHeight:"1.5rem",maxHeight:"10rem"}}),(0,a.jsx)(n.S,{onClick:()=>o(l),className:(0,r.Z)(i?"cursor-pointer hover:text-red-500 hover:opacity-80 group-hover:opacity-60":"cursor-initial","absolute right-1.5 top-1/2 -translate-y-1/2 opacity-0 duration-150")})]})}},48912:function(e,t,s){"use strict";var a=s(27573),l=s(7653);t.Z=function(e){let{children:t}=e,[s,n]=l.useState(!1);return l.useEffect(()=>{n(!0)},[]),(0,a.jsx)(l.Fragment,{children:s?t:null})}},39029:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(27573),l=s(65880);function n(e){let{size:t,className:s}=e;return(0,a.jsx)(l.default,{src:"/devin.svg",width:t,height:t,unoptimized:!0,alt:"Devin",className:s})}},6472:function(e,t,s){"use strict";s.d(t,{f:function(){return m}});var a=s(27573),l=s(65322),n=s(23209),r=s(81086),i=s(7653),o=s(38077),d=s(55076),c=s(38242),u=s(2147);let m=e=>{let{icon:t}=e,[s,m]=(0,r.KO)(c.g4),{data:x=[]}=(0,d.dL)(),h=(0,i.useMemo)(()=>x.some(e=>"waiting"===(0,o.eR)(e)),[x]);return(0,a.jsxs)("button",{className:"relative",onClick:()=>m(!s),children:["dashes"===t?(0,a.jsx)(l.h,{size:24,className:"text-[#6096FF]"}):(0,a.jsx)(n.a,{size:24,className:"text-[#6096FF] dark:text-white"}),h&&(0,a.jsx)("div",{className:"absolute right-0 top-0",children:(0,a.jsx)(u.J,{status:"waiting",size:"small",animate:!0})})]})}},2147:function(e,t,s){"use strict";s.d(t,{J:function(){return r}});var a=s(27573),l=s(57908);s(7653),s(83599);let n=e=>{switch(e){case"working":case"initializing":case"resume_requested":return"status-icon--working";case"waiting":case"suspend_requested":return"status-icon--waiting";case"blocked":return"status-icon--blocked";case"finished":return"status-icon--finished";case"rolledBack":return"status-icon--rolled-back";case"queued":return"status-icon--queued";case"paused":case"pause":return"status-icon--paused";default:return""}},r=e=>{let{status:t,size:s,animate:r=!1,className:i=""}=e;return(0,a.jsx)("div",{className:(0,l.Z)("status-icon",i,n(t),{"status-icon--big":"big"===s,"status-icon--small":"small"===s,"status-icon--animate":"finished"!==t&&r})})}},34630:function(e,t,s){"use strict";s.d(t,{$:function(){return y},s:function(){return k}});var a=s(27573),l=s(66045),n=s(73360),r=s(26821),i=s(57908),o=s(81086),d=s(30449),c=s(12310),u=s(95623),m=s(7653),x=s(54154),h=s(4652),p=s(32992),f=s(12122),g=s(3830),b=s(94873),v=s(75419),j=s(76999),w=s(21138);function k(e){let{type:t,name:s,id:r,allowNavigate:o,isHome:d,onClick:m}=e,x=(0,f.F)(e=>e.setCurrentTab),{removeSelectedPlaybook:h,removeSelectedSnapshot:p}=(0,f.F)(),g=()=>{"snapshot"===t?p():h()};return(0,a.jsxs)("button",{className:(0,b.cn)("group flex h-fit w-fit items-center rounded-full border border-current bg-transparent font-light outline-none transition-colors focus:outline-none","snapshot"===t?"text-ray hover:bg-ray/10":"text-pacific hover:bg-pacific/10"),onClick:()=>{o&&d?(x("select_".concat(t)),null==m||m(!1)):(0,v.n)(t,r)},children:[(0,a.jsxs)("div",{className:"mr-1 flex items-center gap-2 py-1 pl-2",children:["snapshot"===t?(0,a.jsx)(l.H,{size:14}):(0,a.jsx)(c.Z,{size:14}),(0,a.jsx)("span",{className:"max-w-[200px] truncate",children:s})]}),(0,a.jsx)("div",{className:(0,i.Z)("flex h-full items-center p-1.5","snapshot"===t?"hover:bg-ray/20":"hover:bg-pacific/20"),onClick:e=>{e.stopPropagation(),(0,v.n)(t,r)},title:"Copy to clipboard",children:(0,a.jsx)(n.w,{size:14})}),(0,a.jsx)("div",{className:(0,i.Z)("h-full rounded-r-full py-1.5 pl-1 pr-2","snapshot"===t?"hover:bg-ray/20":"hover:bg-pacific/20"),onClick:e=>{e.stopPropagation(),g()},title:"Remove",children:(0,a.jsx)(u.Z,{size:14})})]})}function y(){let e=(0,r.NL)(),{userId:t,orgId:s}=(0,h.aC)(),l=(0,f.F)(e=>e.setSelectedConfig),n=(0,f.F)(e=>e.selectedPlaybook),i=(0,f.F)(e=>e.selectedSnapshot),c=async a=>{try{let e=(await (0,p.ZA)(a)).id;a.is_default&&await (0,p.vB)(e),l({configId:e,playbook:n,snapshot:i}),x.A.success("Shortcut saved!"),b(!1),_(""),y(!1)}catch(e){if(e instanceof d.B){let t=await e.response.json();(null==t?void 0:t.detail)&&x.A.error(t.detail)}}finally{e.invalidateQueries({queryKey:["shortcuts",t,s]})}},[u,b]=(0,o.KO)(g.qb),[v,y]=(0,m.useState)(!1),[C,_]=(0,m.useState)(()=>{let e=" Shortcut";return i.snapshot_id!==f._.snapshot_id&&(e=N(i.snapshot_name)+e),n&&(e=N(n.title)+e),e});return(0,a.jsx)(w.Vq,{open:u,onOpenChange:b,modal:!0,children:(0,a.jsxs)(w.cZ,{className:"outline-none sm:max-w-[525px]",children:[(0,a.jsx)(w.fK,{children:(0,a.jsx)(w.$N,{className:"mb-1 text-xl tracking-tight",children:"Save as shortcut"})}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c({is_default:v,title:C,playbook_id:(null==n?void 0:n.id)||null,snapshot_id:i.snapshot_id})},className:"flex flex-col gap-4",children:[(0,a.jsx)("input",{value:C,onChange:e=>_(e.target.value),placeholder:"Shortcut name",className:"dark:border-input-dark placeholder:text-cloud min-w-full rounded-md border border-neutral-300 px-2.5 py-1.5 text-sm leading-6 outline-none transition focus-within:border-neutral-400 focus:outline-none dark:text-white",required:!0}),(0,a.jsx)("div",{className:"mx-1 flex w-full items-center gap-2 pr-2 text-sm",children:(0,a.jsxs)("label",{className:"flex w-full cursor-pointer items-center gap-2",children:["Make this my default",(0,a.jsx)(j.X,{checked:v,onCheckedChange:e=>y(!0===e),className:"ml-auto text-white dark:text-black"})]})}),(0,a.jsx)("hr",{className:"dark:border-input-dark mx-auto my-3 w-1/2 border-t opacity-80"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3 text-sm",children:[n&&(0,a.jsx)(k,{type:"playbook",name:n.title,id:n.id}),i&&i.snapshot_id!==f._.snapshot_id&&(0,a.jsx)(k,{type:"snapshot",name:i.snapshot_name,id:i.snapshot_id})]}),(0,a.jsx)("button",{disabled:0===C.trim().length,className:"bg-pacific disabled:bg-pacific mt-1 w-full rounded-md px-2 py-2 text-sm text-white transition hover:bg-blue-500 disabled:opacity-40",children:"Save"})]})]})})}let N=e=>e.split(/-|\s+/)[0]},76999:function(e,t,s){"use strict";s.d(t,{X:function(){return o}});var a=s(27573),l=s(35592),n=s(83017),r=s(7653),i=s(94873);let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.fC,{ref:t,className:(0,i.cn)("border-primary ring-offset-background focus-visible:ring-ring data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground peer h-4 w-4 shrink-0 rounded-sm border-[1.5px] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-30",s),...r,children:(0,a.jsx)(n.z$,{className:(0,i.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(l.J,{weight:"bold"})})})});o.displayName=n.fC.displayName},13105:function(e,t,s){"use strict";s.d(t,{$F:function(){return d},AW:function(){return p},Ph:function(){return m},Qk:function(){return c},TG:function(){return h},Xi:function(){return f},cq:function(){return u},h_:function(){return o},kt:function(){return x}});var a=s(27573),l=s(44453),n=s(1138),r=s(7653),i=s(94873);let o=l.fC,d=l.xz,c=l.ZA,u=l.Uv,m=l.Tr,x=r.forwardRef((e,t)=>{let{className:s,inset:r,children:o,...d}=e;return(0,a.jsxs)(l.fF,{ref:t,className:(0,i.cn)("focus:bg-accent data-[state=open]:bg-accent flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none",r&&"pl-8",s),...d,children:[o,(0,a.jsx)(n.Z,{className:"ml-auto h-4 w-4"})]})});x.displayName=l.fF.displayName;let h=r.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(l.tu,{ref:t,className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] overflow-hidden rounded-md border p-1 shadow-lg",s),...n})});h.displayName=l.tu.displayName;let p=r.forwardRef((e,t)=>{let{className:s,sideOffset:n=4,...r}=e;return(0,a.jsx)(l.Uv,{children:(0,a.jsx)(l.VY,{ref:t,sideOffset:n,className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] overflow-hidden rounded-md border p-1 shadow-md",s),...r})})});p.displayName=l.VY.displayName;let f=r.forwardRef((e,t)=>{let{className:s,inset:n,...r}=e;return(0,a.jsx)(l.ck,{ref:t,className:(0,i.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:cursor-pointer data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",s),...r})});f.displayName=l.ck.displayName},96719:function(e,t,s){"use strict";s.d(t,{k:function(){return i},l:function(){return o}});var a=s(27573),l=s(7653),n=s(58045);let r=(0,l.createContext)({immersiveLiveMode:!1,toggleImmersiveLiveMode:()=>{}}),i=()=>(0,l.useContext)(r),o=e=>{let{children:t}=e,[s,i]=(0,n.Z)("immersive-live-mode",!1),[o,d]=(0,l.useState)(null!=s&&s);return(0,l.useEffect)(()=>{i(o)},[o,i]),(0,a.jsx)(r.Provider,{value:{immersiveLiveMode:o,toggleImmersiveLiveMode:()=>{d(!o)}},children:t})}},26347:function(e,t,s){"use strict";s.d(t,{Z:function(){return i},r:function(){return r}});var a=s(27573),l=s(7653),n=s(58045);let r=(0,l.createContext)({input:"",setInput:()=>{},devinInputMap:{},setDevinInputMap:()=>{}});function i(e){let{children:t}=e,[s,i]=(0,n.Z)("chat-msg-input",""),[o,d]=(0,l.useState)(s),[c,u]=(0,l.useState)({});(0,l.useEffect)(()=>{i(o)},[o,i]);let m=(0,l.useRef)(null);return(0,a.jsx)(r.Provider,{value:{input:o,setInput:d,devinInputMap:c,setDevinInputMap:u,inputRef:m},children:t})}},72053:function(e,t,s){"use strict";s.d(t,{C:function(){return r},Z:function(){return n}});var a=s(27573),l=s(7653);let n=l.createContext({windowIsActive:!1}),r=e=>{let{children:t}=e,[s,r]=(0,l.useState)(!0),i=e=>"boolean"==typeof e?e?r(!0):r(!1):document.hidden?r(!1):r(!0);return(0,l.useEffect)(()=>{let e=()=>i(!1),t=()=>i(!0);return document.addEventListener("visibilitychange",i),document.addEventListener("blur",e),window.addEventListener("blur",e),window.addEventListener("focus",t),document.addEventListener("focus",t),()=>{window.removeEventListener("blur",i),document.removeEventListener("blur",e),window.removeEventListener("focus",e),document.removeEventListener("focus",t),document.removeEventListener("visibilitychange",t)}},[]),(0,a.jsx)(n.Provider,{value:{windowIsActive:s},children:t})}},89588:function(e,t,s){"use strict";s.d(t,{t:function(){return l}});var a=s(7653);let l=window.matchMedia("(max-width: 1279px)").matches,n=window.matchMedia("(max-width: 768px)").matches;t.Z=()=>{let[e,t]=(0,a.useState)(l),[s,r]=(0,a.useState)(n);return(0,a.useEffect)(()=>{let e=()=>{let e=window.matchMedia("(max-width: 1279px)").matches,s=window.matchMedia("(max-width: 768px)").matches;t(e),r(s)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),{isMobile:e,isSmallerMobile:s}}},32609:function(e,t,s){"use strict";s.d(t,{n:function(){return l}});var a=s(67754);function l(){let e=(0,a.useParams)().slug;return"devin-".concat(e)}},20734:function(e,t,s){"use strict";s.d(t,{$:function(){return a}});let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return+parseFloat(e.toString()).toFixed(t)}},2174:function(e,t,s){"use strict";s.d(t,{W2:function(){return r},yq:function(){return b},gx:function(){return v},nK:function(){return y},lp:function(){return C}});var a=s(27573),l=s(57908),n=s(7653);let r=e=>{let{children:t,className:s}=e;return(0,a.jsx)("div",{className:(0,l.Z)("flex h-full w-full flex-1 flex-col px-6 pb-6",s),children:t})};var i=s(76788),o=s(87659),d=s(53358);let c=e=>{let{setSearchTerm:t,searchPlaceholder:s,createLink:l,createText:n,createAction:r}=e;if(r&&l)throw Error("ListSearch cannot have both createAction and createLink");return(0,a.jsxs)("div",{className:"flex h-8 w-full justify-between lg:w-auto",children:[(0,a.jsxs)("label",{className:"relative mr-2.5 flex w-[200px] items-center text-[#8F8F8F]",children:[(0,a.jsx)("input",{type:"text",placeholder:s,className:"peer h-full w-full rounded-lg border border-[#f2f2f2] py-2 pl-9 pr-3 text-xs font-medium focus:!border-[#5e5e5e] focus:outline-none dark:border-[#8F8F8F] dark:bg-[#2e2e2e] dark:focus:!border-[#ffffff]",onChange:e=>t(e.target.value)}),(0,a.jsx)(i.Y,{size:14,className:"absolute left-[11px] top-1/2 -translate-y-1/2 peer-focus:text-[#5e5e5e] dark:peer-focus:!text-white"})]}),l&&n&&(0,a.jsx)(o.default,{href:l,className:"shrink-0 rounded-md bg-[#6096FF] px-2 py-2 text-xs font-medium text-white hover:bg-[#4f88fb] active:bg-[#437df3] lg:mt-0",children:n}),r&&n&&(0,a.jsx)(d.z,{onClick:r,className:"py-2 text-xs",theme:"primary",loading:!1,defaultTitle:n,size:"sm"})]})};var u=s(1869);let m=n.forwardRef((e,t)=>{let{children:s,...l}=e;return(0,a.jsx)(u.fC,{className:"flex w-full grow flex-col overflow-hidden",...l,ref:t,children:s})});m.displayName="TabsContent";let x=n.forwardRef((e,t)=>{let{children:s,className:n,...r}=e;return(0,a.jsx)(u.VY,{className:(0,l.Z)("relative w-full grow overflow-y-auto [&:not([hidden])]:flex",n),...r,ref:t,children:s})});x.displayName="TabsContent";let h=n.forwardRef((e,t)=>{let{children:s,...l}=e;return(0,a.jsx)(u.aV,{className:"mt-4 w-full overflow-y-auto lg:mr-6 lg:mt-0 lg:w-auto",...l,ref:t,children:s})});h.displayName="TabsList";let p=n.forwardRef((e,t)=>{let{children:s,className:n,...r}=e;return(0,a.jsx)(u.xz,{...r,ref:t,className:(0,l.Z)("mr-6 text-xs font-bold data-[state=active]:text-gray-600 data-[state=inactive]:text-[#8F8F8F] hover:data-[state=inactive]:text-[#6e6e6e] dark:data-[state=active]:text-white dark:hover:data-[state=inactive]:text-[#c3c3c3]",n),children:s})});p.displayName="TabsTrigger";let f="";function g(e){if(f&&e.find(e=>e.value===f))return f;for(let t of e)if(t.list.length>0)return f=t.value,t.value;return e[0].value}function b(e){let{createLink:t,createText:s,createAction:r,lists:i,children:o,searchPlaceholder:d,setSearchTerm:u,action:b}=e,[v,j]=(0,n.useState)(g(i)),w=(0,n.useCallback)(e=>{j(e),f=e},[j]);return(0,n.useEffect)(()=>{j(g(i))},[j,i]),(0,a.jsxs)(m,{value:v,onValueChange:w,children:[(0,a.jsxs)("div",{className:(0,l.Z)("flex flex-col items-center justify-between pb-6 lg:flex-row-reverse",{"mb-10 border-b border-[#f2f2f2] dark:border-[#484848]":"manage"===b}),children:[(0,a.jsx)(c,{setSearchTerm:u,searchPlaceholder:d,createLink:t,createText:s,createAction:r}),(0,a.jsx)(h,{children:i.map(e=>(0,a.jsx)(p,{value:e.value,children:e.title},e.value))})]}),i.map(e=>(0,a.jsx)(x,{value:e.value,children:o(e.list,e.value)},e.value))]})}let v=e=>{let{id:t,value:s,onChange:l,placeholder:r,readOnly:i,supportMdLists:o}=e,d=(0,n.useRef)(null);return(0,a.jsx)("textarea",{ref:d,id:t,className:"scrollbar-hide flex-1 resize-none overflow-y-auto rounded-md border border-transparent bg-slate-50 p-3 text-sm outline-none focus:border-slate-200 dark:bg-[#484848] dark:text-white dark:focus:border-[#383838]",value:s,onChange:l,placeholder:r,readOnly:i,onKeyDown:e=>{if(!o)return;let t=d.current;if("Enter"===e.key&&!e.shiftKey){let s=t.value,a=s.substring(0,t.selectionStart).split("\n").length,l=s.split("\n").at(a-1);if(s.length>0&&l){let a=(t,s)=>{e.preventDefault(),document.execCommand("insertText",!1,"\n".concat(t+s))},n=()=>{let e=s.lastIndexOf("\n",t.selectionStart-1);t.selectionEnd=t.selectionStart,t.selectionStart=e,document.execCommand("delete",!1)},r=l.match(/^(\s*)(\d+)\.\s+(.*)/);r&&(r[3].trim().length>0?a(r[1],"".concat(Number(r[2])+1,". ")):n());let i=l.match(/^(\s*)(-|\*)\s+(.*)/);i&&(i[3].trim().length>0?a(i[1],"".concat(i[2]," ")):n())}}}})};var j=s(95014),w=s(68686),k=s(75113);let y=e=>{let{action:t,listHref:s,listTitle:l,itemTitle:n,title:r,titlePlaceholder:i,titleReadOnly:d=!1,onTitleChange:c,metadata:u}=e;return(0,a.jsx)("div",{className:"flex items-center justify-between border-b border-[#f2f2f2] dark:border-[#484848]",children:(0,a.jsx)("div",{className:"flex flex-grow pb-4",children:(0,a.jsxs)("div",{className:"flex flex-grow flex-col",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center text-xs font-bold text-[#8F8F8F]",children:[(0,a.jsx)("div",{children:"Library"}),(0,a.jsx)(j.T,{className:"mx-1",size:10}),(0,a.jsx)(k.u,{content:(0,a.jsxs)("div",{className:"px-2 py-1 text-xs",children:[l," list"]}),side:"bottom",delayDuration:100,children:(0,a.jsx)(o.default,{href:s,className:"transition hover:text-[#7f7f7f] dark:hover:text-neutral-300",children:l})}),(0,a.jsx)(j.T,{className:"mx-1",size:10}),(0,a.jsx)("div",{children:n})]}),(0,a.jsx)("div",{className:"mb-2.5 mt-2 flex flex-grow",children:(0,a.jsx)("div",{className:"flex flex-grow flex-col",children:(0,a.jsx)("input",{type:"text",className:"read-only:dark:bg-shade text-ellipsis rounded-md border border-transparent bg-slate-50 py-1 pl-2 pr-2 text-xl font-bold tracking-tight read-only:cursor-default read-only:pl-0 focus:border-slate-200 focus:outline-none read-only:focus:border-transparent dark:bg-[#484848] dark:text-white dark:focus:border-[#383838] read-only:dark:focus:border-transparent",value:r,onChange:c,placeholder:i,readOnly:d,autoFocus:"create"===t})})}),(0,a.jsx)(N,{data:u})]})})})},N=e=>{let{data:t}=e,[s]=(0,w.Z)(!0),l=s?t[0]:t[1];return(0,a.jsx)("button",{className:"space-x-2 text-left text-xs font-bold text-[#8F8F8F] disabled:cursor-auto",disabled:1===t.length,children:l.map(e=>(0,a.jsx)(k.u,{content:(0,a.jsx)("div",{className:"px-2 py-1 text-xs",children:e.label}),delayDuration:100,children:(0,a.jsx)("span",{children:e.value})},e.label))})},C=e=>(0,n.useMemo)(()=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",[e])},52738:function(e,t,s){"use strict";s.d(t,{DH:function(){return n},K3:function(){return o},Kk:function(){return l},Lp:function(){return c},PQ:function(){return u},aL:function(){return d},kT:function(){return r},mq:function(){return m},vX:function(){return i}});var a=s(29484);async function l(){return(await a.L.get("learning/all").json()).learnings}async function n(e){return await a.L.get("learning/".concat(e)).json()}async function r(e){return await a.L.post("learning",{json:e}).json()}async function i(e,t){return await a.L.put("learning/".concat(e),{json:t}).json()}async function o(e){return await a.L.delete("learning/".concat(e)).json()}async function d(e){return await a.L.post("knowledge/generate-scope",{json:e}).json()}async function c(e){return await a.L.get("knowledge-suggestions/suggestions/".concat(e)).json()}async function u(e,t,s){return await a.L.put("knowledge-suggestions/suggestions/".concat(e),{json:{action:t,trigger:s}}).json()}async function m(e,t){return await a.L.put("knowledge-suggestions/suggestions/".concat(e),{json:{action:"edit",new_value:t}}).json()}},18594:function(e,t,s){"use strict";s.d(t,{$x:function(){return o},Gu:function(){return l},gm:function(){return c},z7:function(){return i}});var a,l,n=s(66641),r=s(52738);let i={id:"",name:"",body:"",is_enabled:!0,trigger_description:"",is_default_note:!1,is_default_shared:!1,org_id:"",created_at:new Date().toISOString(),created_by:{id:"",full_name:"",image_url:""},can_write:!0};(a=l||(l={})).Idle="idle",a.Loading="loading",a.Success="success";let o=(0,n.Ue)((e,t)=>({noteDraft:i,updateNoteDraft:t=>e(e=>({noteDraft:{...e.noteDraft,...t}})),resetNoteDraft:()=>e(()=>({noteDraft:i})),notesListState:"idle",setNotesListState:t=>e({notesListState:t}),notesList:[],setNotesList:t=>e({notesList:t}),createNote:t=>e(e=>({notesList:[...e.notesList,t]})),getNoteById:e=>t().notesList.find(t=>t.id===e),updateNoteById:(t,s)=>e(e=>({notesList:e.notesList.map(e=>e.id===t?s:e)})),deleteNoteById:t=>e(e=>({notesList:e.notesList.filter(e=>e.id!==t)}))})),d=(e,t)=>{(0,r.Lp)(t).then(s=>{e(e=>({knowledgeSuggestions:{...e.knowledgeSuggestions,[t]:{result:{...s}}}}))})},c=(0,n.Ue)((e,t)=>({knowledgeSuggestions:{},getKnowledgeSuggestion:s=>{let a=t().knowledgeSuggestions[s];return a?a.result:(a||(e(e=>({knowledgeSuggestions:{...e.knowledgeSuggestions,[s]:e.knowledgeSuggestions[s]||{result:null}}})),d(e,s)),null)},editKnowledgeSuggestion:async(s,a)=>{let l=t().knowledgeSuggestions[s];if(!l||!l.result)return;let n=l.result;await (0,r.mq)(s,a).then(t=>{let a={result:{...n,merge_conflict:t.merge_conflict}};e(e=>({knowledgeSuggestions:{...e.knowledgeSuggestions,[s]:a}}))})},finalizeKnowledgeSuggestion:async(s,a,l)=>{let n=t().knowledgeSuggestions[s];if(!n||!n.result)return;let i=n.result,o=(e,t)=>{var s;return"accepted"===e.status&&(null===(s=t.target)||void 0===s?void 0:s.knowledge_id)===e.knowledge_id};return(0,r.PQ)(s,a,l).then(a=>{let l={result:{...i,status:a.status}};for(let[n,r]of("accepted"===a.status&&"new"===l.result.target.type&&(l.result.target.knowledge_id=a.knowledge_id),e(e=>({knowledgeSuggestions:Object.fromEntries(Object.entries(e.knowledgeSuggestions).map(e=>{let[t,n]=e;return[t,t===s?l:n&&n.result&&o(a,n.result)?{result:{...n.result,merge_conflict:void 0}}:n]}))})),Object.entries(t().knowledgeSuggestions)))n!==s&&r&&r.result&&o(a,r.result)&&d(e,n)})}}))},91161:function(e,t,s){"use strict";s.d(t,{h:function(){return b}});var a=s(27573),l=s(81225),n=s(18914),r=s(18544),i=s(99994),o=s(26821),d=s(57908),c=s(87659),u=s(7653),m=s(91854),x=s(75113),h=s(4652),p=s(32992),f=s(94873),g=s(15534);function b(e){let{snapshot:t,appearance:s}=e,[l,n]=(0,u.useState)(!1),[r,i]=(0,u.useState)(!1),{orgId:m}=(0,h.aC)(),[x,b]=(0,u.useState)(t.snapshot_name),[j,k]=(0,u.useState)(t.description),[y,N]=(0,u.useState)(t.startup_commands||[]),C=(0,o.NL)(),_=(0,u.useCallback)(async()=>{i(!0);let e=y.filter(e=>""!==e.trim());N(e),await (0,p.RH)(t.snapshot_id,x,j,e),await C.invalidateQueries({queryKey:["snapshots",m]}),n(!1),i(!1)},[y,t.snapshot_id,x,j,C,m]),S=(0,u.useCallback)(async()=>{i(!0),await (0,p.B4)(t.snapshot_id),await C.invalidateQueries({queryKey:["snapshots",m]}),i(!1)},[m,C,t.snapshot_id]),E="baseline"===t.snapshot_id;return(0,a.jsxs)("div",{className:(0,d.Z)("flex-1 rounded-md","upsert"===s&&"absolute left-0 top-0 h-full w-full p-6","list"===s&&(E?"":"hover:bg-slate-100 dark:hover:bg-[#424242]"),"border-r bg-slate-50 p-3 transition lg:border-r-0 dark:border-[#484848] dark:bg-[#393939]"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:["list"!==s||l?(0,a.jsx)("input",{value:x,onChange:e=>b(e.target.value),className:(0,f.cn)("dark:focus:bg-input-dark grow overflow-x-auto rounded-md border border-dashed border-transparent bg-transparent py-1 pl-2 transition focus:outline-none",l&&" dark:bg-shade/50 hover:border-input-dark border-slate-300 bg-white dark:border-[#484848] dark:hover:border-gray-400"),disabled:!l}):(0,a.jsx)(c.default,{href:"/snapshots/".concat((0,g.I)(t.snapshot_id)),className:(0,f.cn)(E?"cursor-default":"cursor-pointer","line-clamp-1 grow overflow-x-auto break-words rounded-md border border-dashed border-transparent bg-transparent py-1 pl-2 transition"),children:x}),(0,a.jsx)("div",{children:(0,a.jsx)(w,{isEditing:l,disabled:"baseline"===t.snapshot_id||0===t.snapshot_name.length||r,isBase:"baseline"===t.snapshot_id,onEdit:()=>n(!0),onSave:_,onDelete:S})})]}),(0,a.jsxs)("div",{className:(0,d.Z)("flex flex-col","upsert"===s&&"mt-6","list"===s&&"mt-3"),children:[(0,a.jsx)("div",{className:(0,d.Z)("dark:shadow-extra-night dark:ring-extra-night min-h-24 rounded-md border border-slate-300 px-3.5 py-3 shadow-sm duration-150 dark:border-[#484848]",l?"hover:border-input-dark dark:bg-shade/50 border-dashed bg-white opacity-100 hover:dark:border-gray-400":"dark:bg-night border-solid bg-slate-100 opacity-70","upsert"===s&&"mb-3"),children:(0,a.jsx)("div",{className:"w-full ease-in-out",children:(0,a.jsx)("textarea",{className:"w-full resize-none bg-transparent text-xs outline-none ring-0",value:j,onChange:e=>k(e.target.value),rows:"upsert"===s?20:5,placeholder:"Write a snapshot description to help Devin understand its machine state.",disabled:!l})})}),(0,a.jsx)(v,{isInModal:!1,isEditing:l,snapshotStartupCommands:y,setSnapshotStartupCommands:N}),"baseline"!==t.snapshot_id&&(0,a.jsx)("div",{className:"flex w-full justify-end",children:(0,a.jsx)(c.default,{href:t.devin_id?"/sessions/".concat(t.devin_id.substr(6)):"#",className:"mx-1 mt-2.5 cursor-pointer whitespace-nowrap text-xs underline opacity-50 duration-150 hover:opacity-80",children:"View original session"})})]})]})}function v(e){let{isInModal:t,isEditing:s,snapshotStartupCommands:r,setSnapshotStartupCommands:i}=e;(0,u.useEffect)(()=>{s&&0===r.length&&i([""])},[s,i,r]);let o=(0,u.useMemo)(()=>!r||!r.length||""===r[(null==r?void 0:r.length)-1],[r]),c=(e,t)=>{let s=[...r];s[t]=e,i(s)},m=e=>{if(1===r.length){i([""]);return}let t=[...r];t.splice(e,1),i(t)};return(0,a.jsxs)("div",{className:(0,d.Z)(s?"border-dashed border-slate-300":"border-solid",t?"border-none":"border","dark:border-input-dark mt-3 flex flex-col rounded-[6px] border dark:shadow-sm"),children:[(0,a.jsxs)("div",{className:(0,d.Z)(t?"border-none text-slate-700 dark:text-white":"dark:bg-shade dark:border-input-dark rounded-t-md border-b border-gray-300 bg-blue-50 opacity-80 shadow-sm dark:text-gray-200 dark:shadow-md","flex items-center px-2 py-1 text-sm font-medium text-black"),children:[(0,a.jsx)(x.u,{content:(0,a.jsxs)("ul",{className:"text-xs",children:[(0,a.jsx)("li",{children:"1. Startup commands run in the home directory"}),(0,a.jsx)("li",{children:"2. They execute in the order listed"}),(0,a.jsx)("li",{children:"3. Each command has a 2 minute timeout"})]}),side:"bottom",className:"px-2 py-1",delayDuration:100,children:(0,a.jsx)(l.k,{size:13,className:"mr-1"})}),"Startup commands"," ",t?(0,a.jsxs)("span",{className:"ml-1 text-xs font-normal",children:["(automatically run on snapshot startup from the"," ",(0,a.jsx)("b",{children:"home directory"}),")"]}):null]}),(0,a.jsxs)("div",{className:(0,d.Z)(t?"rounded-md border dark:border-none dark:bg-[#121212]":"dark:bg-night rounded-b-md bg-slate-100","flex flex-col text-black dark:text-white"),children:[r.length?r.map((e,t)=>(0,a.jsx)(j,{command:e,editStartupCommand:c,index:t,isEditing:s,removeCommand:m},t)):(0,a.jsx)("div",{className:"flex w-full justify-center py-1.5 text-[10.5px] opacity-50",children:"No startup commands"}),(0,a.jsxs)("div",{onClick:s?()=>{(null==r?void 0:r.length)?o||i([...r,""]):i([""])}:()=>{},className:(0,d.Z)(s?"z-[1] h-7 opacity-80":"-z-10 h-0 opacity-0",o?"cursor-initial text-gray-400":"dark:hover:bg-extra-night cursor-pointer hover:bg-gray-200","dark:border-input-dark flex items-center justify-center rounded-b-md border-t border-dotted border-gray-400 px-2 text-[10.5px] duration-150"),children:[(0,a.jsx)("span",{className:"mr-1",children:"Add"}),(0,a.jsx)(n.F,{size:18})]})]})]})}let j=e=>{let{command:t,editStartupCommand:s,index:l,isEditing:n,removeCommand:i}=e,o=(0,u.useRef)(null),c=()=>{if(o.current){o.current.style.height="auto";let e=Math.min(o.current.scrollHeight,60);o.current.style.height="".concat(e,"px")}};return(0,u.useEffect)(()=>{c()},[t]),(0,a.jsxs)("div",{className:(0,d.Z)(n?"opacity-100":"opacity-40","dark:border-input-dark group relative flex w-full items-center border-t border-dotted border-gray-400 first:border-0"),children:[(0,a.jsx)("textarea",{ref:o,className:"w-full resize-none overflow-hidden overflow-y-scroll bg-transparent bg-white px-2 py-1.5 font-mono text-[10.5px] last:rounded-b-md focus:outline-slate-400 dark:bg-transparent",onChange:e=>{s(e.target.value,l),c()},value:t,rows:1,disabled:!n,spellCheck:"false",autoCorrect:"off",autoCapitalize:"off",placeholder:"Enter command",style:{minHeight:"1.5rem",maxHeight:"10rem"}}),(0,a.jsx)(r.S,{onClick:()=>i(l),className:(0,d.Z)(n?"cursor-pointer hover:text-red-500 hover:opacity-80 group-hover:opacity-60":"cursor-initial","absolute right-1.5 top-1/2 -translate-y-1/2 opacity-0 duration-150")})]})},w=e=>{let{isEditing:t,disabled:s,isBase:l,onEdit:n,onSave:r,onDelete:o}=e,[c,x]=(0,u.useState)(!1);return(0,a.jsxs)("div",{className:"relative flex w-full items-center",children:[(0,a.jsx)("div",{onClick:()=>{s||(t?r():n())},className:(0,d.Z)(s?"cursor-not-allowed opacity-40":"dark:hover:bg-night hover:text-night cursor-pointer hover:border-gray-600 hover:bg-gray-50 dark:hover:border-gray-500","dark:border-input-dark ml-auto flex h-[26px] items-center rounded-md border border-gray-400 px-3 text-[13px] text-gray-600 duration-150 dark:text-gray-300 dark:shadow-sm"),children:(0,a.jsx)("span",{children:t?"Save":"Edit"})}),(0,a.jsx)(m.T,{open:c,onCancel:()=>x(!1),onConfirm:()=>{x(!1),o()},title:"Delete Snapshot",description:"Are you sure you want to delete this snapshot?"}),(0,a.jsx)("div",{onClick:()=>{s||x(!l)},className:(0,d.Z)("text-night dark:border-input-dark ml-2 flex h-[26px] items-center rounded-md border border-gray-400 px-2 text-[13px] duration-150 dark:text-gray-300 dark:shadow-sm",l||s?"cursor-not-allowed opacity-40":"dark:hover:bg-night cursor-pointer opacity-80 hover:border-red-500 hover:text-red-500 hover:opacity-100 dark:hover:border-red-500 dark:hover:text-red-500"),children:(0,a.jsx)(i.r,{})})]})}},98699:function(e,t,s){"use strict";s.d(t,{SnapshotUpsert:function(){return i}});var a=s(27573);s(7653);var l=s(19771),n=s(70987),r=s(91161);let i=e=>{var t;let{id:s}=e,i=(0,n.qN)(),o=null===(t=i.data)||void 0===t?void 0:t.find(e=>e.snapshot_id===s);return i.isLoading?(0,a.jsx)("div",{className:"relative flex h-full w-full flex-1",children:(0,a.jsx)("div",{className:"absolute left-0 top-0 h-full w-full",children:(0,a.jsx)(l.T,{size:"sm"})})}):i.data&&o?(0,a.jsx)("div",{className:"relative flex h-full w-full flex-1",children:(0,a.jsx)("div",{className:"absolute left-0 top-0 h-full w-full",children:(0,a.jsx)(r.h,{snapshot:o,appearance:"upsert"})})}):null}},53396:function(e,t,s){"use strict";s.d(t,{SnapshotsList:function(){return m}});var a=s(27573),l=s(76788),n=s(57908),r=s(23130),i=s(7653),o=s(19771),d=s(70987),c=s(12122),u=s(91161);function m(){return(0,a.jsx)(x,{})}function x(){let e=(0,d.qN)(),[t,s]=(0,i.useState)("");return e.isLoading?(0,a.jsx)(o.T,{size:"sm"}):e.data?(0,a.jsxs)("div",{className:"flex w-full grow flex-col overflow-hidden",children:[(0,a.jsx)("div",{className:(0,n.Z)("flex flex-col items-center justify-between pb-6 lg:flex-row-reverse","border-b border-[#f2f2f2] dark:border-[#484848]"),children:(0,a.jsx)("div",{className:"flex w-full justify-end",children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("label",{className:"relative mr-4 flex w-[200px] items-center text-[#8F8F8F]",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search for snapshots",className:"peer h-full w-full rounded-lg border border-[#f2f2f2] py-2 pl-9 pr-3 text-xs font-medium focus:!border-[#5e5e5e] focus:outline-none dark:border-[#8F8F8F] dark:bg-[#2e2e2e] dark:focus:!border-[#ffffff]",value:t,onChange:e=>s(e.target.value)}),(0,a.jsx)(l.Y,{size:14,className:"absolute left-[11px] top-1/2 -translate-y-1/2 peer-focus:text-[#5e5e5e] dark:peer-focus:!text-white"})]})})})}),(0,a.jsx)(h,{snapshots:e.data,searchTerm:t})]}):null}function h(e){let{snapshots:t,searchTerm:s}=e,l=(0,i.useMemo)(()=>[c._,...t],[t]),n=(0,i.useMemo)(()=>new r.Z(l,{findAllMatches:!0,keys:["snapshot_name","description","snapshot_id"],minMatchCharLength:1,threshold:.2}),[l]),o=(0,i.useMemo)(()=>s?n.search(s).map(e=>e.item):l,[n,l,s]);return(0,a.jsx)("div",{className:"relative grid h-full w-full grow grid-cols-1 content-start gap-4 overflow-y-auto pt-10 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:o.map(e=>(0,a.jsx)(u.h,{snapshot:e,appearance:"list"},e.ami_id))})}},15534:function(e,t,s){"use strict";s.d(t,{I:function(){return a}});let a=e=>e.substring(9)},38242:function(e,t,s){"use strict";s.d(t,{$k:function(){return m},ON:function(){return c},R_:function(){return d},So:function(){return u},_T:function(){return i},g4:function(){return l},kJ:function(){return o},kj:function(){return n},pP:function(){return x},sf:function(){return r}});var a=s(5565);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};let l=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/state/handlebars.ts/sidebarHandlebarAtom",(0,a.cn)(!0)),n=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/state/handlebars.ts/workspaceHandlebarAtom",(0,a.cn)(!1)),r=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/state/handlebars.ts/isWorkspaceExpandedAtom",(0,a.cn)(!1)),i=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/state/handlebars.ts/demoModeAtom",(0,a.cn)(!1)),o=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/state/handlebars.ts/createSnapshotModalOpenAtom",(0,a.cn)(!1)),d=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/state/handlebars.ts/openDevinsMachineConfirmationAtom",(0,a.cn)(!1)),c=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/state/handlebars.ts/restoreCheckpointModalOpenAtom",(0,a.cn)(!1)),u=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/state/handlebars.ts/restoreCheckpointModalTimestampAtom",(0,a.cn)(null)),m=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/state/handlebars.ts/reviveDevinModalOpenAtom",(0,a.cn)(!1)),x=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/state/handlebars.ts/reviveDevinModalTimestampAtom",(0,a.cn)(null))},75419:function(e,t,s){"use strict";s.d(t,{K:function(){return n},n:function(){return l}});var a=s(54154);let l=(e,t)=>{let s="".concat(e,"-"),l=window.location.origin;(function(e){if(navigator.clipboard)navigator.clipboard.writeText(e).catch(e=>{console.error("Could not copy text: ",e)});else{let t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){console.error("Could not copy text: ",e)}document.body.removeChild(t)}})("".concat(l,"/?").concat(e,"=").concat(t.substr(s.length))),a.A.success("Copied ".concat(e," URL!"))},n=e=>{l("snapshot",e)}},69973:function(){},75602:function(){},45793:function(){},53645:function(){},41967:function(){},52353:function(){},24606:function(){},78844:function(){},83599:function(){},40512:function(){},79037:function(){},15315:function(){},67462:function(){}}]);