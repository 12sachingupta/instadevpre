!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="5d2fb4c9-e00c-48f0-af28-afdc5d623586",e._sentryDebugIdIdentifier="sentry-dbid-5d2fb4c9-e00c-48f0-af28-afdc5d623586")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9025],{75147:function(e,t,n){"use strict";n.d(t,{L:function(){return i}});var l=n(7653);let i=e=>{let[t,n]=(0,l.useState)({}),[{editor:i,monaco:s},d]=(0,l.useState)({editor:null,monaco:null});return(0,l.useEffect)(()=>{if(!e||!e.length){t&&t.clear&&t.clear();return}if(i&&s&&e){let t=e.map(e=>({range:new s.Range(e.start,1,e.end,1),options:{linesDecorationsClassName:r(e),isWholeLine:!0,overviewRuler:a(e.type)}}));n(i.createDecorationsCollection(t))}},[i,s,e]),{handleEditorDidMount:(e,t)=>{d({editor:e,monaco:t})}}},r=e=>"added"===e.type?"added-lines":"removed"===e.type?"removed-lines":"modified-lines",a=e=>"removed"===e?{color:"#FF0000",position:4}:"added"===e?{color:"#529e4e",position:1}:{color:"#3376cd",position:1}},84323:function(e,t,n){"use strict";n.d(t,{j:function(){return o}});var l=n(18255),i=n.n(l),r=n(7653),a=n(5398),s=n(13784),d=n(40919);let o=(e,t,n)=>{let{timelineState:l}=(0,d.j1)(),{loadManager:a}=(0,r.useContext)(s.Z),[o,u]=(0,r.useState)(),[h,f]=(0,r.useState)(),x=(0,r.useMemo)(()=>{let r=i().uniqWith(l.relevantEvents.filter(t=>"editor_update"===t.type&&t.file===e&&new Date(t.timestamp).getTime()<=l.currentTimestamp),(e,t)=>e.contents_key===t.contents_key);if(t){let e=r.findIndex(e=>e.contents_key===t.contents_key);if(-1!==e)return f(r[e]),u(r[Math.max(e-1,0)]),r}let s=r[r.length-1],d=r[Math.max(r.length-2,0)];return s&&(a&&(null==a||a.requestHighPriorityDownload(t=>"editor_update"===t.type&&t.file===e)),f(s),u(d),n&&n(s)),r},[l.relevantEvents,l.currentTimestamp,t,e,a,n]),g=(0,r.useMemo)(()=>c(x),[x]),v=(0,r.useMemo)(()=>{var e,t,n;if(x.length<2)return[];let l=x[0],i=x[x.length-1];return((null===(e=l.contents)||void 0===e?void 0:e.length)||0)+((null===(t=i.contents)||void 0===t?void 0:t.length)||0)>2e6?[]:!l.contents&&i.contents?[{type:"added",start:0,end:(null===(n=i.contents)||void 0===n?void 0:n.split("\n").length)||0}]:m(l.contents,i.contents,{maxComputationTimeMs:100}).map(e=>e.originalRange.startLineNumber<e.originalRange.endLineNumberExclusive&&e.modifiedRange.startLineNumber===e.modifiedRange.endLineNumberExclusive?{type:"removed",start:e.modifiedRange.startLineNumber,end:e.modifiedRange.startLineNumber}:e.modifiedRange.startLineNumber<e.modifiedRange.endLineNumberExclusive&&e.originalRange.startLineNumber===e.originalRange.endLineNumberExclusive?{type:"added",start:e.modifiedRange.startLineNumber,end:e.modifiedRange.endLineNumberExclusive-1}:{type:"modified",start:e.modifiedRange.startLineNumber,end:e.modifiedRange.endLineNumberExclusive-1}).filter(e=>e)},[x]);return[null==o?void 0:o.contents,null==h?void 0:h.contents,!!((null==h?void 0:h.loading)||(null==o?void 0:o.loading)),g,v,h,f,o,u]},c=e=>{if(!e||!e.length)return[];if(1===e.length)return[{...e[0],diff:{addedLines:0,removedLines:0}}];let t=[];for(let n=0;n<e.length-1;n++){let l=e[n],i=e[n+1];if(!i)break;t[n]||(t[n]={...l,diff:{addedLines:0,removedLines:0}}),t[n+1]={...i,diff:u(l.contents,i.contents)}}return t},u=(e,t)=>{if(((null==e?void 0:e.length)||0)+((null==t?void 0:t.length)||0)>2e6)return{addedLines:0,removedLines:0,disabled:!0};let n=x(e,t);if(n)return n;let l=m(e,t).reduce((e,t)=>({addedLines:e.addedLines+t.modifiedRange.endLineNumberExclusive-t.modifiedRange.startLineNumber,removedLines:e.removedLines+t.originalRange.endLineNumberExclusive-t.originalRange.startLineNumber}),{addedLines:0,removedLines:0});return g({...l,disabled:!1},e,t),{...l,disabled:!1}},m=(e,t,n)=>{let l=(e||"").split("\n"),i=(t||"").split("\n"),r=new a.AdvancedLinesDiffComputer,s={ignoreTrimWhitespace:!1,computeMoves:!0,maxComputationTimeMs:100,...n||{}},{changes:d}=r.computeDiff(l,i,s);return d},h=e=>{let t=0;for(let n=0,l=e.length;n<l;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t},f={},x=(e,t)=>f[h("".concat(e,"||").concat(t))],g=(e,t,n)=>{f[h("".concat(t,"||").concat(n))]=e}},34750:function(e,t,n){"use strict";n.d(t,{x:function(){return r}});var l=n(7653),i=n(40919);function r(e){let t=(0,l.useRef)(e),{devinState:n}=(0,i.j1)(),r=n&&"finished"===n.status.enum;return(0,l.useEffect)(()=>{t.current=e},[e]),(0,l.useCallback)(e=>{if(r)return;let n=null,l=null,i=e.getValue();e.onDidChangeCursorSelection(r=>{l&&(null==n?void 0:n.getAttribute("data-comment"))!=="true"&&(e.removeContentWidget(l),l=null);let a=e.getModel();if(a&&(r.selection.startColumn!==r.selection.endColumn||r.selection.startLineNumber!==r.selection.endLineNumber)){let s=a.getValueInRange({startLineNumber:r.selection.startLineNumber,endLineNumber:r.selection.endLineNumber,startColumn:0,endColumn:1/0});l={getId:()=>"chat-with-devin-widget",getDomNode:()=>n=t.current.getDomNode({range:{startLine:r.selection.startLineNumber,endLine:r.selection.endLineNumber},snippet:s,file:t.current.filename,language:a.getLanguageId()}),getPosition(){let e=Math.max(...i.split("\n").map(e=>e.length));return{position:{lineNumber:r.selection.endLineNumber,column:Math.min(Math.max(e-30,5),r.selection.startColumn,r.selection.endColumn)},preference:[2]}}},e.addContentWidget(l)}})},[r])}},29025:function(e,t,n){"use strict";n.d(t,{sX:function(){return es},mH:function(){return Z},a_:function(){return ed},zH:function(){return R},EG:function(){return Q},iT:function(){return ea.i}});var l=n(27573),i=n(90276),r=n(99320),a=n(4382),s=n(83447),d=n(5565),o=n(81086),c=n(18255),u=n.n(c),m=n(18250),h=n(7653),f=n(13784),x=n(40919);let g=()=>{let{timelineState:{allEvents:e,currentTimestamp:t}}=(0,x.j1)(),n=(0,h.useMemo)(()=>{let n=u().uniqWith(e.filter(e=>"editor_update"===e.type&&new Date(e.timestamp).getTime()<=t),(e,t)=>e.contents_key===t.contents_key),l={};n.forEach(e=>{l[e.file]||(l[e.file]=[]),l[e.file].push(e)});let i=[];return Object.entries(l).forEach(e=>{let t,n,[l,r]=e;r.length>1?(t=r[0],n=r[r.length-1]):n=r[0],i.push({file:l,firstEvent:t,lastEvent:n})}),i},[e]),{loadManager:l}=(0,h.useContext)(f.Z),[i,r]=(0,h.useState)(!0),[a,s]=(0,h.useState)([]),d=new Set(n.flatMap(e=>{var t,n;return[null===(t=e.firstEvent)||void 0===t?void 0:t.event_id,null===(n=e.lastEvent)||void 0===n?void 0:n.event_id]}).filter(e=>e));return null==l||l.requestHighPriorityDownload(e=>d.has(e.event_id)),(0,h.useEffect)(()=>{i&&(n.some(e=>{var t,n;return(null===(t=e.firstEvent)||void 0===t?void 0:t.loading)||(null===(n=e.lastEvent)||void 0===n?void 0:n.loading)})||(s(n.filter(e=>{var t;return e.firstEvent&&e.lastEvent?e.firstEvent.contents!==e.lastEvent.contents:null===(t=e.lastEvent)||void 0===t||!t.contents})),r(!1)))},[n,i]),{loading:i,value:a}};var v=n(84323),b=n(80070),p=n(54550),w=n(61802),j=n(97946),k=n(21138),N=n(52635),y=n(94873);n(89786);var E=n(9565),L=n(95014),C=n(92494),S=n(57908);let _=[],R=e=>{let{files:t,onFileClick:n,selectedFile:i,condense:r=!1,openTree:a=!1,removeRedundantLevels:s=!1}=e,d=(0,h.useMemo)(()=>T(t,i,r,s),[t,i,r,s]);return(0,l.jsx)("div",{className:"h-full min-h-full min-w-full overflow-x-auto text-sm",children:d.map(e=>z(e,0,n,a))})},z=(e,t,n,i)=>{let r=e.selected;return"folder"===e.type?(0,l.jsx)(M,{folder:e,level:t,onFileClick:n,selected:r||_.includes("".concat(t,"-").concat(e.name)),openTree:i},"".concat(t,"-").concat(e.name,"-").concat(r)):(0,l.jsx)(D,{file:e,selected:r,level:t,onFileClick:n},"".concat(t,"-").concat(e.name))},M=e=>{let{folder:t,onFileClick:n,level:i,selected:r,openTree:a}=e,[s,d]=(0,h.useState)(r||a),o="".concat(i,"-").concat(t.name);return r&&_.push(o),(0,l.jsxs)("div",{className:"flex w-fit min-w-full flex-col",children:[(0,l.jsx)("div",{className:"flex w-fit min-w-full cursor-pointer items-center text-nowrap py-1 leading-6 hover:bg-blue-400 hover:text-white dark:hover:bg-[rgba(30,58,138)]",onClick:()=>{s?_.splice(_.indexOf(o),1):_.push(o),d(!s)},style:{paddingLeft:"".concat(16*i+8,"px")},children:(0,l.jsxs)("button",{className:"mr-2 flex flex-row align-middle",children:[s?(0,l.jsx)(E.p,{className:"mr-2 h-6"}):(0,l.jsx)(L.T,{className:"mr-2 h-6"}),(0,l.jsx)("span",{className:"  overflow-hidden text-nowrap",children:t.name})]})}),s&&(0,l.jsx)("div",{className:"inline-block min-w-full",children:t.children.map(e=>z(e,i+1,n,a))})]})},D=e=>{let{file:t,onFileClick:n,selected:i,level:r}=e;return(0,l.jsx)("div",{className:(0,y.cn)("w-fit min-w-full cursor-pointer text-nowrap border-y border-transparent py-1 pl-4 pr-2 leading-6  hover:text-white active:bg-blue-500 dark:active:bg-[rgb(23,49,82)]",i?"border-sky  bg-blue-500 text-white dark:bg-[rgb(23,49,82)]":"hover:bg-blue-400 dark:hover:bg-[rgba(30,58,138)]",t.modified&&!i&&"text-amber-700 hover:text-amber-300 dark:text-[rgb(215,186,134)]"),style:{paddingLeft:"".concat(16*r+8,"px")},onClick:()=>{n(t.file)},children:(0,l.jsxs)("button",{className:(0,S.Z)("flex align-middle"),children:[(0,l.jsx)(C.$,{className:"mr-2 h-6"}),(0,l.jsxs)("span",{children:[" ",t.name]})]})})},A=e=>{if(1===e.children.length){let t=A(e.children[0]);return{type:t.type,name:e.name+"/"+t.name,children:t.children,file:t.file,selected:e.selected||t.selected,modified:e.modified||t.modified}}return e.children=e.children.map(A),e},T=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={type:"folder",name:"",children:[],file:"",selected:!1,modified:!1},r=(0,ea.i)(e.map(e=>e.path)),a=e.length>1?1:2,s=r.split("/").length-a;return(e.forEach(e=>{let n=e.path;l&&(n=n.split("/").slice(s).join("/")),n=n.startsWith("/")?n.slice(1,n.length+1):n;let r=e.path,a=t===r,d=n.split("/"),o=i;d.forEach((t,n)=>{let l=n===d.length-1,i=o.children.find(e=>e.name===t);if(i)o=i,i.selected||(i.selected=a);else{let n={type:l?"file":"folder",name:t,modified:l&&e.modified,children:[],file:r,selected:a};o.children.push(n),o=n}})}),n)?i.children.map(A):i.children};var F=n(75147);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};let I=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/components/Editor/ExpandedEditor.tsx/selectedEventAtom",(0,d.cn)(void 0));function Z(e){let{open:t,onClose:n,allTabs:d,activeFilename:c,setActiveFilename:f,setIsShowingDiff:x,isShowingDiff:y,onDownload:E,areFilesLoading:L}=e,C=d.find(e=>e.filename===c);C||(C=d[0]);let[S,_]=(0,o.KO)(I),[z,M,D,A,T,Z,H,,V]=(0,v.j)(c,S,_),{handleEditorDidMount:q}=(0,F.L)(T),{value:K}=g(),{resolvedTheme:P}=(0,m.F)(),U=(e,t)=>e===t||e.contents_key===(null==t?void 0:t.contents_key),G=(0,h.useMemo)(()=>{let e=K||[];return d.map(t=>({path:t.filename,modified:W(t.filename,e)}))},[d,K]);(0,h.useEffect)(()=>{delete window.editor_line_number},[c]);let B=e=>{if(window.editor_line_number&&!window.editor_loaded){let t={endColumn:0,endLineNumber:window.editor_line_number+5,startColumn:0,startLineNumber:window.editor_line_number+5};e.revealRangeAtTop(t,1),delete window.editor_line_number,window.editor_loaded=!0}e.onDidScrollChange(()=>{window.editor_line_number=e.getVisibleRanges()[0].startLineNumber}),e.onDidChangeModel(()=>{window.editor_loaded=!1})};return(0,l.jsx)(k.Vq,{open:t,onOpenChange:n,children:(0,l.jsxs)(k.cZ,{className:"h-[calc(100vh - 10rem)] flex h-full w-full max-w-7xl flex-col items-start justify-start",children:[(0,l.jsx)(k.fK,{children:(0,l.jsx)(k.$N,{className:"text-black dark:text-white",children:"Expanded Editor"})}),(0,l.jsx)("div",{className:"w-full rounded-xl border border-neutral-200 bg-slate-100   dark:border-neutral-600 dark:bg-zinc-900",children:(0,l.jsxs)("div",{className:"flex h-full",children:[(0,l.jsx)("div",{className:"no-scrollbar flex h-[88vh] w-64 min-w-64 flex-col overflow-scroll rounded-l-xl bg-slate-100 pt-1 dark:bg-zinc-900",children:(0,l.jsxs)("div",{className:"flex h-full w-full flex-col overflow-hidden dark:text-white",children:[(0,l.jsx)("span",{className:"mb-2 ml-3 mt-2 overflow-hidden text-xs font-bold uppercase text-black dark:text-white",children:"EXPLORER"}),(0,l.jsx)("div",{className:"flex h-full w-full overflow-auto ",children:(0,l.jsx)(R,{files:G,onFileClick:e=>f(e),selectedFile:c,removeRedundantLevels:!0},G.map(e=>e.path).join("-"))})]})}),(0,l.jsxs)("div",{className:"flex w-full flex-col overflow-hidden ",children:[(0,l.jsxs)("div",{className:"relative flex overflow-hidden",children:[(0,l.jsx)("div",{className:"no-scrollbar dark:bg-extra-night mr-[102px] flex w-full items-center overflow-x-auto bg-white",children:(0,l.jsx)(j.x,{allTabs:d.map(e=>({id:e.filename,firstActive:e.firstActive,lastActive:e.lastActive})),formatter:e=>u().last(e.split("/")),active:c,setActive:f})}),(0,l.jsx)("div",{className:"[&>div]:rounded-tr-xl ",children:(0,l.jsxs)(es,{className:"bg-white dark:bg-zinc-900",children:[(0,l.jsx)(b.K,{onClick:()=>n(),title:"Close editor",children:(0,l.jsx)(r.G,{size:18})}),(0,l.jsx)(b.K,{onClick:()=>{N.Z.trackInteraction(N.j.EDITOR_TOGGLE_DIFF),x(!y)},isActive:y,title:"View comparison with previous state",children:(0,l.jsx)(a.k,{size:18})}),(0,l.jsx)(b.K,{onClick:()=>{N.Z.trackInteraction(N.j.EDITOR_DOWNLOAD_FILES),E()},title:L?"Files are loading":"Download",disabled:L,children:(0,l.jsx)(s.U,{size:18})})]})})]}),(0,l.jsx)(ed,{activeFilename:c}),y&&(0,l.jsx)(p.h,{loading:D,className:"dark:bg-night h-[80vh] w-full",children:(0,l.jsxs)("div",{className:"flex h-[80vh] w-full flex-row",children:[(0,l.jsx)(i.SV,{options:{readOnly:!0,ignoreTrimWhitespace:!1,renderSideBySide:!0},theme:"dark"===P?"vs-dark":"vs-light",loading:(0,l.jsx)("div",{className:"dark:bg-night flex h-[80vh] w-full items-center justify-center align-middle",children:(0,l.jsx)(w.g,{})}),original:z,modified:M,className:"h-[80vh] w-full font-mono",onMount:e=>B(e.getModifiedEditor())},"".concat(M,"-").concat(P)),(0,l.jsx)("div",{className:"no-scrollbar flex h-[80vh] w-32 flex-col space-y-1 overflow-scroll bg-white pt-1 dark:bg-zinc-900",children:A.length>1&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"ml-2 text-xs font-bold uppercase text-black dark:text-white",children:"File History"}),A.map((e,t)=>(0,l.jsx)(O,{event:e,onClick:()=>{H(e),V(A[Math.max(t-1,0)]),_(e)},isActive:U(e,Z)},"right-file-".concat(t)))]})})]})}),!y&&(0,l.jsx)(p.h,{loading:D,className:"dark:bg-night h-[80vh] w-full ",children:(0,l.jsx)(i.ZP,{options:{readOnly:!0,minimap:{renderCharacters:!1}},theme:"dark"===P?"vs-dark":"vs-light",path:c,loading:(0,l.jsx)("div",{className:"bg-shade-50 dark:bg-night flex h-[80vh] w-full items-center justify-center align-middle",children:(0,l.jsx)(w.g,{})}),defaultValue:M,className:"h-[80vh] w-full font-mono",onMount:(e,t)=>{q(e,t),B(e)}},"".concat(M,"-").concat(P))})]})]})})]})})}let O=e=>{let{event:t,onClick:n,isActive:i}=e,r=new Date(t.timestamp),a=r.toLocaleDateString("en-US"),s=r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});return(0,l.jsxs)("button",{onClick:n,className:(0,y.cn)("dark:hover:bg-dark-border h-14 max-h-20 w-full flex-shrink-0 overflow-hidden truncate  border border-transparent bg-white  text-xs hover:bg-slate-200 dark:bg-zinc-900 dark:text-white ",i&&"border-sky bg-blue-300 hover:bg-blue-300 dark:bg-[rgb(23,49,82)] dark:hover:bg-[rgb(23,49,82)]"),children:[(0,l.jsx)("span",{children:a}),(0,l.jsx)("br",{}),(0,l.jsx)("span",{children:s}),(0,l.jsx)("br",{}),t.diff.addedLines>0&&(0,l.jsxs)("span",{className:"text-green-700 dark:text-green-400",children:[" ","+",t.diff.addedLines]})," ",t.diff.removedLines>0&&(0,l.jsxs)("span",{className:"text-red-700 dark:text-red-400",children:[" ","-",t.diff.removedLines]})]})},W=(e,t)=>{let n=t.find(t=>t.file===e);return!!n&&!!n.firstEvent&&!!n.lastEvent&&n.firstEvent.contents!==n.lastEvent.contents};var H=n(81225),V=n(51430),q=n(21484),K=n(51744),P=n(91750),U=n(68927),G=n(15880);n(77488);var B=n(54154),$=n(75113),X=n(3830),J=n(34750);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};let Q=e=>{let{open:t,onClose:n,emitUserMessage:i}=e,[r,a]=(0,o.KO)(ee),s=(0,h.useRef)([]);(0,h.useEffect)(()=>{t||a(!1)},[t,a]),(0,h.useEffect)(()=>{!r&&s.current.length&&(i(s.current.map(e=>"".concat(e.comment,"\n```").concat(e.selection.language," filename=").concat(e.selection.file," lines=").concat(e.selection.range.startLine,"-").concat(e.selection.range.endLine,"\n").concat(e.selection.snippet,"\n```")).join("\n---\n")),s.current=[])},[i,r]);let d=(0,h.useCallback)(e=>{s.current.push(e)},[]);return(0,h.useEffect)(()=>{Object.keys(et).forEach(e=>delete et[Number(e)])}),(0,l.jsx)(k.Vq,{open:t,onOpenChange:n,children:(0,l.jsx)(k.PK,{children:(0,l.jsx)(Y,{ongoingReview:r,onStartReview:()=>a(!0),onEndReview:n,addComment:d,emitUserMessage:i})})})};function Y(e){let{ongoingReview:t,onStartReview:n,onEndReview:i,addComment:r,emitUserMessage:a}=e,{loading:s,value:d}=g(),[o,c]=(0,h.useState)([]),{devinState:{status:u}}=(0,x.j1)();return(0,h.useEffect)(()=>{s||(null==o?void 0:o.length)||!d||c(d||[])},[s]),(0,l.jsxs)(k.cZ,{noPadding:!0,className:"h-[calc(100vh - 10rem)] dark:bg-night flex h-full max-h-[98vh] w-full max-w-[95vw] flex-col items-start justify-start overflow-hidden border-transparent bg-white lg:max-w-[86vw]",children:[(0,l.jsx)(k.fK,{className:"w-full",children:(0,l.jsx)(k.$N,{className:"pt-3 text-black dark:text-white",children:(0,l.jsxs)("div",{className:"flex items-center justify-between px-6",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"text-2xl tracking-normal",children:"Global Work Diff"}),(0,l.jsx)("div",{className:"ml-5 hidden text-sm font-normal tracking-[-0.006rem] opacity-80 md:block",children:"Showing all files modified by Devin, with the temporary exception of some edits made via the shell"}),(0,l.jsx)($.u,{content:(0,l.jsx)("div",{className:"max-w-80 text-xs",children:"Some files, such as those created by Devin with the `echo` command, may not be displayed here."}),side:"right",className:"px-2 py-1",delayDuration:100,children:(0,l.jsx)("div",{className:"ml-2",children:(0,l.jsx)(H.k,{size:18,weight:"bold"})})})]}),"finished"!==u.enum&&(0,l.jsx)("div",{className:"mr-5",children:t?(0,l.jsx)("button",{className:"bg-pacific rounded-2xl px-3 py-1.5 text-sm font-normal text-white",onClick:i,children:"End review"}):(0,l.jsx)($.u,{content:(0,l.jsx)("div",{className:"max-w-52 text-xs",children:"Start a review to provide Devin feedback or ask for changes"}),side:"bottom",className:"px-2 py-1",delayDuration:100,children:(0,l.jsx)("button",{className:"bg-pacific rounded-2xl px-3 py-1.5 text-sm font-normal text-white",onClick:n,tabIndex:-1,children:"Start review"})})})]})})}),(0,l.jsx)(en,{files:d.sort((e,t)=>e.file.localeCompare(t.file)),addComment:r,loading:s,emitUserMessage:a})]})}let ee=globalThis.jotaiAtomCache.get("/vercel/path0/apps/webapp/src/components/Editor/GlobalWorkViewer.tsx/ongoingReviewAtom",(0,d.cn)(!1)),et={},en=e=>{let{files:t,loading:n,emitUserMessage:i,addComment:r}=e,[a,s]=(0,h.useState)(256),d=(0,h.useMemo)(()=>(t||[]).map(e=>null==e?void 0:e.file),[t]),[o,c]=(0,h.useState)(),u=(0,h.useRef)(null);return((0,h.useEffect)(()=>{o||c(d[0]),u.current&&(0,G.Z)(u.current,{behavior:"smooth",scrollMode:"always",block:"start"})},[o,d]),n)?(0,l.jsx)("div",{className:"flex h-[80vh] w-full items-center justify-center",children:(0,l.jsx)(el,{})}):t.length?(0,l.jsxs)("div",{className:"bg-dark-night flex w-full overflow-y-scroll pt-1.5",children:[!!d.length&&(0,l.jsx)(P.e,{size:{width:a,height:"100%"},onResizeStop:(e,t,n,l)=>{s(a+l.width)},minWidth:200,enable:{right:!0},className:"mr-2 border-r border-slate-300 pr-2 dark:border-zinc-500",children:(0,l.jsx)("div",{className:"hidden pl-4 md:block",children:(0,l.jsx)("div",{className:"flex h-auto w-full flex-col rounded-xl border bg-slate-100 pt-1 dark:border dark:border-[#484848] dark:bg-zinc-800",children:(0,l.jsx)("div",{className:"h-[89vh] w-full flex-col dark:text-white",children:(0,l.jsx)("div",{className:"flex h-full w-full overflow-auto",children:(0,l.jsx)(R,{files:d.map(e=>({path:e,modified:!1})),onFileClick:e=>{c(e)},selectedFile:o,condense:!0,openTree:!0},d.join("-"))})})})})}),(0,l.jsx)(ei,{files:t,addComment:r,emitUserMessage:i,selectedFileName:o,setSelectedFileName:c})]}):(0,l.jsx)("div",{className:"flex h-full w-full items-center justify-center text-sm text-black opacity-50 dark:text-white",children:"No changes to display"})},el=()=>(0,l.jsx)("div",{className:"flex h-full flex-auto flex-col items-center justify-center px-4 text-center align-middle",children:(0,l.jsx)("div",{className:"mb-6 text-[#6096FF]",children:(0,l.jsx)(V.U,{size:26,className:"animate-spin"})})}),ei=e=>{let{files:t,selectedFileName:n,setSelectedFileName:i,emitUserMessage:r,addComment:a}=e,s=(0,h.useRef)(null);(0,h.useEffect)(()=>{if(s.current&&n){let e=t.findIndex(e=>e.file===n);s.current.scrollToItem(e,"start")}},[n,t]);let d=(0,h.useCallback)(e=>{s.current&&s.current.resetAfterIndex(e)},[]),o=(0,h.useCallback)(e=>{let{index:n,style:s}=e;return(0,l.jsx)("div",{style:s,children:(0,l.jsx)(er,{file:t[n],setSelectedFileName:i,listIndex:n,fileCount:t.length,emitUserMessage:r,addComment:a,onSizeChange:d},t[n].file)},t[n].file)},[a,t,r,d,i]);return 0===t.length?(0,l.jsx)("div",{className:"flex h-full w-full items-center justify-center dark:text-white",children:"No changes to display"}):(0,l.jsx)("div",{className:"w-full overflow-y-hidden overflow-x-scroll",children:(0,l.jsx)(U.S_,{itemCount:t.length,itemSize:e=>{let t=et[e];return t?t.collapsed?60:t.expanded?.85*document.documentElement.clientHeight+65:.4*document.documentElement.clientHeight+65:.4*document.documentElement.clientHeight+65},height:2*document.documentElement.clientHeight*.45,width:"100%",ref:s,children:o})})},er=e=>{var t,n,a,s,d,c;let{file:u,listIndex:f,fileCount:x,setSelectedFileName:g,emitUserMessage:v,addComment:b,onSizeChange:p}=e,[w,j]=(0,o.KO)(ee),[k,N]=(0,h.useState)((null===(t=et[f])||void 0===t?void 0:t.collapsed)||!1),[y,C]=(0,h.useState)((null===(n=et[f])||void 0===n?void 0:n.expanded)||!1),{resolvedTheme:_}=(0,m.F)(),R=(0,h.useRef)(null),z=(0,o.b9)(X.g4),M=(0,h.useRef)(w),D=(0,h.useCallback)((e,t)=>{N(e),C(t),et[f]={collapsed:e,expanded:t},p(f)},[f,p]);(0,h.useEffect)(()=>{M.current=w},[w]);let A=(0,J.x)({filename:u.file,getDomNode(e){let t=document.createElement("div");t.innerHTML='\n      <button id="add-comment" class="!ml-0.5 mt-1.5 ring-2 text-sm shadow-sm shadow-gray-900 ring-sky rounded-sm bg-[hsl(216,34%,37%)] dark:bg-[hsl(216,34%,17%)] transition px-2.5 py-1 font-light text-white absolute z-10 w-max">\n        Add a comment\n      </button>\n      ';let n=t.querySelector("button");return n.addEventListener("click",()=>{var l;let i;t.innerHTML='\n        <div class="!ml-0.5 mt-1.5 z-10 relative pointer-events-auto w-[350px] ring-2 shadow-sm rounded-lg px-2 py-2 ring-sky bg-[hsl(216,34%,37%)] dark:bg-[hsl(216,34%,17%)] h-full">\n          <div class="mb-1.5 mt-0.5">\n            <textarea rows="1" class="block resize-none bg-[hsl(216,34%,37%)] dark:bg-[hsl(216,34%,17%)] font-light text-xs w-full text-white focus:!outline-transparent outline-none focus:outline-none placeholder-neutral-200 dark:placeholder-neutral-400" placeholder="Enter editing instructions..."></textarea>\n          </div>\n          <div class="w-full flex justify-end">\n            <div class="flex">\n              <button id="add-chat" class="rounded-l-md text-xs px-2 py-1 bg-white/20 text-white hover:bg-white/30 border-slate-400 dark:bg-black/20 dark:border-neutral-600 dark:hover:bg-black/30 border dark:disabled:text-neutral-400 '.concat(M.current?"rounded-r-md":"",'">Add to Chat</button>\n              ').concat(M.current?"":'<button id="start-review" class="text-xs px-2 py-1 border-l-transparent bg-white/20 text-white hover:bg-white/30 border-slate-400 dark:bg-black/20 dark:border-neutral-600 dark:hover:bg-black/30 border rounded-r-md">Start a review</button>',"\n            </div>\n          </div>\n        </div>\n        "),null===(l=R.current)||void 0===l||l.changeViewZones(n=>{i=n.addZone({domNode:document.createElement("div"),afterLineNumber:e.range.endLine,afterColumn:0,heightInPx:t.offsetHeight+10})});let r=()=>{var e;null===(e=R.current)||void 0===e||e.changeViewZones(e=>{i&&e.removeZone(i)})},a=e=>{t?e.target===n||t.contains(e.target)||"true"===t.getAttribute("data-comment")||(r(),window.removeEventListener("click",a)):window.removeEventListener("click",a)};window.addEventListener("click",a);let s=t.querySelector("textarea"),d=t.querySelector("button#add-chat"),o=t.querySelector("button#start-review");s.addEventListener("input",()=>{s.style.height="auto",s.style.height="".concat(s.scrollHeight,"px")});let c=()=>{b({comment:s.value,selection:e}),d.innerText="Added!",d.disabled=!0,t.setAttribute("data-comment","true"),s.disabled=!0};d.addEventListener("click",()=>{s.value.trim().length&&(d.innerText="Adding...",M.current?c():(v("".concat(s.value,"\n```").concat(e.language," filename=").concat(e.file," lines=").concat(e.range.startLine,"-").concat(e.range.endLine,"\n").concat(e.snippet,"\n```")),z(!1)))}),null==o||o.addEventListener("click",()=>{o.style.display="none",d.classList.add("rounded-r-md"),c(),j(!0)})}),t}});return(0,l.jsxs)("div",{className:"react-diff-viewer flex w-full flex-col pr-3 md:pr-4 dark:text-white [&:not(:last-child)]:mb-3",children:[(0,l.jsx)("div",{className:(0,S.Z)("sticky top-0 z-50 cursor-pointer rounded-t-lg border border-zinc-200 bg-slate-100 pl-4 font-mono text-xs dark:border-[#484848] dark:bg-zinc-800",k?"rounded-b-lg":"",x>1?"py-2":"py-3"),"data-file-section":u.file,onClick:()=>g(u.file),children:(0,l.jsxs)("div",{className:"flex max-w-full items-center gap-2 align-middle",children:[(0,l.jsxs)("div",{onClick:()=>{if(R.current){let e=R.current.getValue();navigator.clipboard.writeText(e).then(()=>{B.A.success("Copied edited file to clipboard")},e=>{console.error("Failed to copy text: ",e),B.A.error("Failed to copy")})}},className:"hidden items-center gap-1.5 whitespace-nowrap text-xs md:flex dark:text-white",children:["Copy updated file contents",(0,l.jsx)(q.T,{size:15,className:"mb-0.5"})]}),(0,l.jsx)("div",{className:(0,S.Z)(x>1?"mr-0":"mr-3","flex-1 truncate"),style:{direction:"rtl"},title:u.file,children:u.file.replace("/home/ubuntu/","")}),x>1&&(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)("div",{className:"hover:bg-slate-3000 ml-auto rounded-sm border p-1 duration-150 dark:hover:bg-gray-700",onClick:()=>D(k,!y),children:y?(0,l.jsx)(r.G,{size:16}):(0,l.jsx)(K.S,{size:16})}),(0,l.jsx)("div",{className:"ml-1.5 mr-4 rounded-sm border p-1 duration-150 hover:bg-slate-300 dark:hover:bg-gray-700",onClick:()=>D(!k,y),children:k?(0,l.jsx)(L.T,{size:16}):(0,l.jsx)(E.p,{size:16})})]})]})}),(0,l.jsx)("div",{className:(0,S.Z)("code-viewer h-full overflow-hidden border-b border-l border-r border-zinc-200 dark:border-[#484848]",k?"hidden":"block"),children:(0,l.jsx)(i.SV,{options:{readOnly:!0,ignoreTrimWhitespace:!1,renderSideBySide:!0,renderOverviewRuler:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1},theme:"dark"===_?"vs-dark":"vs-light",original:(null===(a=u.firstEvent)||void 0===a?void 0:a.contents)||"",modified:(null===(s=u.lastEvent)||void 0===s?void 0:s.contents)||"",className:(0,S.Z)("w-full overflow-hidden font-mono delay-75 duration-100 ease-in-out",!y&&x>1?"h-[40vh]":"h-[85vh]"),onMount:e=>{let t=e.getModifiedEditor();R.current=t,A(t)}},"".concat(null===(d=u.firstEvent)||void 0===d?void 0:d.contents,"-").concat(null===(c=u.lastEvent)||void 0===c?void 0:c.contents,"-").concat(_))})]})};var ea=n(382);let es=e=>{let{children:t,className:n}=e;return(0,l.jsx)("div",{className:(0,S.Z)("absolute right-0 flex h-full items-center justify-evenly border-b border-l border-b-gray-300 border-l-gray-300 px-2 text-neutral-700 dark:border-b-zinc-700 dark:border-l-zinc-700 dark:text-[#d1d1d1]",n),children:t})},ed=e=>{let{activeFilename:t}=e;return(0,l.jsx)("div",{className:"border-cloud dark:bg-night flex h-6  items-center space-x-1 overflow-x-auto bg-slate-200 px-2 text-xs text-neutral-500 dark:text-neutral-400",children:null==t?void 0:t.split("/").map((e,t,n)=>(0,l.jsxs)(h.Fragment,{children:[(0,l.jsx)("span",{children:e}),t!==n.length-1&&0!==t&&(0,l.jsx)("span",{children:">"})]},t))})}},382:function(e,t,n){"use strict";n.d(t,{i:function(){return a},u:function(){return s}});var l=n(81765),i=n(11787),r=n.n(i);let a=e=>{if(0===e.length)return"";if(1===e.length)return e[0];let t=e.map(e=>e.split("/").filter(Boolean)),n="",l=t.reduce((e,t)=>e.length<=t.length?e:t);for(let e=0;e<l.length-1;e++){let i=l[e];if(t.every(t=>t[e]===i))n+="".concat(i,"/");else break}return n},s=async(e,t)=>{let n=new(r()),i=e.map(e=>({filename:e.filename,contents:e.contents})),s=a(i.map(e=>e.filename)),d=i.length>1?1:2,o=s.split("/").length-d;i.forEach((e,t)=>{let n=e.filename.split("/").slice(o);i[t].filename=n.join("/")}),i.forEach(e=>{let t="/"===e.filename[0]?e.filename.slice(1):e.filename;n.file(t,e.contents||"")});let c=await n.generateAsync({type:"blob"});(0,l.saveAs)(c,"".concat(t,".zip"))}},80070:function(e,t,n){"use strict";n.d(t,{K:function(){return a}});var l=n(27573),i=n(57908),r=n(75113);let a=e=>{let{children:t,isActive:n,onClick:a,title:s,disabled:d}=e;return(0,l.jsx)(r.u,{content:(0,l.jsx)("span",{className:"text-xs",children:s}),side:"top",className:"px-2 py-1",delayDuration:100,children:(0,l.jsxs)("button",{className:(0,i.Z)("dark:hover:bg-night mr-1 rounded-sm p-1 last:mr-0 hover:bg-slate-200/70 active:bg-slate-200 disabled:opacity-30 dark:active:bg-black dark:disabled:hover:bg-[#1e1e1e]",n?"bg-slate-200 dark:bg-zinc-700":"bg-white dark:bg-zinc-900"),onClick:a,disabled:d,children:[(0,l.jsx)("span",{className:"sr-only",children:s}),t]})})}},97946:function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var l=n(27573),i=n(57908),r=n(7653);let a=e=>{let{allTabs:t,active:n,setActive:a,className:s,formatter:d=e=>e}=e;if(!t||!t.length)return null;let o=t.sort((e,t)=>t.firstActive-e.firstActive).map(e=>(0,l.jsx)(r.Fragment,{children:(0,l.jsx)("button",{onClick:()=>{a(e.id)},id:"tab-".concat(e.id),className:(0,i.Z)("flex h-full flex-shrink-0 items-center truncate border-t-2 px-4 py-2 text-left align-middle text-[0.8rem] dark:text-white",e.id===n?"dark:bg-night border-t-sky  border  border-x-zinc-300 border-b-transparent bg-slate-200 first:rounded-l-none first:border-l-0 dark:border-x-zinc-700":"text-cloud dark:hover:bg-shade border-b border-b-zinc-300 border-t-transparent hover:bg-slate-100 dark:border-b-zinc-700",s),children:d(e.id)})},e.id));return(0,l.jsxs)(l.Fragment,{children:[o,(0,l.jsx)("div",{className:" flex h-full !w-full flex-1 flex-grow border-b border-b-gray-300 dark:border-b-zinc-700"})]})}},89786:function(){}}]);